<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Adumbrations of data." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Visions, Voices, Data (old posts, page 2) | Visions, Voices, Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Visions-Voices-Data/index-2.html" rel="canonical">
<link href="." rel="prev" type="text/html">
<link href="index-1.html" rel="next" type="text/html"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
</script>
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/Visions-Voices-Data/"><span id="blog-title">Visions, Voices, Data</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">Cloistered Monkey</a> <a class="dropdown-item" href="pages/giss/giss-yearly-anomalies-by-climate-zone">GISS Anomalies</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Visions-Voices-Data/"><input name="k8" type="hidden" value="#444444"><input name="k9" type="hidden" value="#D51920"><input name="kt" type="hidden" value="h"><input class="span2" maxlength="255" name="q" placeholder="Search…" type="text"><input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/libraries/walking-through-the-pyviz-workflow-example/">Walking Through the Pyviz Workflow Example</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/libraries/walking-through-the-pyviz-workflow-example/" rel="bookmark"><time class="published dt-published" datetime="2019-03-14T12:48:04-07:00" itemprop="datePublished" title="2019-03-14 12:48">2019-03-14 12:48</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org74389ef">Beginning</a>
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#orgce18527">Set Up</a>
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org317b546">Imports</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org492e185">Presets</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#orgaf342bd">Constants</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org8132f8c">Load Some Data</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org231c879">Looking at the Missing Data</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org2fe7a19">Middle</a>
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org7cfcaf8">Looking at Measles</a>
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org8dbc052">By Year</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org946f612">Vaccines Enter The Picture</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org4e5c0ce">Measles By State</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org334c575">Oregon Vs Hawaii</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org6367726">Four States</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#org90bf6ad">Faceting</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#orgc13abf2">Bar Chart</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-workflow-example/#orge068466">Nationwide Mean With Error Bars</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org74389ef">
<h2 id="org74389ef">Beginning</h2>
<div class="outline-text-2" id="text-org74389ef">
<p>This is a replication of (most of) the <a href="http://pyviz.org/tutorial/01_Workflow_Introduction.html">pyviz workflow introduction</a> to see if I can replicate it. Nothing new here.</p>
</div>
<div class="outline-3" id="outline-container-orgce18527">
<h3 id="orgce18527">Set Up</h3>
<div class="outline-text-3" id="text-orgce18527"></div>
<div class="outline-4" id="outline-container-org317b546">
<h4 id="org317b546">Imports</h4>
<div class="outline-text-4" id="text-org317b546">
<p>From Python.</p>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
<p>From PyPi.</p>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">CrosshairTool</span><span class="p">,</span> <span class="n">HoverTool</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
<p>My Stuff.</p>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graeae.visualization</span> <span class="kn">import</span> <span class="n">EmbedBokeh</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org492e185">
<h4 id="org492e185">Presets</h4>
<div class="outline-text-4" id="text-org492e185">
<p>Load the dotenv.</p>
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">".env"</span><span class="p">)</span>
</pre></div>
<p>Set up the bokeh.</p>
<div class="highlight">
<pre><span></span><span class="n">OUTPUT_FOLDER</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/libraries/walking-through-the-pyviz-workflow-example/"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedBokeh</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="n">OUTPUT_FOLDER</span><span class="p">)</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
<p>Set up the table printer.</p>
<div class="highlight">
<pre><span></span><span class="n">TABLE</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tabulate</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgaf342bd">
<h4 id="orgaf342bd">Constants</h4>
<div class="outline-text-4" id="text-orgaf342bd">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Plots</span><span class="p">:</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">600</span>
    <span class="n">font_size</span> <span class="o">=</span> <span class="mi">18</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org8132f8c">
<h4 id="org8132f8c">Load Some Data</h4>
<div class="outline-text-4" id="text-org8132f8c">
<p>Measles and pertusis by state.</p>
<div class="highlight">
<pre><span></span><span class="n">diseases</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"DISEASES"</span><span class="p">)))</span>
</pre></div>
<p>What does the data look like?</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">diseases</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Year</th>
<th class="org-right" scope="col">Week</th>
<th class="org-left" scope="col">State</th>
<th class="org-right" scope="col">measles</th>
<th class="org-right" scope="col">pertussis</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1928</td>
<td class="org-right">1</td>
<td class="org-left">Alabama</td>
<td class="org-right">3.67</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">2</td>
<td class="org-left">Alabama</td>
<td class="org-right">6.25</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">3</td>
<td class="org-left">Alabama</td>
<td class="org-right">7.95</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">4</td>
<td class="org-left">Alabama</td>
<td class="org-right">12.58</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">5</td>
<td class="org-left">Alabama</td>
<td class="org-right">8.03</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">diseases</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Year</th>
<th class="org-right" scope="col">Week</th>
<th class="org-left" scope="col">State</th>
<th class="org-right" scope="col">measles</th>
<th class="org-right" scope="col">pertussis</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1945</td>
<td class="org-right">18</td>
<td class="org-left">Tennessee</td>
<td class="org-right">2.26</td>
<td class="org-right">0.66</td>
</tr>
<tr>
<td class="org-right">1988</td>
<td class="org-right">7</td>
<td class="org-left">Mississippi</td>
<td class="org-right">nan</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1973</td>
<td class="org-right">14</td>
<td class="org-left">North Dakota</td>
<td class="org-right">0</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1963</td>
<td class="org-right">29</td>
<td class="org-left">Montana</td>
<td class="org-right">5.55</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1932</td>
<td class="org-right">13</td>
<td class="org-left">Utah</td>
<td class="org-right">0.39</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
<p>It looks like this data set has weekly measles… counts? I don't know why the values are fractions. It also looks like pertusis (<a href="https://www.cdc.gov/pertussis/index.html">whooping cough</a>) is missing values.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org231c879">
<h4 id="org231c879">Looking at the Missing Data</h4>
<div class="outline-text-4" id="text-org231c879">
<div class="highlight">
<pre><span></span><span class="n">missing_measles</span> <span class="o">=</span> <span class="n">diseases</span><span class="p">[</span><span class="n">diseases</span><span class="o">.</span><span class="n">measles</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"Missing Measles: {:.2f} %"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_measles</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diseases</span><span class="p">)))</span>

<span class="n">missing_pertussis</span> <span class="o">=</span> <span class="n">diseases</span><span class="p">[</span><span class="n">diseases</span><span class="o">.</span><span class="n">pertussis</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"Missing Pertussis: {:.2f} %"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_pertussis</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diseases</span><span class="p">)))</span>
</pre></div>
<pre class="example">
Missing Measles: 34.84 %
Missing Pertussis: 51.04 %

</pre>
<p>It looks like they both have missing values, but there are more missing pertussis values. I'll look at how the missing values are distributed.</p>
</div>
<ul class="org-ul">
<li><a id="org64b009c"></a>Measles<br>
<div class="outline-text-5" id="text-org64b009c">
<div class="highlight">
<pre><span></span><span class="n">decade_hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Missing"</span><span class="p">,</span> <span class="s2">"@Year_count{0,0}"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Decade Center Year"</span><span class="p">,</span> <span class="s2">"@Year{0}"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"Count"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">,</span>
        <span class="s2">"Year"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">histogram</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_measles</span><span class="p">[(</span><span class="n">missing_measles</span><span class="o">.</span><span class="n">Year</span> <span class="o">&gt;</span><span class="mi">1929</span><span class="p">)</span> 
                             <span class="o">&</span> <span class="p">(</span><span class="n">missing_measles</span><span class="o">.</span><span class="n">Year</span> <span class="o">&lt;</span> <span class="mi">2011</span><span class="p">)]</span>
             <span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">decade_hover</span><span class="p">],</span>
                          <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">"Missing Weekly Measles Reports by Decade"</span><span class="p">)</span>
             <span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">histogram</span><span class="p">,</span> <span class="s2">"missing_measles_histogram"</span><span class="p">)()</span>
</pre></div>
<script id="3b264531-d9b5-45ae-83f6-16bf70fa0da8" src="posts/libraries/walking-through-the-pyviz-workflow-example/missing_measles_histogram.js">
</script>
<p>Since we have roughly eight decades of data I trimmed the years to exactly eight and then made a histogram with eight bins to get the counts per decade. Since this is a post about doing the plotting and not really about measles or pertussis I should probably mention that the way I got the <code>Year_count</code> variable name for the <code>HoverTool</code> was by printing the <code>histogram</code> object after I'd plotted it once.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">histogram</span><span class="p">)</span>
</pre></div>
<pre class="example">
:Histogram   [Year]   (Year_count)

</pre>
<div class="highlight">
<pre><span></span><span class="n">year_hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Missing"</span><span class="p">,</span> <span class="s2">"@count{0,0}"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year{0}"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"Count"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">,</span>
        <span class="s2">"Year"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">year_counts</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_measles</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span>
               <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">"Year"</span><span class="p">:</span> <span class="s2">"count"</span><span class="p">})</span>
               <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Year"</span><span class="p">:</span> <span class="s2">"count"</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">year_counts</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">year_hover</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"count"</span><span class="p">,</span>
                          <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                          <span class="n">xlabel</span><span class="o">=</span><span class="s2">"Missing Count"</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">"Missing Measles Reports by Year"</span><span class="p">)</span>
        <span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"aggregated_missing_measles"</span><span class="p">)()</span>
</pre></div>
<script id="84285ed8-6ae8-4029-b7fa-98b877b35529" src="posts/libraries/walking-through-the-pyviz-workflow-example/aggregated_missing_measles.js">
</script>
<p>It looks like there are more missing values from 1981 onward. That kind of surprised me, but I guess that prior to this <a href="https://www.doh.wa.gov/YouandYourFamily/IllnessandDisease/Measles/MeaslesOutbreak">latest outbreak</a> the reporting might have become less necessary since measles was less common (it was declared eliminated from the Americas in <a href="https://en.wikipedia.org/wiki/Measles#Americas">2016</a>).</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">histogram</span><span class="p">)</span>
</pre></div>
<pre class="example">
:Histogram   [Year]   (Year_count)

</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diseases</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">diseases</span><span class="o">.</span><span class="n">Week</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
<pre class="example">
2652

</pre>
<p>By 2003 there are 2,652 missing values, which is our maxmimum value so it looks like there was no reporting in this data set from this year forward.</p>
</div>
</li>
<li><a id="orgf34a71c"></a>Pertussis<br>
<div class="outline-text-5" id="text-orgf34a71c">
<div class="highlight">
<pre><span></span><span class="n">histogram</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_pertussis</span><span class="p">[(</span><span class="n">missing_pertussis</span><span class="o">.</span><span class="n">Year</span> <span class="o">&gt;</span> <span class="mi">1929</span><span class="p">)</span> 
                              <span class="o">&</span> <span class="p">(</span><span class="n">missing_pertussis</span><span class="o">.</span><span class="n">Year</span> <span class="o">&lt;</span> <span class="mi">2011</span><span class="p">)]</span>
             <span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> 
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Count of Missing"</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">"Missing Pertussis by Decade"</span><span class="p">,</span> 
                          <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">decade_hover</span><span class="p">])</span>
             <span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">histogram</span><span class="p">,</span> <span class="s2">"missing_pertussis_distribution"</span><span class="p">)()</span>
</pre></div>
<script id="f7664a4d-5cad-4b77-bc63-21c98a270f15" src="posts/libraries/walking-through-the-pyviz-workflow-example/missing_pertussis_distribution.js">
</script>
<p>Strangely the missing reports seem to peak in the 1960s. This seems problematic if you're going to look at the incident rates, but I'm only going to look at measles anyway.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org2fe7a19">
<h2 id="org2fe7a19">Middle</h2>
<div class="outline-text-2" id="text-org2fe7a19"></div>
<div class="outline-3" id="outline-container-org7cfcaf8">
<h3 id="org7cfcaf8">Looking at Measles</h3>
<div class="outline-text-3" id="text-org7cfcaf8"></div>
<div class="outline-4" id="outline-container-org8dbc052">
<h4 id="org8dbc052">By Year</h4>
<div class="outline-text-4" id="text-org8dbc052">
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Measles"</span><span class="p">,</span> <span class="s2">"@measles{0,0}"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"measles"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">measles_by_year</span> <span class="o">=</span> <span class="n">diseases</span><span class="p">[[</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"measles"</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">measles_by_year</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Measles In the U.S. by Year"</span><span class="p">,</span> 
                              <span class="n">xlabel</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> 
                              <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Cases"</span><span class="p">,</span> 
                              <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                              <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">])</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"measles_by_year"</span><span class="p">)()</span>
</pre></div>
<script id="4ecde4b8-c917-413a-bb74-ffbf9a4d86db" src="posts/libraries/walking-through-the-pyviz-workflow-example/measles_by_year.js">
</script>
<p>You can see from the plot that cases of measles have dropped dramatically over the years, with a particularly sharp drop in the 1960's.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org946f612">
<h4 id="org946f612">Vaccines Enter The Picture</h4>
<div class="outline-text-4" id="text-org946f612">
<p>According to the <a href="https://www.cdc.gov/measles/about/history.html">CDC</a>, the Edmonston-D vaccine was released in the United States in 1963 and the Edmonston-Enders vaccine (which is still currently in use) was released in 1968. Let's draw some lines to mark when certain events happened.</p>
<div class="highlight">
<pre><span></span><span class="n">first</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">VLine</span><span class="p">(</span><span class="mi">1963</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">first_label</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="mi">1963</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">27000</span><span class="p">,</span> <span class="s2">"Vaccine Introduced"</span><span class="p">,</span> 
                             <span class="n">halign</span><span class="o">=</span><span class="s2">"right"</span><span class="p">)</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">VLine</span><span class="p">(</span><span class="mi">1968</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">current_label</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="mi">1968</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">27000</span><span class="p">,</span> <span class="s2">"Newer Vaccine"</span><span class="p">,</span> <span class="n">halign</span><span class="o">=</span><span class="s2">"left"</span><span class="p">)</span>
<span class="n">highest</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">VLine</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">measles_by_year</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()))</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">highest_label</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">measles_by_year</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">27000</span><span class="p">,</span> 
                               <span class="s2">"Year of the Most Cases"</span><span class="p">,</span> <span class="n">halign</span><span class="o">=</span><span class="s2">"left"</span><span class="p">)</span>
<span class="n">lowest</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">VLine</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">measles_by_year</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()))</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span> 
                                                             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">lowest_label</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">measles_by_year</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">27000</span><span class="p">,</span> 
                              <span class="s2">"Zero Cases"</span><span class="p">,</span> <span class="n">halign</span><span class="o">=</span><span class="s2">"right"</span><span class="p">)</span>

<span class="n">plot_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">plot</span>
          <span class="o">*</span> <span class="n">first</span> <span class="o">*</span> <span class="n">first_label</span> 
          <span class="o">*</span> <span class="n">current</span> <span class="o">*</span> <span class="n">current_label</span> 
          <span class="o">*</span> <span class="n">highest</span> <span class="o">*</span> <span class="n">highest_label</span> 
          <span class="o">*</span> <span class="n">lowest</span> <span class="o">*</span> <span class="n">lowest_label</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot_2</span><span class="p">,</span> <span class="s2">"measles_with_landmarks"</span><span class="p">)()</span>
</pre></div>
<script id="7a5f6d06-eede-4cf0-8881-6ddd5d408ca9" src="posts/libraries/walking-through-the-pyviz-workflow-example/measles_with_landmarks.js">
</script>
<p>It does look like the introduction of the vaccine(s) had a dramatic effect on the incidence of measles in the United States.</p>
<p>It appears that there were zero cases in 2002, but the actual value is 0.31, but my formatter cuts off the decimal place. 2003 is the first true zero, but as we saw above, this is also the first N/A value. Maybe N/A means zero, not missing. It's hard to say without some documentation about the data.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org4e5c0ce">
<h4 id="org4e5c0ce">Measles By State</h4>
<div class="outline-text-4" id="text-org4e5c0ce">
<p>This creates a dropdown menu so we can see the states' measles cases separately. It doesn't work in this template so I'm saving it as a separate page.</p>
<div class="highlight">
<pre><span></span><span class="n">measles_by_state</span> <span class="o">=</span> <span class="n">diseases</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"State"</span><span class="p">])[</span><span class="s2">"measles"</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">states_plot</span> <span class="o">=</span> <span class="n">measles_by_state</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s2">"State"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">dynamic</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">"measles_by_state.html"</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">states_plot</span><span class="p">,</span> <span class="n">OUTPUT_FOLDER</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:{}][Link to plot]]"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
</pre></div>
<p><a href="posts/libraries/walking-through-the-pyviz-workflow-example/measles_by_state.html">Link to plot</a></p>
</div>
</div>
<div class="outline-4" id="outline-container-org334c575">
<h4 id="org334c575">Oregon Vs Hawaii</h4>
<div class="outline-text-4" id="text-org334c575">
<p>Instead of looking at all the states one at a time, we can choose two states and lay them out side by side to make them easier to compare. The addition sign is used to make plots next to each other.</p>
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Measles Cases"</span><span class="p">,</span> <span class="s2">"@measles{0,0}"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"measles"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">oregon_plot</span> <span class="o">=</span> <span class="n">states_plot</span><span class="p">[</span><span class="s2">"Oregon"</span><span class="p">]</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">"Measles in Oregon"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> 
    <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
<span class="n">hawaii_plot</span> <span class="o">=</span> <span class="n">states_plot</span><span class="p">[</span><span class="s2">"Hawaii"</span><span class="p">]</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">"Measles in Hawaii"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> 
    <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">oregon_plot</span> <span class="o">*</span> <span class="n">first</span> <span class="o">*</span> <span class="n">current</span> <span class="o">*</span> <span class="n">current_label</span> <span class="o">*</span> <span class="n">first_label</span>
        <span class="o">+</span> <span class="n">hawaii_plot</span> <span class="o">*</span> <span class="n">first</span> <span class="o">*</span> <span class="n">first_label</span> <span class="o">*</span> <span class="n">current</span> <span class="o">*</span> <span class="n">current_label</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"oregon_vs_hawaii"</span><span class="p">)()</span>
</pre></div>
<script id="d4b7b792-b833-46c8-baaa-dd67da1e0ed9" src="posts/libraries/walking-through-the-pyviz-workflow-example/oregon_vs_hawaii.js">
</script>
<p>I don't know why but the labels don't work. This is one of the problems with HoloViews, I think - they make some things really easy but the minute you step outside of what they have documented there's no way to figure out what's going on and how to fix it (or do it in the first place). It's an impressive programming feat but not documented enough to be as useful as it might be. More of a thing for quick sketching after which you have to switch back over to bokeh if you want anything other than the canned views (kind of like Excel… except with less documentation).</p>
<p>Surprisingly (to me), Hawaii had more cases in their peak years and huge swings. Perhaps since it's an island the sailors and other travelers introduced epidemics. Or maybe they weren't as good at keeping records back then.</p>
<p>According to the <a href="https://en.wikipedia.org/wiki/List_of_U.S._states_and_territories_by_historical_population">1960 Census Count</a> Oregon was quite a bit more populous than Hawaii.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org6367726">
<h4 id="org6367726">Four States</h4>
<div class="outline-text-4" id="text-org6367726">
<p>Since Oregon had a much larger population that Hawaii I thought I'd plot the states closer to it in size. The four states nearest to Hawaii in population (from the same 1960 popurlation report) are (in descending order):</p>
<ul class="org-ul">
<li>Montana (674,767)</li>
<li>Idaho (667,191)</li>
<li>Hawaii (632,772)</li>
<li>North Dakota (632,446)</li>
</ul>
<p>While the side-by side plot lets you see groupings and heights you can't easily compare values for each year so this time I'll put them all on the same plot. HoloViews automatically creates a legend which lets you dim a line by clicking on it in the legend.</p>
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Measles"</span><span class="p">,</span> <span class="s2">"@measles{0,0}"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"State"</span><span class="p">,</span> <span class="s2">"@State"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"measles"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Montana"</span><span class="p">,</span> <span class="s2">"Idaho"</span><span class="p">,</span> <span class="s2">"Hawaii"</span><span class="p">,</span> <span class="s2">"North Dakota"</span><span class="p">]</span>
<span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span> <span class="o">=</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">2005</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">measles_by_state</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start_year</span><span class="p">:</span><span class="n">end_year</span><span class="p">,</span> <span class="n">states</span><span class="p">]</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="s2">"State"</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Measles 1930 - 2005"</span><span class="p">,</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> 
        <span class="o">*</span> <span class="n">first</span> <span class="o">*</span> <span class="n">first_label</span> 
        <span class="o">*</span> <span class="n">current</span> <span class="o">*</span> <span class="n">current_label</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"four_states_measles"</span><span class="p">)()</span>
</pre></div>
<script id="9d388cfc-ccc6-47a2-bfb1-fc9b3ac234bc" src="posts/libraries/walking-through-the-pyviz-workflow-example/four_states_measles.js">
</script>
<p>Surprisingly Hawaii had the highest values in 1951 and 1955 and it looks like they had a really bad outbreak from 1955 through 1958, although Montana had higher values overall. Once again, the introduction of a vaccine seems to have a dramatic effect, although there continued to be mini outbreaks in the 1970s.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org90bf6ad">
<h4 id="org90bf6ad">Faceting</h4>
<div class="outline-text-4" id="text-org90bf6ad">
<p>Another way to compare the states is to plot them side-by side.</p>
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Measles"</span><span class="p">,</span> <span class="s2">"@measles{0,0}"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"measles"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">crosshairs</span> <span class="o">=</span> <span class="n">CrosshairTool</span><span class="p">()</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">measles_by_state</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start_year</span><span class="p">:</span><span class="n">end_year</span><span class="p">,</span> <span class="n">states</span><span class="p">]</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">"State"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">crosshairs</span><span class="p">])</span>
        <span class="o">*</span> <span class="n">first</span> <span class="o">*</span> <span class="n">first_label</span> <span class="o">*</span> <span class="n">current</span> <span class="o">*</span> <span class="n">current_label</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Measles By Year"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"faceted_measles_states"</span><span class="p">)()</span>
</pre></div>
<script id="f29ad2b5-8752-430a-b1fa-ce4ee13260c8" src="posts/libraries/walking-through-the-pyviz-workflow-example/faceted_measles_states.js">
</script>
<p>This makes it harder to compare year by year, but it looks kind of elegant and it's clearer that Hawaii only had this one intense period recorded (starting in 1950) before the vaccine came out, while Idaho and North Dakota had this steady low-level amount of cases and something was much worse in Montana (although, really, their pattern looks closer to that of the United States as a whole) and all of them benefitted from the vaccines.</p>
<p>As far as the plot goes, it might not be obvious but the main difference with what I did to get this plot is that the <code>State</code> column was assigned to the <code>col</code> argument instead of the <code>by</code> argument. I also had to set the title using the <code>opts</code> for the total plot, setting it for the <code>hvplot</code> didn't do anything.</p>
</div>
</div>
<div class="outline-4" id="outline-container-orgc13abf2">
<h4 id="orgc13abf2">Bar Chart</h4>
<div class="outline-text-4" id="text-orgc13abf2">
<p>This time I'll plot the counts for the states using a bar-chart instead of a line-plot.</p>
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Measles"</span><span class="p">,</span> <span class="s2">"@measles{0,0}"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"State"</span><span class="p">,</span> <span class="s2">"@State"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"measles"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">measles_by_state</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1960</span><span class="p">:</span><span class="mi">1970</span><span class="p">,</span> <span class="n">states</span><span class="p">]</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="s2">"Year"</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Measles Count by Year"</span><span class="p">,</span>
    <span class="n">by</span><span class="o">=</span><span class="s2">"State"</span><span class="p">,</span> 
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
    <span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"measles_bar_chart"</span><span class="p">)()</span>
</pre></div>
<script id="db2fbc58-2d62-4f36-be4d-b2b9e8f15191" src="posts/libraries/walking-through-the-pyviz-workflow-example/measles_bar_chart.js">
</script>
<p>This gives pretty much the same information as the earlier line-plot, except it makes it easier to see a states' case-count for a given year. On the other hand it's harder to really see the year-to-year patterns and you can't turn off states to highlight other states. This looks like something business people would use more than what scientists would use. I think there is a certain aesthetic advantage to it which is traded off by the extra trend information given by a line plot. It does have a major advantage in the way it simplifies the output, though. It also allows you to use the "vline" option so the user only has to be on the same x-axis as a bar to trigger the pop-up. When I did this with the line plots the ones for the different states ended up covering each other up (since they all shared the same x-value).</p>
<p>I tried to add the previous vertical lines to indicate when vaccines were introduced but a bar-plot uses different inputs so it raised an error. It's probably less important for a bar-chart anyway, since you aren't emphasizing the time line quite so much as with a line plot.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span>
</pre></div>
<pre class="example">
:VLine   [x,y]
:Bars   [Year,State]   (measles)

</pre>
<p>I think (guess) that it needs both the year and state, while the line plot only needed the year.</p>
</div>
</div>
<div class="outline-4" id="outline-container-orge068466">
<h4 id="orge068466">Nationwide Mean With Error Bars</h4>
<div class="outline-text-4" id="text-orge068466">
<div class="highlight">
<pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">diseases</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">"measles"</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">]})</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span>
    <span class="s2">"measles"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">"mean"</span><span class="p">,</span> 
                     <span class="n">title</span><span class="o">=</span><span class="s2">"Mean National Measles Cases By Year"</span><span class="p">)</span> 
        <span class="o">*</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">ErrorBars</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">)</span><span class="o">.</span><span class="n">redim</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span> 
        <span class="o">*</span> <span class="n">first</span> <span class="o">*</span> <span class="n">first_label</span> <span class="o">*</span> <span class="n">current</span> <span class="o">*</span> <span class="n">current_label</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"error_bars"</span><span class="p">)()</span>
</pre></div>
<script id="629a475e-89e1-4466-a8e6-eab5a4969341" src="posts/libraries/walking-through-the-pyviz-workflow-example/error_bars.js">
</script>
<p>So looking at this we can see that the national mean actually paints a slightly different picture from the raw counts for measles. My guess would be that the different populations for each state offset each other enough that the mean is flattened out.</p>
<p>Actually, in thinking about it, the mean is really a weekly mean for the year so… I'll have to think about this.</p>
</div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/giss/giss-zone-anomalies/">GISS Zone Anomalies</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/giss/giss-zone-anomalies/" rel="bookmark"><time class="published dt-published" datetime="2019-03-08T12:58:41-08:00" itemprop="datePublished" title="2019-03-08 12:58">2019-03-08 12:58</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/giss/giss-zone-anomalies/#org6f73c3e">Introduction</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#orge582092">Set Up</a>
<ul>
<li><a href="posts/giss/giss-zone-anomalies/#org1749e6f">Imports</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org5cea2b3">Load Dotenv</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org9df92c4">HoloViews Backend</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org96b1aeb">The Embedder</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org8fd6a72">Some Settings</a></li>
</ul>
</li>
<li><a href="posts/giss/giss-zone-anomalies/#org8493d24">The Data</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#orgc9477f8">Tidying the Data</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org48ccb26">The Frigid North</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org9dbf8fe">All Zones Dropdown</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org617254c">All Zones Overlay</a>
<ul>
<li><a href="posts/giss/giss-zone-anomalies/#orgc36fa95">Hemisphere Spikes</a></li>
</ul>
</li>
<li><a href="posts/giss/giss-zone-anomalies/#orge21bbcd">Hemispheres</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org8c04729">Extratropics</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org9e07efb">The Zones</a></li>
<li><a href="posts/giss/giss-zone-anomalies/#org6845a13">Tabbed Plots</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org6f73c3e">
<h2 id="org6f73c3e">Introduction</h2>
<div class="outline-text-2" id="text-org6f73c3e">
<p>This is a look at the <a href="https://data.giss.nasa.gov/gistemp/">Godard Institute for Space Studies' surface temperature data</a>. I'll look at the mean difference between the yearly mean and the historical "normal" mean.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orge582092">
<h2 id="orge582092">Set Up</h2>
<div class="outline-text-2" id="text-orge582092"></div>
<div class="outline-3" id="outline-container-org1749e6f">
<h3 id="org1749e6f">Imports</h3>
<div class="outline-text-3" id="text-org1749e6f"></div>
<div class="outline-4" id="outline-container-orge5f5574">
<h4 id="orge5f5574">Python</h4>
<div class="outline-text-4" id="text-orge5f5574">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgc8f7d2c">
<h4 id="orgc8f7d2c">PyPi</h4>
<div class="outline-text-4" id="text-orgc8f7d2c">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">from</span> <span class="nn">holoviews.plotting.links</span> <span class="kn">import</span> <span class="n">RangeToolLink</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">CrosshairTool</span><span class="p">,</span> <span class="n">HoverTool</span>
<span class="kn">from</span> <span class="nn">bokeh.palettes</span> <span class="kn">import</span> <span class="n">Category20</span>

<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org5c42b35">
<h4 id="org5c42b35">This Project</h4>
<div class="outline-text-4" id="text-org5c42b35">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bartleby_the_penguin.tangles.embed_bokeh</span> <span class="kn">import</span> <span class="n">EmbedBokeh</span>
<span class="kn">from</span> <span class="nn">graeae.tables</span> <span class="kn">import</span> <span class="n">CountPercentage</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org5cea2b3">
<h3 id="org5cea2b3">Load Dotenv</h3>
<div class="outline-text-3" id="text-org5cea2b3">
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">".env"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org9df92c4">
<h3 id="org9df92c4">HoloViews Backend</h3>
<div class="outline-text-3" id="text-org9df92c4">
<div class="highlight">
<pre><span></span><span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org96b1aeb">
<h3 id="org96b1aeb">The Embedder</h3>
<div class="outline-text-3" id="text-org96b1aeb">
<div class="highlight">
<pre><span></span><span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/giss/giss-zone-anomalies/"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedBokeh</span><span class="p">,</span> 
                <span class="n">folder_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org8fd6a72">
<h3 id="org8fd6a72">Some Settings</h3>
<div class="outline-text-3" id="text-org8fd6a72">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Plots</span><span class="p">:</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">1200</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">600</span>
    <span class="n">font</span> <span class="o">=</span> <span class="s2">"Open Sans"</span>
    <span class="n">font_size</span> <span class="o">=</span> <span class="s2">"24pt"</span>
    <span class="n">line_width</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">tools</span> <span class="o">=</span>  <span class="p">[</span><span class="s2">"hover"</span><span class="p">]</span>
    <span class="n">blue</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">light_blue</span> <span class="o">=</span> <span class="n">Category20</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">red</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">yellow</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">green</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">gray</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org8493d24">
<h2 id="org8493d24">The Data</h2>
<div class="outline-text-2" id="text-org8493d24">
<p>The data is the <i>Combined Land-Surface Air and Sea-Surface Water Temperature Anomolies'</i> <a href="https://data.giss.nasa.gov/gistemp/tabledata_v3/ZonAnn.Ts+dSST.csv">Zonal Annual Means</a> which shows the different annual mean for each zone in a given year.</p>
<div class="highlight">
<pre><span></span><span class="n">zone_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"ZONES"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">zone_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="k">with</span> <span class="n">zone_path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
    <span class="n">giss</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">giss</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
<pre class="example">
              Year        Glob        NHem        SHem     24N-90N  \
count   139.000000  139.000000  139.000000  139.000000  139.000000   
mean   1949.000000    0.032302    0.056043    0.008561    0.077698   
std      40.269923    0.336896    0.393435    0.301848    0.464606   
min    1880.000000   -0.490000   -0.540000   -0.490000   -0.580000   
25%    1914.500000   -0.200000   -0.220000   -0.235000   -0.280000   
50%    1949.000000   -0.070000   -0.010000   -0.080000    0.020000   
75%    1983.500000    0.215000    0.210000    0.265000    0.255000   
max    2018.000000    0.980000    1.260000    0.710000    1.500000   

          24S-24N     90S-24S     64N-90N     44N-64N     24N-44N     EQU-24N  \
count  139.000000  139.000000  139.000000  139.000000  139.000000  139.000000   
mean     0.036115   -0.018561    0.111079    0.117770    0.027698    0.027626   
std      0.331384    0.295695    0.917715    0.516729    0.356416    0.326111   
min     -0.650000   -0.470000   -1.640000   -0.710000   -0.590000   -0.720000   
25%     -0.215000   -0.250000   -0.545000   -0.270000   -0.200000   -0.230000   
50%     -0.030000   -0.100000    0.020000    0.000000   -0.070000    0.000000   
75%      0.255000    0.230000    0.660000    0.360000    0.135000    0.240000   
max      0.970000    0.700000    3.050000    1.440000    1.060000    0.930000   

          24S-EQU     44S-24S     64S-44S     90S-64S  
count  139.000000  139.000000  139.000000  139.000000  
mean     0.045683    0.020432   -0.069353   -0.078129  
std      0.343385    0.312688    0.269380    0.732359  
min     -0.580000   -0.430000   -0.540000   -2.570000  
25%     -0.210000   -0.220000   -0.265000   -0.490000  
50%     -0.030000   -0.080000   -0.090000    0.050000  
75%      0.290000    0.260000    0.180000    0.410000  
max      1.020000    0.780000    0.450000    1.270000  
</pre>
<p>So we have years from 1880 through 2018.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">giss</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<pre class="example">
Year       1880.00
Glob         -0.18
NHem         -0.31
SHem         -0.06
24N-90N      -0.38
24S-24N      -0.17
90S-24S      -0.01
64N-90N      -0.97
44N-64N      -0.47
24N-44N      -0.25
EQU-24N      -0.21
24S-EQU      -0.13
44S-24S      -0.04
64S-44S       0.05
90S-64S       0.67
Name: 0, dtype: float64
</pre></div>
</div>
<div class="outline-2" id="outline-container-orgc9477f8">
<h2 id="orgc9477f8">Tidying the Data</h2>
<div class="outline-text-2" id="text-orgc9477f8">
<p>I'm going to use the locations for names so I'll make them something more meaningful for me. I don't know if these are, strictly speaking, the right names, but it's close enough.</p>
<div class="highlight">
<pre><span></span><span class="n">name_remap</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Glob"</span><span class="p">:</span> <span class="s2">"Global"</span><span class="p">,</span>
    <span class="s2">"NHem"</span><span class="p">:</span> <span class="s2">"Northern Hemisphere"</span><span class="p">,</span>
    <span class="s2">"SHem"</span><span class="p">:</span> <span class="s2">"Southern Hemisphere"</span><span class="p">,</span>
    <span class="s2">"24N-90N"</span><span class="p">:</span> <span class="s2">"Northern Extratropics"</span><span class="p">,</span>
    <span class="s2">"24S-24N"</span><span class="p">:</span> <span class="s2">"Tropics"</span><span class="p">,</span>
    <span class="s2">"90S-24S"</span><span class="p">:</span> <span class="s2">"Southern Extratropics"</span><span class="p">,</span>
    <span class="s2">"64N-90N"</span><span class="p">:</span> <span class="s2">"North Frigid"</span><span class="p">,</span>
    <span class="s2">"44N-64N"</span><span class="p">:</span> <span class="s2">"North Temperate"</span><span class="p">,</span>
    <span class="s2">"24N-44N"</span><span class="p">:</span> <span class="s2">"North Sub-Tropic"</span><span class="p">,</span>
    <span class="s2">"EQU-24N"</span><span class="p">:</span> <span class="s2">"Tropic of Cancer"</span><span class="p">,</span>
    <span class="s2">"24S-EQU"</span><span class="p">:</span> <span class="s2">"Tropic of Capricorn"</span><span class="p">,</span>
    <span class="s2">"44S-24S"</span><span class="p">:</span> <span class="s2">"South Sub-Tropic"</span><span class="p">,</span>
    <span class="s2">"64S-44S"</span><span class="p">:</span> <span class="s2">"South Temperate"</span><span class="p">,</span>
    <span class="s2">"90S-64S"</span><span class="p">:</span> <span class="s2">"South Frigid"</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">giss</span> <span class="o">=</span> <span class="n">giss</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">name_remap</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">giss</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
<pre class="example">
Index(['Year', 'Global', 'Northern Hemisphere', 'Southern Hemisphere',
       'Northern Extratropics', 'Tropics', 'Southern Extratropics',
       'North Frigid', 'North Temperate', 'North Sub-Tropic',
       'Tropic of Cancer', 'Tropic of Capricorn', 'South Sub-Tropic',
       'South Temperate', 'South Frigid'],
      dtype='object')

</pre>
<div class="highlight">
<pre><span></span><span class="n">giss_tidy</span> <span class="o">=</span> <span class="n">giss</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">"location"</span><span class="p">,</span> 
                      <span class="n">value_name</span><span class="o">=</span><span class="s2">"Difference From Normal"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<pre class="example">
Year                        1880
location                  Global
Difference From Normal     -0.18
Name: 0, dtype: object

</pre>
<div class="highlight">
<pre><span></span><span class="n">location</span> <span class="o">=</span> <span class="n">CountPercentage</span><span class="p">(</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">location</span><span class="p">)</span>
<span class="c1"># plot = location.table.hvplot.table()</span>
<span class="c1"># Embed(plot, "location_table")()</span>
<span class="n">location</span><span class="p">()</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Value</th>
<th class="org-right" scope="col">Count</th>
<th class="org-right" scope="col">Percentage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Southern Extratropics</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">Tropics</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">North Temperate</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">North Frigid</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">Northern Extratropics</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">North Sub-Tropic</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">South Sub-Tropic</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">Southern Hemisphere</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">Global</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">South Frigid</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">South Temperate</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">Tropic of Cancer</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">Northern Hemisphere</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
<tr>
<td class="org-left">Tropic of Capricorn</td>
<td class="org-right">139</td>
<td class="org-right">7.14</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="outline-2" id="outline-container-org48ccb26">
<h2 id="org48ccb26">The Frigid North</h2>
<div class="outline-text-2" id="text-org48ccb26">
<p>This is a plot of the temperature anomalies for the Frigid North using a Range Finder. You can select a range of years using the mini-plot below the main one.</p>
<div class="highlight">
<pre><span></span><span class="c1"># The Tools</span>
<span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">"Temperature Anomaly (C)"</span><span class="p">,</span> <span class="s2">"@{North Frigid}{0.00}"</span><span class="p">),</span>
<span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"North Frigid"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># The Parts</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span>
    <span class="n">giss</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">"North Frigid"</span><span class="p">,</span> <span class="s2">"Temperature Anomaly (C)"</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">main</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">"North Frigid Zone"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> 
                                               <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> 
                                               <span class="n">labelled</span><span class="o">=</span><span class="p">[</span><span class="s2">"y"</span><span class="p">],</span>
                                               <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                               <span class="n">color</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
                                               <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"pan"</span><span class="p">,</span> <span class="s2">"zoom_in"</span><span class="p">,</span> 
                                                      <span class="n">hover</span><span class="p">,</span> <span class="s2">"reset"</span><span class="p">])</span>
<span class="n">range_finder</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">default_tools</span><span class="o">=</span><span class="p">[])</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">RangeToolLink</span><span class="p">(</span><span class="n">range_finder</span><span class="p">,</span> <span class="n">main</span><span class="p">)</span>

<span class="n">layout</span> <span class="o">=</span> <span class="p">(</span><span class="n">main</span> <span class="o">*</span> <span class="n">line</span> <span class="o">+</span> <span class="n">range_finder</span><span class="p">)</span><span class="o">.</span><span class="n">cols</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">shared_axes</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">merge_tools</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="s2">"north_frigid_zone"</span><span class="p">)()</span>
</pre></div>
<script id="1a5b91e2-6256-4db1-9913-a4d66e967e41" src="posts/giss/giss-zone-anomalies/north_frigid_zone.js">
</script>
<p>This plot is kind of unusual in that the column name has a space in it ("North Frigid") so in the hover tool you have to <a href="https://github.com/bokeh/bokeh/issues/4796e">put braces around it</a>.</p>
<p>If we were only looking at one zone I would think this is the most useful type, but when I tried to add multiple zones I couldn't get it to work. HoloViews… I also tried to change the font and couldn't figure out how to do it. I really don't get what bokeh and HoloViews are doing with their documentation.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org9dbf8fe">
<h2 id="org9dbf8fe">All Zones Dropdown</h2>
<div class="outline-text-2" id="text-org9dbf8fe">
<p>This creates a plot with all the zones but only showing one at a time (you select which one using a dropdown). To get it you specify the dropdown column using <code>groupby</code>.</p>
<div class="highlight">
<pre><span></span><span class="c1"># the Tools</span>
<span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
<span class="n">tooltips</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Difference from Normal"</span><span class="p">,</span> <span class="s2">"@Difference From Normal"</span><span class="p">),</span>
<span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"Difference From Normal"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s2">"location"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">dynamic</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">])</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">plot</span> <span class="o">*</span> <span class="n">line</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">"zones.html"</span>

<span class="n">plot_file</span> <span class="o">=</span> <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">plot_file</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:{}][Link To Plot]]"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
</pre></div>
<p><a href="posts/giss/giss-zone-anomalies/zones.html">Link To Plot</a></p>
</div>
</div>
<div class="outline-2" id="outline-container-org617254c">
<h2 id="org617254c">All Zones Overlay</h2>
<div class="outline-text-2" id="text-org617254c">
<p>The dropdown is a convenient way to look at different zones individually but make it hard to compare different zones. I'm going to put all of them on one plot first to get an overall picture.</p>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Difference From Normal"</span><span class="p">,</span> 
                        <span class="n">by</span><span class="o">=</span><span class="s2">"location"</span><span class="p">,</span> 
                        <span class="n">title</span><span class="o">=</span><span class="s2">"Difference by Zone"</span><span class="p">,</span> 
                        <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Difference From Normal"</span><span class="p">,</span>
                        <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> 
                        <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                            <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                        <span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">plot</span> <span class="o">*</span> <span class="n">line</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="s2">"all_zones"</span><span class="p">)()</span>
</pre></div>
<script id="3bf7c386-9e71-4449-a232-a8f788d7077d" src="posts/giss/giss-zone-anomalies/all_zones.js">
</script>
<p>This is kind of a messy plot, but it does show that the North Frigid and South Frigid zones seem to have the largest anomalies.</p>
</div>
<div class="outline-3" id="outline-container-orgc36fa95">
<h3 id="orgc36fa95">Hemisphere Spikes</h3>
<div class="outline-text-3" id="text-orgc36fa95">
<div class="highlight">
<pre><span></span><span class="n">hemisphere_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Global'</span><span class="p">:</span> <span class="s2">"Global"</span><span class="p">,</span> 
    <span class="s1">'Northern Hemisphere'</span><span class="p">:</span> <span class="s2">"Northern"</span><span class="p">,</span> 
    <span class="s1">'Southern Hemisphere'</span><span class="p">:</span> <span class="s2">"Southern"</span><span class="p">,</span>
    <span class="s1">'Northern Extratropics'</span><span class="p">:</span> <span class="s2">"Northern"</span><span class="p">,</span> 
    <span class="s1">'Tropics'</span><span class="p">:</span> <span class="s2">"Tropics"</span><span class="p">,</span> 
    <span class="s1">'Southern Extratropics'</span><span class="p">:</span> <span class="s2">"Southern"</span><span class="p">,</span>
    <span class="s1">'North Frigid'</span><span class="p">:</span> <span class="s2">"Northern"</span><span class="p">,</span> 
    <span class="s1">'North Temperate'</span><span class="p">:</span> <span class="s2">"Northern"</span><span class="p">,</span> 
    <span class="s1">'North Sub-Tropic'</span><span class="p">:</span> <span class="s2">"Northern"</span><span class="p">,</span>
    <span class="s1">'Tropic of Cancer'</span><span class="p">:</span> <span class="s2">"Northern"</span><span class="p">,</span> 
    <span class="s1">'Tropic of Capricorn'</span><span class="p">:</span> <span class="s2">"Southern"</span><span class="p">,</span> 
    <span class="s1">'South Sub-Tropic'</span><span class="p">:</span> <span class="s2">"Southern"</span><span class="p">,</span>
    <span class="s1">'South Temperate'</span><span class="p">:</span> <span class="s2">"Southern"</span><span class="p">,</span> 
    <span class="s1">'South Frigid'</span><span class="p">:</span> <span class="s2">"Southern"</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">giss_tidy</span><span class="p">[</span><span class="s2">"hemisphere"</span><span class="p">]</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">hemisphere_map</span><span class="p">)</span>
</pre></div>
<p>Separate out the hemispheres for plotting.</p>
<div class="highlight">
<pre><span></span><span class="n">northern</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">hemisphere</span><span class="o">==</span><span class="s2">"Northern"</span><span class="p">]</span>
<span class="n">southern</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">hemisphere</span><span class="o">==</span><span class="s2">"Southern"</span><span class="p">]</span>
<span class="n">global_anomalies</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">location</span><span class="o">==</span><span class="s2">"Global"</span><span class="p">]</span>
</pre></div>
<p>Plot.</p>
<div class="highlight">
<pre><span></span><span class="c1"># The Tools</span>
<span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
<span class="n">tooltips</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"@Year"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Difference from Normal"</span><span class="p">,</span> <span class="s2">"@{Difference From Normal}"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Hemisphere"</span><span class="p">,</span> <span class="s2">"@Hemisphere"</span><span class="p">),</span>
<span class="p">],</span>
    <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"Difference From Normal"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">northern_spikes</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span><span class="n">northern</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Difference From Normal"</span><span class="p">,</span> 
                                                      <span class="s2">"Difference From Normal"</span><span class="p">),</span>
                                   <span class="n">group</span><span class="o">=</span><span class="s2">"Hemisphere"</span><span class="p">,</span>
                                   <span class="n">label</span><span class="o">=</span><span class="s2">"Northern"</span><span class="p">)</span>
<span class="n">southern_spikes</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span><span class="n">southern</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Difference From Normal"</span><span class="p">,</span>
                                                      <span class="s2">"Difference From Normal"</span><span class="p">),</span> 
                                   <span class="n">group</span><span class="o">=</span><span class="s2">"Hemisphere"</span><span class="p">,</span>
                                   <span class="n">label</span><span class="o">=</span><span class="s2">"Southern"</span><span class="p">)</span>
<span class="n">overlay</span> <span class="o">=</span> <span class="p">(</span><span class="n">northern_spikes</span>
           <span class="o">*</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">northern_spikes</span><span class="p">)</span>
           <span class="o">*</span> <span class="n">southern_spikes</span>
           <span class="o">*</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">southern_spikes</span><span class="p">)</span>
           <span class="p">)</span>
<span class="n">overlay</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span><span class="s2">"Hemisphere.Northern"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">blue</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span><span class="s2">"Hemisphere.Southern"</span><span class="p">,</span> 
                <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> 
                <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">overlay</span> <span class="o">*</span> <span class="n">line</span>
<span class="n">bokeh_layout</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">bokeh_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text_font</span> <span class="o">=</span> <span class="s2">"open sans"</span>
<span class="n">bokeh_layout</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s2">"top_left"</span>
<span class="n">embed</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">bokeh_layout</span><span class="p">,</span> <span class="s2">"all_hemispheres"</span><span class="p">)</span>
<span class="n">embed</span><span class="o">.</span><span class="n">_figure</span> <span class="o">=</span> <span class="n">bokeh_layout</span>
<span class="n">embed</span><span class="p">()</span>
</pre></div>
<script id="9cc6d1ae-5342-408e-bb8c-2e21d827df92" src="posts/giss/giss-zone-anomalies/all_hemispheres.js">
</script>
<p>This one is a little hard to understand at first. All of the zones are still being plotted, but they are grouped by their hemisphere, so they look different from just the Hemisphere temperatures that come later. Mostly what you're seeing is a highlightt of the most anomalous zone for each year.</p>
<p>I also couldn't figure out how to get the zone information into the hovertool. With <code>hvPlot</code> you can pass in extra columns, but the <code>Spikes</code> didn't like it when I tried… such a frustrating library.</p>
<p>Anyway, it looks like the Northern Hemisphere started out below average while the Southern started out above average, then during the baseline period it sort of flipped, and now they're both above average, but the Northern is even more so.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orge21bbcd">
<h2 id="orge21bbcd">Hemispheres</h2>
<div class="outline-text-2" id="text-orge21bbcd">
<p>This plot shows what happens when you average the zones by hemisphere.</p>
<div class="highlight">
<pre><span></span><span class="n">hemispheres</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Global"</span><span class="p">,</span> <span class="s2">"Northern Hemisphere"</span><span class="p">,</span> <span class="s2">"Southern Hemisphere"</span><span class="p">]</span>
<span class="n">hemispheres</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">hemispheres</span><span class="p">)]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">hemispheres</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Difference From Normal"</span><span class="p">,</span> 
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Difference From Normal (C)"</span><span class="p">,</span>
                          <span class="n">by</span><span class="o">=</span><span class="s2">"location"</span><span class="p">,</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s2">"Difference by Hemisphere"</span><span class="p">,</span>
                          <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                          <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">plot</span> <span class="o">*</span> <span class="n">line</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="s2">"hemispheres"</span><span class="p">)()</span>
</pre></div>
<script id="2a28deb8-1fa0-4561-90ea-9061fbc88794" src="posts/giss/giss-zone-anomalies/hemispheres.js">
</script>
<p>This shows a different view than the Zones grouped by Hemisphere, as all the values start out below normal and move in sort of a linear fashion upwards. This probably is the result of the fact that the Frigid Zones are more extreme in their differences than the other zones, so averaging all of the zones supresses them. At least that's my initial thought. Looking at the previous plot, though, it looks quite different - the lowest value in the Hemispheres plot comes in 1917, while the zones grouped by hemisphere puts it at 1930 and 1917 actually doesn't look so special. Maybe they're calculated differently.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org8c04729">
<h2 id="org8c04729">Extratropics</h2>
<div class="outline-text-2" id="text-org8c04729">
<div class="highlight">
<pre><span></span><span class="n">zones</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Global"</span><span class="p">,</span> <span class="s2">"Northern Extratropics"</span><span class="p">,</span> <span class="s2">"Southern Extratropics"</span><span class="p">,</span> <span class="s2">"Tropics"</span><span class="p">]</span>
<span class="n">zones</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">zones</span><span class="p">)]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">zones</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Difference From Normal"</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">"location"</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Difference From Normal (C)"</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">"Tropics and Extratropics"</span><span class="p">,</span> 
                    <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">plot</span> <span class="o">*</span> <span class="n">line</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="s2">"tropics"</span><span class="p">)()</span>
</pre></div>
<script id="4021695f-d222-43bb-80ff-16a1aab7d12c" src="posts/giss/giss-zone-anomalies/tropics.js">
</script></div>
</div>
<div class="outline-2" id="outline-container-org9e07efb">
<h2 id="org9e07efb">The Zones</h2>
<div class="outline-text-2" id="text-org9e07efb">
<p>I did a previous plot "by zone" but in that case I was including all the zones given in the data. In this case we're only looking at the non-overlapping zones - so this chops up the planet by the smallest latitudinal zones that don't overlapy.</p>
<div class="highlight">
<pre><span></span><span class="n">zones</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"North Frigid"</span><span class="p">,</span> <span class="s2">"North Temperate"</span><span class="p">,</span> <span class="s2">"North Sub-Tropic"</span><span class="p">,</span> 
         <span class="s2">"Tropic of Cancer"</span><span class="p">,</span> <span class="s2">"Tropic of Capricorn"</span><span class="p">,</span>
         <span class="s2">"South Frigid"</span><span class="p">,</span> <span class="s2">"South Temperate"</span><span class="p">,</span> <span class="s2">"South Sub-Tropic"</span><span class="p">]</span>
<span class="n">zones</span> <span class="o">=</span>  <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">zones</span><span class="p">)]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">zones</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Difference From Normal"</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">"location"</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Difference From Normal (C)"</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">"Difference By (Non-Overlapping) Zones"</span><span class="p">,</span> 
                    <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HLine</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">plot</span> <span class="o">*</span> <span class="n">line</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="s2">"zones"</span><span class="p">)()</span>
</pre></div>
<script id="1fb8863b-4a0a-4d24-9ab7-746fa3af649f" src="posts/giss/giss-zone-anomalies/zones.js">
</script></div>
</div>
<div class="outline-2" id="outline-container-org6845a13">
<h2 id="org6845a13">Tabbed Plots</h2>
<div class="outline-text-2" id="text-org6845a13">
<div class="highlight">
<pre><span></span><span class="n">giss_tidy</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"location"</span><span class="p">:</span> <span class="s2">"Location"</span><span class="p">})</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">PlotGroups</span><span class="p">:</span>
    <span class="n">hemisphere</span> <span class="o">=</span> <span class="s2">"Hemishpere"</span>
    <span class="n">tropics</span> <span class="o">=</span> <span class="s2">"Tropics"</span>
    <span class="n">climate_zones</span> <span class="o">=</span> <span class="s2">"Zones"</span>

<span class="n">group_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Global"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">hemisphere</span><span class="p">,</span>
    <span class="s2">"Northern Hemisphere"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">hemisphere</span><span class="p">,</span>
    <span class="s2">"Southern Hemisphere"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">hemisphere</span><span class="p">,</span>
    <span class="s2">"Northern Extratropics"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">tropics</span><span class="p">,</span>
    <span class="s2">"Southern Extratropics"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">tropics</span><span class="p">,</span>
    <span class="s2">"Tropics"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">tropics</span><span class="p">,</span>
    <span class="s2">"North Frigid"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
    <span class="s2">"North Sub-Tropic"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
    <span class="s2">"North Temperate"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
    <span class="s2">"Tropic of Cancer"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
    <span class="s2">"Tropic of Capricorn"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
    <span class="s2">"South Temperate"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
    <span class="s2">"South Sub-Tropic"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
    <span class="s2">"South Frigid"</span><span class="p">:</span> <span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">giss_tidy</span><span class="p">[</span><span class="s2">"plot_group"</span><span class="p">]</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">group_map</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">hemispheric</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">plot_group</span><span class="o">==</span><span class="n">PlotGroups</span><span class="o">.</span><span class="n">hemisphere</span><span class="p">]</span>
<span class="n">tropical</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">plot_group</span><span class="o">==</span><span class="n">PlotGroups</span><span class="o">.</span><span class="n">tropics</span><span class="p">]</span>
<span class="n">zones</span> <span class="o">=</span> <span class="n">giss_tidy</span><span class="p">[</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">plot_group</span><span class="o">==</span><span class="n">PlotGroups</span><span class="o">.</span><span class="n">climate_zones</span><span class="p">]</span>

<span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hemispheric</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> 
        <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tropical</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> 
        <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">zones</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">giss_tidy</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">hemispheric</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">3</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tropical</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">3</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">zones</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">8</span><span class="p">,</span> <span class="n">zones</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">cross_hair</span> <span class="o">=</span> <span class="n">CrosshairTool</span><span class="p">()</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">hemispheric</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Difference From Normal"</span><span class="p">,</span> 
                           <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Difference From Historical Mean"</span><span class="p">,</span>
                           <span class="n">by</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">,</span>
                           <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> 
                           <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                           <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">cross_hair</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">"Hemispheres"</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">tropical</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Difference From Normal"</span><span class="p">,</span>
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Difference From Historical Mean"</span><span class="p">,</span>                          
                          <span class="n">by</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">,</span>
                          <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> 
                          <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                          <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">cross_hair</span><span class="p">])</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span>
                              <span class="s2">"Tropics vs Extra-Tropics"</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">zones</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Difference From Normal"</span><span class="p">,</span>
                       <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Difference From Historical Mean"</span><span class="p">,</span>                       
                       <span class="n">by</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">,</span>
                       <span class="n">width</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> 
                       <span class="n">height</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                       <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">cross_hair</span><span class="p">],</span>
                       <span class="p">)</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">"Climate Zones"</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">tabs</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">Plots</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>

<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"tabbed_plots"</span><span class="p">)()</span>
</pre></div>
<script id="605e4d9d-af93-4e83-a217-be0667c173ec" src="posts/giss/giss-zone-anomalies/tabbed_plots.js">
</script></div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/libraries/holoviews-gridded-data/">HoloViews Gridded Data</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/libraries/holoviews-gridded-data/" rel="bookmark"><time class="published dt-published" datetime="2019-03-04T16:50:25-08:00" itemprop="datePublished" title="2019-03-04 16:50">2019-03-04 16:50</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/libraries/holoviews-gridded-data/#orgc23ddfb">The Beginning</a></li>
<li><a href="posts/libraries/holoviews-gridded-data/#orgf04eb26">The Middle</a>
<ul>
<li><a href="posts/libraries/holoviews-gridded-data/#org96cf3af">Set Up</a></li>
<li><a href="posts/libraries/holoviews-gridded-data/#orgae96f31">Build It</a></li>
<li><a href="posts/libraries/holoviews-gridded-data/#org7d7e3a1">Save It</a></li>
</ul>
</li>
<li><a href="posts/libraries/holoviews-gridded-data/#org2d0a30b">The End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgc23ddfb">
<h2 id="orgc23ddfb">The Beginning</h2>
<div class="outline-text-2" id="text-orgc23ddfb">
<p>This is a reproduction of the HoloViews <a href="http://holoviews.org/getting_started/Gridded_Datasets.html">Gridded Datasets</a> example in the Getting Started section of their documentation to make sure that I can do it myself. The <i>Gridded Data</i> that they're referring to is data with more than two dimensions (a table has two dimensions - <i>columns</i> and <i>rows</i>). One way to display this type of data might be to use three dimensions (assuming there's only three), but the suggestion here is to use a slider to step through the data instead (so the third dimension is time or something similar).</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgf04eb26">
<h2 id="orgf04eb26">The Middle</h2>
<div class="outline-text-2" id="text-orgf04eb26"></div>
<div class="outline-3" id="outline-container-org96cf3af">
<h3 id="org96cf3af">Set Up</h3>
<div class="outline-text-3" id="text-org96cf3af"></div>
<div class="outline-4" id="outline-container-org344224e">
<h4 id="org344224e">Imports</h4>
<div class="outline-text-4" id="text-org344224e"></div>
<ul class="org-ul">
<li><a id="org4065a99"></a>Python<br>
<div class="outline-text-5" id="text-org4065a99">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</li>
<li><a id="org814b7bd"></a>PyPi<br>
<div class="outline-text-5" id="text-org814b7bd">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span>
<span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</li>
<li><a id="org0c313c8"></a>This Project<br>
<div class="outline-text-5" id="text-org0c313c8">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bartleby_the_penguin.tangles.embed_bokeh</span> <span class="kn">import</span> <span class="n">EmbedBokeh</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="outline-4" id="outline-container-org8ce25f8">
<h4 id="org8ce25f8">The Dotenv</h4>
<div class="outline-text-4" id="text-org8ce25f8">
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">".env"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org840c188">
<h4 id="org840c188">Bokeh</h4>
<div class="outline-text-4" id="text-org840c188">
<div class="highlight">
<pre><span></span><span class="c1">#+begin_src python :session holoviews :results none</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orge23402d">
<h4 id="orge23402d">The Embedder</h4>
<div class="outline-text-4" id="text-orge23402d">
<div class="highlight">
<pre><span></span><span class="n">files_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/libraries/holoviews-gridded-data/"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
    <span class="n">EmbedBokeh</span><span class="p">,</span>
    <span class="n">folder_path</span><span class="o">=</span><span class="n">files_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org9486358">
<h4 id="org9486358">The Output Path</h4>
<div class="outline-text-4" id="text-org9486358">
<p>This is where to store files and images that get created and need to get grabbed by nikola.</p>
<div class="highlight">
<pre><span></span><span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/libraries/holoviews-gridded-data"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orga0f9e22">
<h4 id="orga0f9e22">The Data</h4>
<div class="outline-text-4" id="text-orga0f9e22">
<div class="highlight">
<pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"PHOTONS"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">data_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_path</span><span class="p">))</span>
<span class="n">calcium</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"Calcium"</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">calcium</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
<pre class="example">
(62, 111, 50)

</pre>
<p>The <a href="https://www.numpy.org/devdocs/reference/generated/numpy.load.html">numpy.load</a> function loads a pickled dict-like object that doesn't unpickle the data until you retrieve it (e.g. when I created the <code>calcium</code> variable). The data is a 3D array of images with the third dimension representing time (it's a set of images that change over time) so there are 50 time-steps (I don't know what the imagaes actually are or what the time-intervals are).</p>
<p>I'm going to load the data into a HoloViews Dataset, but is going to need time, x, and y coordinates to render the images. To make it simpler I'll just pass in integer arrays with zero-indexed indices for the images. Since this isn't really a dataset that I care about I don't know what the orientation of the image is, but the example set it up as a wide image.</p>
<div class="highlight">
<pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Dataset</span><span class="p">((</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">111</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">62</span><span class="p">),</span> <span class="n">calcium</span><span class="p">),</span>
                             <span class="p">[</span><span class="s2">"Time"</span><span class="p">,</span> <span class="s2">"x"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">],</span> <span class="s2">"Fluoresence"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
</pre></div>
<pre class="example">
:Dataset   [Time,x,y]   (Fluoresence)

</pre>
<p>Note that holoviews treats labels in lists differently than tuples - if it's a tuple then it thinks it represents a <code>(&lt;variable&gt;, &lt;label&gt;)</code> pair and a list is treated as just labels, which is what we want here.</p>
<p>The example says that really we should have used <a href="http://xarray.pydata.org/en/stable/">xarray</a> to load the data, so this is how to convert it to and <code>xarray</code>.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">datatype</span><span class="o">=</span><span class="p">[</span><span class="s2">"xarray"</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
<pre class="example">
&lt;xarray.Dataset&gt;
Dimensions:      (Time: 50, x: 111, y: 62)
Coordinates:
  * Time         (Time) int64 0 1 2 3 4 5 6 7 8 9 ... 41 42 43 44 45 46 47 48 49
  * x            (x) int64 0 1 2 3 4 5 6 7 8 ... 103 104 105 106 107 108 109 110
  * y            (y) int64 0 1 2 3 4 5 6 7 8 9 ... 52 53 54 55 56 57 58 59 60 61
Data variables:
    Fluoresence  (y, x, Time) uint16 386 441 196 318 525 ... 806 801 899 583 774

</pre>
<p>But we want to use a Dataset, not an x-array so this was just for illustration…</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgae96f31">
<h3 id="orgae96f31">Build It</h3>
<div class="outline-text-3" id="text-orgae96f31"></div>
<div class="outline-4" id="outline-container-orga3b2e7e">
<h4 id="orga3b2e7e">Set Up the Plot</h4>
<div class="outline-text-4" id="text-orga3b2e7e">
<p>Before doing the plot I'll set the defaults for it.</p>
<div class="highlight">
<pre><span></span><span class="n">opts</span><span class="o">.</span><span class="n">defaults</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">GridSpace</span><span class="p">(</span><span class="n">shared_xaxis</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">shared_yaxis</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">"viridis"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span><span class="n">text_color</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span> <span class="n">text_font_size</span><span class="o">=</span><span class="s2">"8pt"</span><span class="p">,</span> <span class="n">text_align</span><span class="o">=</span><span class="s2">"left"</span><span class="p">,</span> <span class="n">text_baseline</span><span class="o">=</span><span class="s2">"bottom"</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"white"</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Spread</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">]),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Overlay</span><span class="p">(</span><span class="n">show_legend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
<p>Note that if you don't setup the backend with <code>holoviews.extension</code> then the opts won't have any of the attributes like <code>GridSpace</code>, <code>Image</code>, etc.</p>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">holoviews</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="p">[</span><span class="s2">"x"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">])</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">"grid_image.html"</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:{}][Link to the plot.]]"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
</pre></div>
<p><a href="posts/libraries/holoviews-gridded-data/grid_image.html">Link to the plot.</a></p>
</div>
</div>
<div class="outline-4" id="outline-container-org48b9ede">
<h4 id="org48b9ede">Zoom In</h4>
<div class="outline-text-4" id="text-org48b9ede">
<p>HoloViews provides a way to select out Regions of Interest (ROI). The pickle we loaded earlier has coordinates for rectangular bounding boxes in it (under the <code>ROIs</code> key).</p>
<div class="highlight">
<pre><span></span><span class="n">regions_of_interest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"ROIs"</span><span class="p">]</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Path</span><span class="p">([</span><span class="n">holoviews</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">region</span><span class="p">))</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions_of_interest</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">regions_of_interest</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
<pre class="example">
(147, 4)

</pre>
<div class="highlight">
<pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Labels</span><span class="p">([(</span><span class="n">roi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">roi</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">roi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">regions_of_interest</span><span class="p">)])</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_set</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">holoviews</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="p">[</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">])</span> <span class="o">*</span> <span class="n">bounds</span> <span class="o">*</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s1">'Time: 21'</span><span class="p">)</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">"bounds.html"</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)()</span>
</pre></div>
<script id="a580519d-4957-40b8-adf0-cee7d5de93f3" src="posts/libraries/holoviews-gridded-data/bounds.js">
</script></div>
</div>
<div class="outline-4" id="outline-container-org5ad461d">
<h4 id="org5ad461d">Select the Facet</h4>
<div class="outline-text-4" id="text-org5ad461d">
<div class="highlight">
<pre><span></span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">regions_of_interest</span><span class="p">[</span><span class="mi">60</span><span class="p">]</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">280</span><span class="p">))</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s1">'ROI #60'</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">holoviews</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="p">[</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">])</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">"selection.html"</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:{}][link]]"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
</pre></div>
<p><a href="posts/libraries/holoviews-gridded-data/selection.html">link</a></p>
</div>
</div>
<div class="outline-4" id="outline-container-org420aa07">
<h4 id="org420aa07">Mean and Standard Deviation</h4>
<div class="outline-text-4" id="text-org420aa07">
<div class="highlight">
<pre><span></span><span class="n">agg</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="s1">'Time'</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">spreadfn</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Spread</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span> <span class="o">*</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">"spread.html"</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"[[file:{}][Link]]"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
</pre></div>
<p><a href="posts/libraries/holoviews-gridded-data/spread.html">Link</a></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org7d7e3a1">
<h3 id="org7d7e3a1">Save It</h3>
</div>
</div>
<div class="outline-2" id="outline-container-org2d0a30b">
<h2 id="org2d0a30b">The End</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/libraries/aggregating-tabular-data/">Aggregating Tabular Data</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/libraries/aggregating-tabular-data/" rel="bookmark"><time class="published dt-published" datetime="2019-03-02T17:34:16-08:00" itemprop="datePublished" title="2019-03-02 17:34">2019-03-02 17:34</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/libraries/aggregating-tabular-data/#org4954f33">Set Up</a>
<ul>
<li><a href="posts/libraries/aggregating-tabular-data/#orgfc73a40">Imports</a></li>
<li><a href="posts/libraries/aggregating-tabular-data/#org5212970">Holoviews Bokeh</a></li>
<li><a href="posts/libraries/aggregating-tabular-data/#orgf23fd59">The Embedder</a></li>
<li><a href="posts/libraries/aggregating-tabular-data/#orga1c64b3">Dotenv</a></li>
</ul>
</li>
<li><a href="posts/libraries/aggregating-tabular-data/#orgc914948">Load the Data</a></li>
<li><a href="posts/libraries/aggregating-tabular-data/#orgb3f5d38">Convert the DataFrame to a Dataset</a></li>
<li><a href="posts/libraries/aggregating-tabular-data/#org62d5d69">Aggregate the Data</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org4954f33">
<h2 id="org4954f33">Set Up</h2>
<div class="outline-text-2" id="text-org4954f33"></div>
<div class="outline-3" id="outline-container-orgfc73a40">
<h3 id="orgfc73a40">Imports</h3>
<div class="outline-text-3" id="text-orgfc73a40"></div>
<div class="outline-4" id="outline-container-org2af64b4">
<h4 id="org2af64b4">Python</h4>
<div class="outline-text-4" id="text-org2af64b4">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org539da4f">
<h4 id="org539da4f">PyPi</h4>
<div class="outline-text-4" id="text-org539da4f">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgb10a09c">
<h4 id="orgb10a09c">My Projects</h4>
<div class="outline-text-4" id="text-orgb10a09c">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bartleby_the_penguin.tangles.embed_bokeh</span> <span class="kn">import</span> <span class="n">EmbedBokeh</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org5212970">
<h3 id="org5212970">Holoviews Bokeh</h3>
<div class="outline-text-3" id="text-org5212970">
<p>I don't know why but you have to specify that you're using <code>bokeh</code>, even though it looks like it's working when you don't.</p>
<div class="highlight">
<pre><span></span><span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf23fd59">
<h3 id="orgf23fd59">The Embedder</h3>
<div class="outline-text-3" id="text-orgf23fd59">
<div class="highlight">
<pre><span></span><span class="n">files_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/libraries/aggregating-tabular-data/"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
    <span class="n">EmbedBokeh</span><span class="p">,</span>
    <span class="n">folder_path</span><span class="o">=</span><span class="n">files_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orga1c64b3">
<h3 id="orga1c64b3">Dotenv</h3>
<div class="outline-text-3" id="text-orga1c64b3">
<p>I have the path to the data-set in a <code>.env</code> file so I'll load it into the environment dictionary.</p>
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">".env"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgc914948">
<h2 id="orgc914948">Load the Data</h2>
<div class="outline-text-2" id="text-orgc914948">
<p>This is the same measles/pertusis data that I used before.</p>
<div class="highlight">
<pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"DISEASES"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
    <span class="n">diseases</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb3f5d38">
<h2 id="orgb3f5d38">Convert the DataFrame to a Dataset</h2>
<div class="outline-text-2" id="text-orgb3f5d38">
<div class="highlight">
<pre><span></span><span class="n">key_dimensions</span> <span class="o">=</span> <span class="s2">"Year State"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">value_dimensions</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">"measles"</span><span class="p">,</span> <span class="s2">"Measles Incidence"</span><span class="p">),</span> <span class="p">(</span><span class="s2">"pertussis"</span><span class="p">,</span> <span class="s2">"Pertusis Incidence"</span><span class="p">)]</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">diseases</span><span class="p">,</span> <span class="n">key_dimensions</span><span class="p">,</span> <span class="n">value_dimensions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org62d5d69">
<h2 id="org62d5d69">Aggregate the Data</h2>
<div class="outline-text-2" id="text-org62d5d69">
<p>While I had aggregated the data before, this time I'm going to pass in the "Year" column as an argument so it won't keep the states separate.</p>
<div class="highlight">
<pre><span></span><span class="n">aggregator</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">spreadfn</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
<span class="n">error_bars</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">ErrorBars</span><span class="p">(</span><span class="n">aggregator</span><span class="p">,</span> <span class="n">vdims</span><span class="o">=</span><span class="p">[</span><span class="s2">"measles"</span><span class="p">,</span> <span class="s2">"measles_std"</span><span class="p">])</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">overlay</span> <span class="o">=</span> <span class="p">(</span><span class="n">holoviews</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">aggregator</span><span class="p">)</span> <span class="o">*</span> <span class="n">error_bars</span><span class="p">)</span><span class="o">.</span><span class="n">redim</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">measles</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">overlay</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">])</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"northwest_measles_aggregated"</span><span class="p">)()</span>
</pre></div>
<script id="e398babc-d5bc-451c-bb10-02ce9f5163d0" src="posts/libraries/aggregating-tabular-data/northwest_measles_aggregated.js">
</script></div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/libraries/selecting-tabular-data/">Selecting Tabular Data</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/libraries/selecting-tabular-data/" rel="bookmark"><time class="published dt-published" datetime="2019-03-02T16:25:15-08:00" itemprop="datePublished" title="2019-03-02 16:25">2019-03-02 16:25</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/libraries/selecting-tabular-data/#org4587e13">Set Up</a>
<ul>
<li><a href="posts/libraries/selecting-tabular-data/#org2003068">Imports</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#orge35558c">Holoviews Bokeh</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#orga8c2029">The Embedder</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#org58432ce">Dotenv</a></li>
</ul>
</li>
<li><a href="posts/libraries/selecting-tabular-data/#orgafb4206">Load the Data</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#orgdb87dc2">Convert the DataFrame to a Dataset</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#org5ab9b27">Aggregate The Data</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#org20442db">Plot a Subset</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#org4ab4750">Facets</a></li>
<li><a href="posts/libraries/selecting-tabular-data/#orgbdb33cb">Overlays</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org4587e13">
<h2 id="org4587e13">Set Up</h2>
<div class="outline-text-2" id="text-org4587e13"></div>
<div class="outline-3" id="outline-container-org2003068">
<h3 id="org2003068">Imports</h3>
<div class="outline-text-3" id="text-org2003068"></div>
<div class="outline-4" id="outline-container-org3b182c3">
<h4 id="org3b182c3">Python</h4>
<div class="outline-text-4" id="text-org3b182c3">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org0d6034e">
<h4 id="org0d6034e">PyPi</h4>
<div class="outline-text-4" id="text-org0d6034e">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org6e429f5">
<h4 id="org6e429f5">My Projects</h4>
<div class="outline-text-4" id="text-org6e429f5">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bartleby_the_penguin.tangles.embed_bokeh</span> <span class="kn">import</span> <span class="n">EmbedBokeh</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orge35558c">
<h3 id="orge35558c">Holoviews Bokeh</h3>
<div class="outline-text-3" id="text-orge35558c">
<p>I don't know why but you have to specify that you're using <code>bokeh</code>, even though it looks like it's working when you don't.</p>
<div class="highlight">
<pre><span></span><span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orga8c2029">
<h3 id="orga8c2029">The Embedder</h3>
<div class="outline-text-3" id="text-orga8c2029">
<div class="highlight">
<pre><span></span><span class="n">files_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/libraries/selecting-tabular-data/"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
    <span class="n">EmbedBokeh</span><span class="p">,</span>
    <span class="n">folder_path</span><span class="o">=</span><span class="n">files_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org58432ce">
<h3 id="org58432ce">Dotenv</h3>
<div class="outline-text-3" id="text-org58432ce">
<p>I have the path to the data-set in a <code>.env</code> file so I'll load it into the environment dictionary.</p>
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">".env"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgafb4206">
<h2 id="orgafb4206">Load the Data</h2>
<div class="outline-text-2" id="text-orgafb4206">
<p>This is the same measles/pertusis data that I used before.</p>
<div class="highlight">
<pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"DISEASES"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
    <span class="n">diseases</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">orgtable</span><span class="p">(</span><span class="n">diseases</span><span class="o">.</span><span class="n">head</span><span class="p">()))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Year</th>
<th class="org-right" scope="col">Week</th>
<th class="org-left" scope="col">State</th>
<th class="org-right" scope="col">measles</th>
<th class="org-right" scope="col">pertussis</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1928</td>
<td class="org-right">1</td>
<td class="org-left">Alabama</td>
<td class="org-right">3.67</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">2</td>
<td class="org-left">Alabama</td>
<td class="org-right">6.25</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">3</td>
<td class="org-left">Alabama</td>
<td class="org-right">7.95</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">4</td>
<td class="org-left">Alabama</td>
<td class="org-right">12.58</td>
<td class="org-right">nan</td>
</tr>
<tr>
<td class="org-right">1928</td>
<td class="org-right">5</td>
<td class="org-left">Alabama</td>
<td class="org-right">8.03</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="outline-2" id="outline-container-orgdb87dc2">
<h2 id="orgdb87dc2">Convert the DataFrame to a Dataset</h2>
<div class="outline-text-2" id="text-orgdb87dc2">
<div class="highlight">
<pre><span></span><span class="n">key_dimensions</span> <span class="o">=</span> <span class="s2">"Year State"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">value_dimensions</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">"measles"</span><span class="p">,</span> <span class="s2">"Measles Incidence"</span><span class="p">),</span> <span class="p">(</span><span class="s2">"pertussis"</span><span class="p">,</span> <span class="s2">"Pertusis Incidence"</span><span class="p">)]</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">diseases</span><span class="p">,</span> <span class="n">key_dimensions</span><span class="p">,</span> <span class="n">value_dimensions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org5ab9b27">
<h2 id="org5ab9b27">Aggregate The Data</h2>
<div class="outline-text-2" id="text-org5ab9b27">
<div class="highlight">
<pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
<pre class="example">
:Dataset   [Year,State]   (measles,pertussis)
(4284, 4)

</pre></div>
</div>
<div class="outline-2" id="outline-container-org20442db">
<h2 id="org20442db">Plot a Subset</h2>
<div class="outline-text-2" id="text-org20442db">
<div class="highlight">
<pre><span></span><span class="n">northwest</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Oregon"</span><span class="p">,</span> <span class="s2">"Washington"</span><span class="p">,</span> <span class="s2">"Idaho"</span><span class="p">]</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">State</span><span class="o">=</span><span class="n">northwest</span><span class="p">,</span> <span class="n">Year</span><span class="o">=</span><span class="p">(</span><span class="mi">1928</span><span class="p">,</span> <span class="mi">1938</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
    <span class="n">holoviews</span><span class="o">.</span><span class="n">Bars</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"State"</span><span class="p">],</span> <span class="s2">"measles"</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Bars</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">],</span> <span class="n">xrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"northwest_measles"</span><span class="p">)()</span>
</pre></div>
<script id="9711b5b4-83ef-4e9e-b406-5fe3859f6bf3" src="posts/libraries/selecting-tabular-data/northwest_measles.js">
</script>
<p>As with all things HoloViews, there are many things that are unclear here - but the one that really tripped me up was the selection of years. Although I passed in a tuple it used it as a range (start, stop) so my original plot had a century instead of two years. Oh, well.</p>
<p>Interesting how Oregon spiked up in 1935 and 1936 then dropped down in 1937. According to <a href="https://www.cdc.gov/measles/about/history.html">the CDC</a>, the measles vaccine didn't come out until 1963, so I guess those ebb-and-flows are just the normal way diseases cycle through populations. Oregon and Washington probably had more immigrants than Idaho, as well as higher population densities in their main cities, which might account for their higher rates. Hard to say without corellating data.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org4ab4750">
<h2 id="org4ab4750">Facets</h2>
<div class="outline-text-2" id="text-org4ab4750">
<p>The bar-plot is okay for comparing the cities within any given year but they are hard to get trends from. Here's how to use selecting to plot lines for each city.</p>
<div class="highlight">
<pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">State</span><span class="o">=</span><span class="n">northwest</span><span class="p">,</span> <span class="n">Year</span><span class="o">=</span><span class="p">(</span><span class="mi">1928</span><span class="p">,</span> <span class="mi">2011</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">holoviews</span><span class="o">.</span><span class="n">Curve</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"measles"</span><span class="p">)</span>
<span class="n">gridspace</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s2">"State"</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">gridspace</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"crimson"</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"northwest_measles_grid"</span><span class="p">)()</span>
</pre></div>
<script id="e0183ad8-47df-4d67-befe-c2c4ba24e369" src="posts/libraries/selecting-tabular-data/northwest_measles_grid.js">
</script></div>
</div>
<div class="outline-2" id="outline-container-orgbdb33cb">
<h2 id="orgbdb33cb">Overlays</h2>
<div class="outline-text-2" id="text-orgbdb33cb">
<p>While the side-by-side plots are clearer than the bar-plots, it's harder to compare the cities year-by-year, so it might be better to plot them over each other.</p>
<div class="highlight">
<pre><span></span><span class="n">overlay</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">overlay</span><span class="p">(</span><span class="s2">"State"</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">overlay</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">holoviews</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">"crimson"</span><span class="p">,</span> <span class="s2">"slateblue"</span><span class="p">,</span> <span class="s2">"cadetblue"</span><span class="p">]))</span>
<span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"northwest_measles_overlay"</span><span class="p">)()</span>
</pre></div>
<script id="a78fd3e5-9234-410a-b6f3-267875eab6aa" src="posts/libraries/selecting-tabular-data/northwest_measles_overlay.js">
</script></div>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="previous"><a href="." rel="prev">Newer posts</a></li>
<li class="next"><a href="index-1.html" rel="next">Older posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Contents © 2019 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="assets/js/all-nocdn.js">
</script><!-- fancy dates -->
<script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
</script><!-- end fancy dates -->
<script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>
</body>
</html>
