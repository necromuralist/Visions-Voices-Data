<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Adumbrations of data." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Visions, Voices, Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Visions-Voices-Data/" rel="canonical">
<link href="index-4.html" rel="next" type="text/html"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script><!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"
</script>
-->
<script async src="javascript/p5.min.js" type="text/javascript"></script>
<link href="/posts/libraries/snorkel/snorkel-example-building-a-spam-dataset/" rel="prefetch" type="text/html">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/Visions-Voices-Data/"><span id="blog-title">Visions, Voices, Data</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="/categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="/rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pages</a>
<div class="dropdown-menu"><a class="dropdown-item active" href="/">Cloistered Monkey <span class="sr-only">(active)</span></a> <a class="dropdown-item" href="/pages/giss/giss-yearly-anomalies-by-climate-zone">GISS Anomalies</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Visions-Voices-Data/"> <input name="k8" type="hidden" value="#444444"> <input name="k9" type="hidden" value="#D51920"> <input name="kt" type="hidden" value="h"> <input class="span2" maxlength="255" name="q" placeholder="Search‚Ä¶" type="text"> <input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/libraries/snorkel/snorkel-example-building-a-spam-dataset/">Snorkel Example: Building a Spam Dataset</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/libraries/snorkel/snorkel-example-building-a-spam-dataset/" rel="bookmark"><time class="published dt-published" datetime="2020-01-06T17:40:40-08:00" itemprop="datePublished" title="2020-01-06 17:40">2020-01-06 17:40</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div class="outline-2" id="outline-container-org986c5b6">
<h2 id="org986c5b6">Beginning</h2>
<div class="outline-text-2" id="text-org986c5b6">
<p>This is a walk-through of the Snorkel <a href="https://www.snorkel.org/get-started/">Get Started</a> tutorial which shows how you can use it to build a labeled dataset. It uses the <a href="http://www.dt.fee.unicamp.br/~tiago//youtubespamcollection/">YouTube Spam Collection</a> data set (downloaded from the <a href="https://archive.ics.uci.edu/ml/datasets/YouTube+Spam+Collection">UCI Machine Learning Repository</a>). The data was collected in 2015 and represents comments from five of the ten most popular videos on YouTube. It is a tabular dataset with the columns <code>COMMENT_ID</code>, <code>AUTHOR</code>, <code>DATE</code>, <code>CONTENT</code>, <code>TAG</code>. The tag represents whether it was considered <i>Spam</i> or not, so we'll pretend it isn't there for most of this walk-through.</p>
</div>
<div class="outline-3" id="outline-container-org149dbb7">
<h3 id="org149dbb7">Imports</h3>
<div class="outline-text-3" id="text-org149dbb7"></div>
<div class="outline-4" id="outline-container-orga1876b8">
<h4 id="orga1876b8">Python</h4>
<div class="outline-text-4" id="text-orga1876b8">
<div class="highlight">
<pre><span></span>from argparse import Namespace
from functools import partial
from pathlib import Path
import re
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org328295c">
<h4 id="org328295c">PyPi</h4>
<div class="outline-text-4" id="text-org328295c">
<div class="highlight">
<pre><span></span>from sklearn.model_selection import train_test_split
from snorkel.labeling import labeling_function, LabelModel, PandasLFApplier
from textblob import TextBlob
import hvplot.pandas
import pandas
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org018f22d">
<h4 id="org018f22d">Others</h4>
<div class="outline-text-4" id="text-org018f22d">
<div class="highlight">
<pre><span></span>from graeae import CountPercentage, EmbedHoloviews
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org5e1c14a">
<h3 id="org5e1c14a">Set Up</h3>
<div class="outline-text-3" id="text-org5e1c14a"></div>
<div class="outline-4" id="outline-container-orge820db5">
<h4 id="orge820db5">Plotting</h4>
<div class="outline-text-4" id="text-orge820db5">
<div class="highlight">
<pre><span></span>Embed = partial(EmbedHoloviews, folder_path="../../../files/posts/libraries/snorkel/snorkel-example-building-a-spam-dataset")
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgcee9dc2">
<h4 id="orgcee9dc2">The Dataset</h4>
<div class="outline-text-4" id="text-orgcee9dc2">
<p>The data is split up into separate files - one for each artist/video (they are named after the artist and each only appears to have one entry) so I'm going to smash them back together and add a <code>artist</code> column.</p>
<div class="highlight">
<pre><span></span>path = Path("~/data/datasets/texts/you_tube_comments/").expanduser()
sets = []
for name in path.glob("*.csv"):
    artist = name.stem.split()[-1]
    data = pandas.read_csv(name)
    data["artist"] = artist
    sets.append(data)
    print(artist)
data = pandas.concat(sets)
</pre></div>
<pre class="example">
KatyPerry
LMFAO
Eminem
Shakira
Psy
</pre></div>
</div>
<div class="outline-4" id="outline-container-org1765f19">
<h4 id="org1765f19">Splitting the Set</h4>
<div class="outline-text-4" id="text-org1765f19">
<div class="highlight">
<pre><span></span>train, test = train_test_split(data)
print(train.shape)
print(test.shape)

train, development = train_test_split(train)
validation, test = train_test_split(test)
print(train.shape)
print(development.shape)
print(validation.shape)
print(test.shape)
</pre></div>
<pre class="example">
(1467, 6)
(489, 6)
(1100, 6)
(367, 6)
(366, 6)
(123, 6)
</pre>
<div class="highlight">
<pre><span></span>grouped = train.groupby(["artist"]).agg({"COMMENT_ID": "count"}).reset_index().rename(columns={"COMMENT_ID": "Count"})
plot = grouped.hvplot.bar(x="artist", y="Count").opts(title="Comments by Artist", width=1000, height=800)
Embed(plot=plot, file_name="comments_by_artist")()
</pre></div>
<object data="/posts/libraries/snorkel/snorkel-example-building-a-spam-dataset/comments_by_artist.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>grouped = train.groupby(["artist", "CLASS"]).agg({"COMMENT_ID": "count"}).reset_index().rename(columns={"COMMENT_ID": "Count"})
plot = grouped.hvplot.bar(x="artist", y="Count", by="CLASS").opts(title="Comments by Artist and Class", width=1000, height=800)
Embed(plot=plot, file_name="comments_by_artist_and_class")()
</pre></div>
<object data="/posts/libraries/snorkel/snorkel-example-building-a-spam-dataset/comments_by_artist_and_class.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>I said earlier that the spam/not-spam column was named tag, but its named <code>CLASS</code> here, I don't know where the switch came (it says <code>TAG</code> on the UCI page).</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf3f3a33">
<h3 id="orgf3f3a33">Labeling Functions</h3>
<div class="outline-text-3" id="text-orgf3f3a33">
<p>Labeling functions output a label for values in the training set.</p>
</div>
<div class="outline-4" id="outline-container-org540215f">
<h4 id="org540215f">Labels</h4>
<div class="outline-text-4" id="text-org540215f">
<div class="highlight">
<pre><span></span>Label = Namespace(
    abstain = -1,
    not_spam = 0,
    spam = 1,
)
</pre></div>
<p>The actual data-set only has spam/not-spam classes, but the Snorkel tutorial adds the <code>abstain</code> class as well. Each function is going to be passed a row from the training dataframe, so the class name you use has to match it.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org53ef068">
<h4 id="org53ef068">Keyword Matching</h4>
<div class="outline-text-4" id="text-org53ef068">
<div class="highlight">
<pre><span></span>@labeling_function()
def labeling_by_keyword(comment: pandas.Series) -&gt; int:
    """Assume if the author refers to something he/she owns it's spam

    Args: 
     row with comment CONTENT

    Returns:
     label for the comment
    """
    return Label.spam if "my" in comment.CONTENT.lower() else Label.abstain
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org85ff95a">
<h4 id="org85ff95a">Regular Expressions</h4>
<div class="outline-text-4" id="text-org85ff95a">
<div class="highlight">
<pre><span></span>@labeling_function()
def label_check_out(comment) -&gt; int:
    """check my/it/the out will be spam"""
    return Label.spam if re.search(r"check.*out", comment.CONTENT, flags=re.I) else Label.abstain
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org8fe2c13">
<h4 id="org8fe2c13">Short Comments</h4>
<div class="outline-text-4" id="text-org8fe2c13">
<div class="highlight">
<pre><span></span>@labeling_function()
def label_short_comment(comment) -&gt; int:
    """if a comment is short it's probably not spam"""
    return Label.not_spam if len(comment.CONTENT.split()) &lt; 5 else Label.abstain
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgfb198ad">
<h4 id="orgfb198ad">Positive Comments</h4>
<div class="outline-text-4" id="text-orgfb198ad">
<p>Here we'll use <a href="https://textblob.readthedocs.io/en/dev/">textblob</a> to try and decide on whether a comment is positive (textblob uses <a href="https://www.clips.uantwerpen.be/pattern">pattern</a> to decide on the polarity.)</p>
<div class="highlight">
<pre><span></span>@labeling_function()
def label_positive_comment(comment) -&gt; int:
    """If a comment is positive, we'll accept it"""
    return Label.not_spam if TextBlob(comment.CONTENT).sentiment.polarity &gt; 0.3 else Label.abstain
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgfd31182">
<h4 id="orgfd31182">Combining the Functions and Cleaning the Labels</h4>
<div class="outline-text-4" id="text-orgfd31182">
<p>First I'll create a list of the labeling functions so that we can pass it to the label-applier class.</p>
<div class="highlight">
<pre><span></span>labeling_functions = [labeling_by_keyword, label_check_out, label_short_comment, label_positive_comment]
</pre></div>
<p>Now create the applier.</p>
<div class="highlight">
<pre><span></span>applier = PandasLFApplier(labeling_functions)
</pre></div>
<p>Now create it.</p>
<div class="highlight">
<pre><span></span>label_matrix = applier.apply(train, progress_bar=False)

print(label_matrix.shape)
print(train.shape)
</pre></div>
<pre class="example">
(1100, 4)
(1100, 6)
</pre>
<p>The label-matrix has one row for each of the comments in our training set and one column for each of our labeling functions.</p>
<div class="highlight">
<pre><span></span>label_frame = pandas.DataFrame(label_matrix, columns=["keyword", "check_out", "short", "positive"])
</pre></div>
<div class="highlight">
<pre><span></span>re_framed = {}

for column in label_frame.columns:
    re_framed[column] = 
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orge6e2690">
<h4 id="orge6e2690">Training the Label Model</h4>
<div class="outline-text-4" id="text-orge6e2690">
<div class="highlight">
<pre><span></span>label_model = LabelModel(cardinality=2, verbose=True)
label_model.fit(label_matrix, n_epochs=500, log_freq=50, seed=0)
train["label"] = label_model.predict(L=label_matrix, tie_break_policy="abstain")
</pre></div>
<div class="highlight">
<pre><span></span>grouped = train.groupby(["label", "artist"]).agg({"COMMENT_ID": "count"}).reset_index().rename(columns={"COMMENT_ID": "count"})
plot = grouped.hvplot.bar(x="label", y="count", by="artist").opts(title="Label Counts", height=800, width=1000)
Embed(plot=plot, file_name="label_counts")()
</pre></div>
<object data="/posts/libraries/snorkel/snorkel-example-building-a-spam-dataset/label_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Most comments were labeled spam or not-spam, but some were abstained. In order to move on to the next section, we'll drop the rows where an opinion about the label was abstained.</p>
<div class="highlight">
<pre><span></span>train = train[train.label != Label.abstain]
CountPercentage(train.label)()
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Value</th>
<th class="org-right" scope="col">Count</th>
<th class="org-right" scope="col">Percent (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">419</td>
<td class="org-right">53.51</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">364</td>
<td class="org-right">46.49</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/libraries/trying-out-dabest/">Trying out DABEST</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/libraries/trying-out-dabest/" rel="bookmark"><time class="published dt-published" datetime="2019-12-16T13:50:24-08:00" itemprop="datePublished" title="2019-12-16 13:50">2019-12-16 13:50</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/libraries/trying-out-dabest/#org11bd7bb">Beginning</a>
<ul>
<li><a href="/posts/libraries/trying-out-dabest/#orgdb433f1">Imports</a></li>
<li><a href="/posts/libraries/trying-out-dabest/#org28995cc">Set Up</a></li>
</ul>
</li>
<li><a href="/posts/libraries/trying-out-dabest/#org0ef2ac9">Middle</a>
<ul>
<li><a href="/posts/libraries/trying-out-dabest/#orgd119e94">Petal Width</a></li>
<li><a href="/posts/libraries/trying-out-dabest/#org5d88711">Hedge's G</a></li>
<li><a href="/posts/libraries/trying-out-dabest/#orgeb657d5">Cohen's D</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org11bd7bb">
<h2 id="org11bd7bb">Beginning</h2>
<div class="outline-text-2" id="text-org11bd7bb"></div>
<div class="outline-3" id="outline-container-orgdb433f1">
<h3 id="orgdb433f1">Imports</h3>
<div class="outline-text-3" id="text-orgdb433f1"></div>
<div class="outline-4" id="outline-container-org6aed581">
<h4 id="org6aed581">PyPi</h4>
<div class="outline-text-4" id="text-org6aed581">
<div class="highlight">
<pre><span></span>from sklearn.datasets import load_iris
import dabest
import pandas
import seaborn
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org28995cc">
<h3 id="org28995cc">Set Up</h3>
<div class="outline-text-3" id="text-org28995cc"></div>
<div class="outline-4" id="outline-container-org49fbab0">
<h4 id="org49fbab0">The Data Set</h4>
<div class="outline-text-4" id="text-org49fbab0">
<div class="highlight">
<pre><span></span>iris = load_iris()
</pre></div>
<div class="highlight">
<pre><span></span>print(iris.DESCR)
</pre></div>
<pre class="example">
Iris plants dataset
--------------------

**Data Set Characteristics:**

    :Number of Instances: 150 (50 in each of three classes)
    :Number of Attributes: 4 numeric, predictive attributes and the class
    :Attribute Information:
        - sepal length in cm
        - sepal width in cm
        - petal length in cm
        - petal width in cm
        - class:
                - Iris-Setosa
                - Iris-Versicolour
                - Iris-Virginica
                
    :Summary Statistics:

    ============== ==== ==== ======= ===== ====================
                    Min  Max   Mean    SD   Class Correlation
    ============== ==== ==== ======= ===== ====================
    sepal length:   4.3  7.9   5.84   0.83    0.7826
    sepal width:    2.0  4.4   3.05   0.43   -0.4194
    petal length:   1.0  6.9   3.76   1.76    0.9490  (high!)
    petal width:    0.1  2.5   1.20   0.76    0.9565  (high!)
    ============== ==== ==== ======= ===== ====================

    :Missing Attribute Values: None
    :Class Distribution: 33.3% for each of 3 classes.
    :Creator: R.A. Fisher
    :Donor: Michael Marshall (MARSHALL%PLU@io.arc.nasa.gov)
    :Date: July, 1988

The famous Iris database, first used by Sir R.A. Fisher. The dataset is taken
from Fisher's paper. Note that it's the same as in R, but not as in the UCI
Machine Learning Repository, which has two wrong data points.

This is perhaps the best known database to be found in the
pattern recognition literature.  Fisher's paper is a classic in the field and
is referenced frequently to this day.  (See Duda & Hart, for example.)  The
data set contains 3 classes of 50 instances each, where each class refers to a
type of iris plant.  One class is linearly separable from the other 2; the
latter are NOT linearly separable from each other.

.. topic:: References

   - Fisher, R.A. "The use of multiple measurements in taxonomic problems"
     Annual Eugenics, 7, Part II, 179-188 (1936); also in "Contributions to
     Mathematical Statistics" (John Wiley, NY, 1950).
   - Duda, R.O., & Hart, P.E. (1973) Pattern Classification and Scene Analysis.
     (Q327.D83) John Wiley & Sons.  ISBN 0-471-22361-1.  See page 218.
   - Dasarathy, B.V. (1980) "Nosing Around the Neighborhood: A New System
     Structure and Classification Rule for Recognition in Partially Exposed
     Environments".  IEEE Transactions on Pattern Analysis and Machine
     Intelligence, Vol. PAMI-2, No. 1, 67-71.
   - Gates, G.W. (1972) "The Reduced Nearest Neighbor Rule".  IEEE Transactions
     on Information Theory, May 1972, 431-433.
   - See also: 1988 MLC Proceedings, 54-64.  Cheeseman et al"s AUTOCLASS II
     conceptual clustering system finds 3 classes in the data.
   - Many, many more ...
</pre>
<div class="highlight">
<pre><span></span>data = pandas.DataFrame(iris.data, columns=iris.feature_names)
target = pandas.Series(iris.target)
names = dict(zip(range(len(iris.target_names)), iris.target_names))
data["species"] = target.map(names)
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org0ef2ac9">
<h2 id="org0ef2ac9">Middle</h2>
<div class="outline-text-2" id="text-org0ef2ac9"></div>
<div class="outline-3" id="outline-container-orgd119e94">
<h3 id="orgd119e94">Petal Width</h3>
<div class="outline-text-3" id="text-orgd119e94">
<div class="highlight">
<pre><span></span>iris_dabest = dabest.load(data=data, x="species", y="petal width (cm)", idx=iris.target_names)
iris_dabest.mean_diff.plot()
</pre></div>
<div class="figure">
<p><img alt="petal_width.png" src="/posts/libraries/trying-out-dabest/petal_width.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org5d88711">
<h3 id="org5d88711">Hedge's G</h3>
<div class="outline-text-3" id="text-org5d88711">
<p><a href="https://www.itl.nist.gov/div898/software/dataplot/refman2/auxillar/hedgeg.htm">Hedges G</a> is a measurement of effect size, similar to Cohen's d but with better properties when the samples are smaller or the sample sizes are different.</p>
<div class="highlight">
<pre><span></span>iris_dabest.hedges_g.plot()
</pre></div>
<div class="figure">
<p><img alt="hedges_g.png" src="/posts/libraries/trying-out-dabest/hedges_g.png"></p>
</div>
<div class="highlight">
<pre><span></span>print(iris_dabest.hedges_g)
</pre></div>
<pre class="example">
DABEST v0.2.7
=============
             
Good afternoon!
The current time is Mon Dec 16 15:56:24 2019.

The unpaired Hedges' g between setosa and versicolor is 6.76 [95%CI 5.71, 7.86].
The two-sided p-value of the Mann-Whitney test is 2.28e-18.

The unpaired Hedges' g between setosa and virginica is 8.49 [95%CI 7.08, 9.77].
The two-sided p-value of the Mann-Whitney test is 2.43e-18.

5000 bootstrap samples were taken; the confidence interval is bias-corrected and accelerated.
The p-value(s) reported are the likelihood(s) of observing the effect size(s),
if the null hypothesis of zero difference is true.

To get the results of all valid statistical tests, use `.hedges_g.statistical_tests`
</pre>
<p>According to <a href="https://www.wikiwand.com/en/Effect_size">Wikipedia</a>, an effect size of 2 is "huge" so since the differences between the setosa and versicolor and setosa and virginica are 6.76 and 8.49 respectively, we might conclude that there is a significant difference between the petal width of the setosa and the other two species.</p>
<p>I don't think that's really what this is meant for, but I just wanted to see how it works.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgeb657d5">
<h3 id="orgeb657d5">Cohen's D</h3>
<div class="outline-text-3" id="text-orgeb657d5">
<div class="highlight">
<pre><span></span>iris_dabest.cohens_d.plot()
</pre></div>
<div class="figure">
<p><img alt="cohens_d.png" src="/posts/libraries/trying-out-dabest/cohens_d.png"></p>
</div>
<div class="highlight">
<pre><span></span>print(iris_dabest.cohens_d)
</pre></div>
<pre class="example">
DABEST v0.2.7
=============
             
Good afternoon!
The current time is Mon Dec 16 16:46:25 2019.

The unpaired Cohen's d between setosa and versicolor is 6.82 [95%CI 5.76, 7.92].
The two-sided p-value of the Mann-Whitney test is 2.28e-18.

The unpaired Cohen's d between setosa and virginica is 8.56 [95%CI 7.13, 9.85].
The two-sided p-value of the Mann-Whitney test is 2.43e-18.

5000 bootstrap samples were taken; the confidence interval is bias-corrected and accelerated.
The p-value(s) reported are the likelihood(s) of observing the effect size(s),
if the null hypothesis of zero difference is true.

To get the results of all valid statistical tests, use `.cohens_d.statistical_tests`
</pre>
<p>In this case the Cohen's d and Hedges g look similar.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/data/a-first-look-at-snorkel/">A First Look At Snorkel</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/data/a-first-look-at-snorkel/" rel="bookmark"><time class="published dt-published" datetime="2019-09-26T14:47:16-07:00" itemprop="datePublished" title="2019-09-26 14:47">2019-09-26 14:47</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/data/a-first-look-at-snorkel/#org83af856">Beginning</a>
<ul>
<li><a href="/posts/data/a-first-look-at-snorkel/#org50b1cc8">Imports</a>
<ul>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgbef0233">Python</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#org1cfa078">PyPi</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgeef6a87">Others</a></li>
</ul>
</li>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgbeae10d">Set Up</a>
<ul>
<li><a href="/posts/data/a-first-look-at-snorkel/#org5c6ade9">Some Constants</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#org64c9634">The Plotting</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgfbafcf0">The Data Set</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgaf96094">Rename the Columns</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/data/a-first-look-at-snorkel/#org12c172b">Middle</a>
<ul>
<li><a href="/posts/data/a-first-look-at-snorkel/#org88e7e5b">Setting Up the Training and Testing Sets</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgad9c906">Looking at the Data</a>
<ul>
<li><a href="/posts/data/a-first-look-at-snorkel/#org6025f0a">Spam and Ham</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#org5b86e70">The Dates</a></li>
<li><a href="/posts/data/a-first-look-at-snorkel/#org04c222b">Some Samples</a></li>
</ul>
</li>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgb646f5e">Labeling Functions</a></li>
</ul>
</li>
<li><a href="/posts/data/a-first-look-at-snorkel/#orgd3004ee">End</a>
<ul>
<li><a href="/posts/data/a-first-look-at-snorkel/#org5d50667">Citations</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org83af856">
<h2 id="org83af856">Beginning</h2>
<div class="outline-text-2" id="text-org83af856">
<p>This is a walk-through of Snorkel's <a href="https://www.snorkel.org/get-started/">Get Started</a> page.</p>
</div>
<div class="outline-3" id="outline-container-org50b1cc8">
<h3 id="org50b1cc8">Imports</h3>
<div class="outline-text-3" id="text-org50b1cc8"></div>
<div class="outline-4" id="outline-container-orgbef0233">
<h4 id="orgbef0233">Python</h4>
<div class="outline-text-4" id="text-orgbef0233">
<div class="highlight">
<pre><span></span>from argparse import Namespace
from datetime import datetime
from functools import partial
from pathlib import Path
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org1cfa078">
<h4 id="org1cfa078">PyPi</h4>
<div class="outline-text-4" id="text-org1cfa078">
<div class="highlight">
<pre><span></span>from sklearn.model_selection import train_test_split
import hvplot.pandas
import pandas
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgeef6a87">
<h4 id="orgeef6a87">Others</h4>
<div class="outline-text-4" id="text-orgeef6a87">
<div class="highlight">
<pre><span></span>from graeae import CountPercentage, EmbedHoloviews
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgbeae10d">
<h3 id="orgbeae10d">Set Up</h3>
<div class="outline-text-3" id="text-orgbeae10d"></div>
<div class="outline-4" id="outline-container-org5c6ade9">
<h4 id="org5c6ade9">Some Constants</h4>
<div class="outline-text-4" id="text-org5c6ade9">
<p>There are two classes in the data set - <i>spam</i> and <i>not spam</i>, and for the labeling that we're going to do we also need a third value for the cases where the code can't give it a label.</p>
<div class="highlight">
<pre><span></span>classified_as = Namespace(
    not_spam = 0,
    spam = 1,
    unknown = -1,
)
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org64c9634">
<h4 id="org64c9634">The Plotting</h4>
<div class="outline-text-4" id="text-org64c9634">
<div class="highlight">
<pre><span></span>path = "../../files/posts/data/a-first-look-at-snorkel"
Embed = partial(EmbedHoloviews, folder_path=path)
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgfbafcf0">
<h4 id="orgfbafcf0">The Data Set</h4>
<div class="outline-text-4" id="text-orgfbafcf0">
<p>This dataset is a set of comments taken from you-tube videos and hosted on <a href="http://www.dt.fee.unicamp.br/~tiago//youtubespamcollection/">this site</a>. The comments are for music videos by five artists.</p>
<div class="highlight">
<pre><span></span>path = Path("~/data/datasets/texts/you_tube_comments/").expanduser()
assert path.is_dir()

parts = []
for name in path.glob("*csv"):
    data = pandas.read_csv(name)    
    data["artist"] = name.name.split()[-1].split(".")[0]
    parts.append(data)

data = pandas.concat(parts)
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgaf96094">
<h4 id="orgaf96094">Rename the Columns</h4>
<div class="outline-text-4" id="text-orgaf96094">
<p>This just makes it easier for me since it matches my style.</p>
<div class="highlight">
<pre><span></span>Column = Namespace(
    comment_id = "comment_id",
    author = "author",
    datetime = "datetime",
    text = "text",
    label = "label",
    artist = "artist",
)
renames = {"COMMENT_ID": Column.comment_id,
           "AUTHOR": Column.author,
           "DATE": Column.datetime,
           "CONTENT": Column.text,
           "CLASS": Column.label}
data = data.rename(columns=renames)
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org12c172b">
<h2 id="org12c172b">Middle</h2>
<div class="outline-text-2" id="text-org12c172b"></div>
<div class="outline-3" id="outline-container-org88e7e5b">
<h3 id="org88e7e5b">Setting Up the Training and Testing Sets</h3>
<div class="outline-text-3" id="text-org88e7e5b">
<div class="highlight">
<pre><span></span>x_train, x_test, y_train, y_test = train_test_split(data[Column.comment_id,
                                                         Column.author,
                                                         Column.datetime,
                                                         Column.text,
                                                         Column.artist],
                                                    data[Column.label],
                                                    test_size=0.2)
x_train, x_dev, y_train, y_dev = train_test_split(x_train, y_train,
                                                  test_size=0.1)
x_test, x_validation, y_test, y_validation = train_test_split(x_test, y_test,
                                                              test_size=0.1)

print(f"Training Size: {len(x_train):,}")
print(f"Development Size: {len(x_dev):,}")
print(f"Validation Size: {len(x_validation):,}")
print(f"Test Size: {len(x_test):,}")
</pre></div>
<pre class="example">
Training Size: 1,407
Development Size: 157
Validation Size: 40
Test Size: 352

</pre></div>
</div>
<div class="outline-3" id="outline-container-orgad9c906">
<h3 id="orgad9c906">Looking at the Data</h3>
<div class="outline-text-3" id="text-orgad9c906">
<div class="highlight">
<pre><span></span>print(x_dev.sample().iloc[0])
</pre></div>
<pre class="example">
If I get 100 subscribers, I will summon Freddy Mercury's ghost to whipe  from the face of earth One Direction and Miley Cirus.Ôªø

</pre>
<div class="highlight">
<pre><span></span>print(f"{len(data):,}")
</pre></div>
<pre class="example">
1,956

</pre></div>
<div class="outline-4" id="outline-container-org6025f0a">
<h4 id="org6025f0a">Spam and Ham</h4>
<div class="outline-text-4" id="text-org6025f0a">
<p>There are two classes in the dataset - SPAM (1) and not-spam (0), sometimes called HAM.</p>
<div class="highlight">
<pre><span></span>counter = CountPercentage(data.label)
counter()
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Value</th>
<th class="org-left" scope="col">Count</th>
<th class="org-right" scope="col">Percent (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">1,005</td>
<td class="org-right">51.38</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-left">951</td>
<td class="org-right">48.62</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span>grouped = data.groupby([Column.artist]).agg({Column.label: "sum", Column.comment_id: "count"}).reset_index().rename(
    columns={Column.label: "spam", Column.comment_id: "total"})
grouped["ham"] = grouped.total - grouped.spam
plotter = grouped[[Column.artist, "spam", "ham"]]
plot = plotter.hvplot.bar(x=Column.artist, stacked=True, legend=True,).opts(
    title="Spam Counts",
    width=1000, height=800)
Embed(plot=plot, file_name="spam_counts")()
</pre></div>
<object data="/posts/data/a-first-look-at-snorkel/spam_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
<div class="outline-4" id="outline-container-org5b86e70">
<h4 id="org5b86e70">The Dates</h4>
<div class="outline-text-4" id="text-org5b86e70">
<p>I'll look at when the comments were made, just to see.</p>
<div class="highlight">
<pre><span></span>print(len(data[data[Column.datetime].isna()]))
</pre></div>
<pre class="example">
245

</pre>
<div class="highlight">
<pre><span></span>with_date = data[~data[Column.datetime].isna()]
with_date.loc[:, Column.datetime] = pandas.to_datetime(with_date[Column.datetime])
</pre></div>
<div class="highlight">
<pre><span></span>with_date.loc[:, "Month"] = with_date[Column.datetime].apply(lambda date: datetime(date.year, date.month, 1))
group = with_date.groupby(["Month", Column.artist, Column.label]).agg(
    {Column.comment_id: "count"}).reset_index().rename(
        columns={Column.comment_id: "Count",
                 Column.artist: "Artist"})
</pre></div>
<div class="highlight">
<pre><span></span>spam = group[group[Column.label] == classified_as.spam]
ham = group[group[Column.label] == classified_as.not_spam]
spam_plot = spam.hvplot(x="Month", y="Count", by="Artist", label="Spam")
plot = spam_plot.opts(title="Monthly Spam By Artist", width=1000, height=800)
Embed(plot=plot, file_name="monthly_spam_by_artist")()
</pre></div>
<object data="/posts/data/a-first-look-at-snorkel/monthly_spam_by_artist.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
<div class="outline-4" id="outline-container-org04c222b">
<h4 id="org04c222b">Some Samples</h4>
<div class="outline-text-4" id="text-org04c222b"></div>
<ul class="org-ul">
<li><a id="orgd494599"></a>SPAM<br>
<div class="outline-text-5" id="text-orgd494599">
<div class="highlight">
<pre><span></span>spam = data[data[Column.label]==classified_as.spam].sample(5)
for index in range(len(spam)):
    print(f"({spam.iloc[index][Column.artist]}): {spam.iloc[index][Column.text]}")
</pre></div>
<pre class="example">
(Eminem): Do you need more instagram followers or photo likes? Check out IGBlast.com and get em in minutes!
(Eminem): Check out my channel im 15 year old rapper!
(Shakira): Part 5. Comforter of the afflicted, pray for us Help of Christians, pray for us Queen of Angels, pray for us Queen of Patriarchs, pray for us Queen of Prophets, pray for us Queen of Apostles, pray for us Queen of Martyrs, pray for us Queen of Confessors, pray for us Queen of Virgins, pray for us Queen of all Saints, pray for us Queen conceived without original sin, pray for us Queen of the most holy Rosary, pray for us Queen of the family, pray for us Queen of peace, pray for us 
(Eminem): Hey guys I&amp;#39;m 87 cypher im 11 years old and Rap is my life I recently made my second album desire ep . please take a moment to check out my album on YouTube thank you very much for reading every like comment and subscription counts
(Eminem): Check out this video on YouTube:Ôªø

</pre></div>
</li>
<li><a id="org9f1160e"></a>Ham<br>
<div class="outline-text-5" id="text-org9f1160e">
<div class="highlight">
<pre><span></span>ham = data[data[Column.label]==classified_as.not_spam].sample(5)
for index in range(len(ham)):
    print(f"({ham.iloc[index][Column.artist]}): {ham.iloc[index][Column.text]}")
</pre></div>
<pre class="example">
(Eminem): charlieee :DDDD (Those who saw Lost only will understand)Ôªø
(LMFAO): BEST PARTY SONG LITERALLY PARTY ROCK IS IN THE HOUSEE TONIGHT!!!!Ôªø
(LMFAO): I like how the robot shuffles he shuffles goodÔªø
(KatyPerry): ROAAAAARRRRRR üêØüêØüêØÔªø
(Shakira): like meÔªø

</pre></div>
</li>
</ul>
</div>
</div>
<div class="outline-3" id="outline-container-orgb646f5e">
<h3 id="orgb646f5e">Labeling Functions</h3>
</div>
</div>
<div class="outline-2" id="outline-container-orgd3004ee">
<h2 id="orgd3004ee">End</h2>
<div class="outline-text-2" id="text-orgd3004ee"></div>
<div class="outline-3" id="outline-container-org5d50667">
<h3 id="org5d50667">Citations</h3>
<div class="outline-text-3" id="text-org5d50667">
<ul class="org-ul">
<li>Alberto, T.C., Lochter J.V., Almeida, T.A. TubeSpam: Comment Spam Filtering on YouTube. Proceedings of the 14th IEEE International Conference on Machine Learning and Applications (ICMLA'15), 1-6, Miami, FL, USA, December, 2015. (preprint)</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/sql/sql-module-3/">SQL Module 3</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/sql/sql-module-3/" rel="bookmark"><time class="published dt-published" datetime="2019-08-30T04:17:17-07:00" itemprop="datePublished" title="2019-08-30 04:17">2019-08-30 04:17</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/sql/sql-module-3/#org6504b4e">Question One</a></li>
<li><a href="/posts/sql/sql-module-3/#org44b7e42">Question Two</a></li>
<li><a href="/posts/sql/sql-module-3/#orgd57ae30">Question Three</a></li>
<li><a href="/posts/sql/sql-module-3/#org884cf32">Question Four</a></li>
<li><a href="/posts/sql/sql-module-3/#org4616b09">Question Five</a></li>
<li><a href="/posts/sql/sql-module-3/#org6e7ea02">Question Six</a></li>
<li><a href="/posts/sql/sql-module-3/#org12dcfd2">Question Seven</a></li>
</ul>
</div>
</div>
<p>All the questions in this Quiz use the Chinook Database.</p>
<div class="outline-2" id="outline-container-org6504b4e">
<h2 id="org6504b4e">Question One</h2>
<div class="outline-text-2" id="text-org6504b4e">
<p>Using a subquery, find the names of all the tracks for the album "Californication".</p>
<div class="highlight">
<pre><span></span><span class="k">SELECT</span>
<span class="n">name</span>
<span class="k">from</span> <span class="n">tracks</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">albums</span> <span class="k">ON</span> <span class="n">tracks</span><span class="p">.</span><span class="n">albumid</span><span class="o">=</span><span class="n">albums</span><span class="p">.</span><span class="n">albumid</span>
<span class="k">WHERE</span> <span class="n">albums</span><span class="p">.</span><span class="n">title</span><span class="o">=</span><span class="ss">"Californication"</span>
</pre></div>
<p>What is the 8th Track? Porcelain.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org44b7e42">
<h2 id="org44b7e42">Question Two</h2>
<div class="outline-text-2" id="text-org44b7e42">
<p>Find the total number of invoices for each customer along with the customer's full name, city and email.</p>
<div class="highlight">
<pre><span></span><span class="k">SELECT</span>
<span class="k">COUNT</span><span class="p">(</span><span class="n">invoiceid</span><span class="p">),</span> <span class="n">firstname</span><span class="p">,</span> <span class="n">lastname</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">email</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">customers</span> <span class="k">ON</span> <span class="n">invoices</span><span class="p">.</span><span class="n">customerid</span><span class="o">=</span><span class="n">customers</span><span class="p">.</span><span class="n">customerid</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">invoices</span><span class="p">.</span><span class="n">customerid</span>
</pre></div>
<p>What is the email address of the 5th person, Frantisek Wichterlova?</p>
<p>frantsekw@jetbrains.com</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgd57ae30">
<h2 id="orgd57ae30">Question Three</h2>
<div class="outline-text-2" id="text-orgd57ae30">
<p>Retrieve the track name, album, artistID, and trackID for all the albums.</p>
<div class="highlight">
<pre><span></span><span class="k">SELECT</span>
<span class="n">name</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">artistid</span><span class="p">,</span> <span class="n">trackid</span>
<span class="k">FROM</span> <span class="n">tracks</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">albums</span> <span class="k">ON</span> <span class="n">tracks</span><span class="p">.</span><span class="n">albumid</span><span class="o">=</span><span class="n">albums</span><span class="p">.</span><span class="n">albumid</span>
<span class="k">WHERE</span> <span class="n">title</span><span class="o">=</span><span class="ss">"For Those About To Rock We Salute You"</span> <span class="k">AND</span> <span class="n">trackid</span><span class="o">=</span><span class="mi">12</span>
</pre></div>
<p>What is the song title of trackID 12 from the "For Those About to Rock We Salute You" album? Enter the answer below</p>
<p>Breaking The Rules</p>
</div>
</div>
<div class="outline-2" id="outline-container-org884cf32">
<h2 id="org884cf32">Question Four</h2>
<div class="outline-text-2" id="text-org884cf32">
<p>Retrieve a list with the managers last name, and the last name of the employees who report to him or her.</p>
<div class="highlight">
<pre><span></span><span class="k">SELECT</span>
<span class="n">A</span><span class="p">.</span><span class="n">LastName</span><span class="p">,</span> <span class="n">B</span><span class="p">.</span><span class="n">LastName</span>
<span class="k">from</span> <span class="n">employees</span> <span class="k">as</span> <span class="n">A</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">employees</span> <span class="k">as</span> <span class="n">B</span> <span class="k">ON</span> <span class="n">A</span><span class="p">.</span><span class="n">ReportsTo</span><span class="o">=</span><span class="n">B</span><span class="p">.</span><span class="n">EmployeeId</span>
</pre></div>
<p>After running the query described above, who are the reports for the manager named Mitchell (select all that apply)?</p>
<p>King and Callahan.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org4616b09">
<h2 id="org4616b09">Question Five</h2>
<div class="outline-text-2" id="text-org4616b09">
<p>Find the name and ID of the artists who do not have albums.</p>
<div class="highlight">
<pre><span></span><span class="k">SELECT</span>
<span class="n">name</span><span class="p">,</span> <span class="n">ArtistId</span>
<span class="k">from</span> <span class="n">artists</span>
<span class="k">WHERE</span> <span class="n">ArtistId</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
  <span class="k">SELECT</span>
  <span class="n">ArtistId</span>
  <span class="k">FROM</span> <span class="n">albums</span>
  <span class="p">)</span>
</pre></div>
<p>After running the query described above, two of the records returned have the same last name. Enter that name below.</p>
<p>Gilberto</p>
</div>
</div>
<div class="outline-2" id="outline-container-org6e7ea02">
<h2 id="org6e7ea02">Question Six</h2>
<div class="outline-text-2" id="text-org6e7ea02">
<p>Use a UNION to create a list of all the employee's and customer's first names and last names ordered by the last name in descending order.</p>
<div class="highlight">
<pre><span></span><span class="k">SELECT</span>
<span class="n">FirstName</span><span class="p">,</span> <span class="n">LastName</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">UNION</span>
<span class="k">SELECT</span>
<span class="n">FirstName</span><span class="p">,</span> <span class="n">LastName</span>
<span class="k">FROM</span> <span class="n">employees</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">LastName</span> <span class="k">DESC</span>
</pre></div>
<p>After running the query described above, determine what is the last name of the 6th record? Enter it below. Remember to order things in descending order to be sure to get the correct answer.</p>
<p>Taylor</p>
</div>
</div>
<div class="outline-2" id="outline-container-org12dcfd2">
<h2 id="org12dcfd2">Question Seven</h2>
<div class="outline-text-2" id="text-org12dcfd2">
<p>See if there are any customers who have a different city listed in their billing city versus their customer city.</p>
<div class="highlight">
<pre><span></span><span class="k">SELECT</span>
<span class="n">customers</span><span class="p">.</span><span class="n">CustomerID</span><span class="p">,</span> <span class="n">City</span><span class="p">,</span> <span class="n">BillingCity</span> <span class="k">from</span> <span class="n">customers</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">invoices</span> <span class="k">ON</span> <span class="n">customers</span><span class="p">.</span><span class="n">CustomerID</span><span class="o">=</span><span class="n">invoices</span><span class="p">.</span><span class="n">CustomerId</span>
<span class="k">WHERE</span> <span class="n">City</span> <span class="o">!=</span> <span class="n">BillingCity</span>
</pre></div>
<p>No, there aren't.</p>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/sql/chinook-questions/">Chinook Questions</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/sql/chinook-questions/" rel="bookmark"><time class="published dt-published" datetime="2019-08-21T08:39:49-07:00" itemprop="datePublished" title="2019-08-21 08:39">2019-08-21 08:39</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/sql/chinook-questions/#org74f709c">Beginning</a></li>
<li><a href="/posts/sql/chinook-questions/#orga1e1b3a">Middle</a>
<ul>
<li><a href="/posts/sql/chinook-questions/#org0c3f7b9">Question One</a></li>
<li><a href="/posts/sql/chinook-questions/#orga8092d9">Question Two</a></li>
<li><a href="/posts/sql/chinook-questions/#org3e7cca2">Question Three</a></li>
<li><a href="/posts/sql/chinook-questions/#org713c32c">Question Four</a></li>
<li><a href="/posts/sql/chinook-questions/#org8a0964b">Question Five</a></li>
<li><a href="/posts/sql/chinook-questions/#org6255f3a">Question Six</a></li>
<li><a href="/posts/sql/chinook-questions/#orgc5d411f">Question Seven</a></li>
</ul>
</li>
<li><a href="/posts/sql/chinook-questions/#orgfd1ac03">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org74f709c">
<h2 id="org74f709c">Beginning</h2>
<div class="outline-text-2" id="text-org74f709c">
<p>The following questions use the <a href="http://www.sqlitetutorial.net/sqlite-sample-database/">SQLite Sample Database</a> - called the Chinook database - found on <a href="http://www.sqlitetutorial.net">the SQLite Tutorial site</a>. <img alt="chinook-entity-diagram.png" src="/posts/sql/chinook-questions/chinook-entity-diagram.png"></p>
<p>It is made up of 11 tables:</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Table</th>
<th class="org-left" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">employees</td>
<td class="org-left">stores employees data such as employee id, last name, first name, etc. It also has a field named ReportsTo to specify who reports to whom.</td>
</tr>
<tr>
<td class="org-left">customers</td>
<td class="org-left">stores customers data.</td>
</tr>
<tr>
<td class="org-left">invoices</td>
<td class="org-left">stores invoice header data</td>
</tr>
<tr>
<td class="org-left">& invoice_items</td>
<td class="org-left">stores the invoice line items data.</td>
</tr>
<tr>
<td class="org-left">artists</td>
<td class="org-left">stores artists data. It is a simple table that contains only artist id and name.</td>
</tr>
<tr>
<td class="org-left">albums</td>
<td class="org-left">stores data about a list of tracks. Each album belongs to one artist. However, one artist may have multiple albums.</td>
</tr>
<tr>
<td class="org-left">media_types</td>
<td class="org-left">stores media types such as MPEG audio and AAC audio file.</td>
</tr>
<tr>
<td class="org-left">genres</td>
<td class="org-left">stores music types such as rock, jazz, metal, etc.</td>
</tr>
<tr>
<td class="org-left">tracks</td>
<td class="org-left">store the data of songs. Each track belongs to one album.</td>
</tr>
<tr>
<td class="org-left">playlists</td>
<td class="org-left">stores data about playlists. Each playlist contains a list of tracks. Each track may belong to multiple playlists.</td>
</tr>
<tr>
<td class="org-left">playlist_track</td>
<td class="org-left">The relationship between the playlists table and tracks table is many-to-many. The playlist_track table is used to reflect this relationship.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="outline-2" id="outline-container-orga1e1b3a">
<h2 id="orga1e1b3a">Middle</h2>
<div class="outline-text-2" id="text-orga1e1b3a"></div>
<div class="outline-3" id="outline-container-org0c3f7b9">
<h3 id="org0c3f7b9">Question One</h3>
<div class="outline-text-3" id="text-org0c3f7b9">
<p>Pull a list of customer ids with the customer‚Äôs full name, and address, along with combining their city and country together. Be sure to make a space in between these two and make it UPPER CASE.</p>
<p>What is the city and country result for CustomerID 16?</p>
</div>
</div>
<div class="outline-3" id="outline-container-orga8092d9">
<h3 id="orga8092d9">Question Two</h3>
<div class="outline-text-3" id="text-orga8092d9">
<p>Create a new employee user id by combining the first 4 letters of the employee‚Äôs first name with the first 2 letters of the employee‚Äôs last name. Make the new field lower case and pull each individual step to show your work.</p>
<p>What is the final result for Robert King?</p>
</div>
</div>
<div class="outline-3" id="outline-container-org3e7cca2">
<h3 id="org3e7cca2">Question Three</h3>
<div class="outline-text-3" id="text-org3e7cca2">
<p>Show a list of employees who have worked for the company for 15 or more years using the current date function. Sort by lastname ascending.</p>
<p>What is the lastname of the last person on the list returned?</p>
</div>
</div>
<div class="outline-3" id="outline-container-org713c32c">
<h3 id="org713c32c">Question Four</h3>
<div class="outline-text-3" id="text-org713c32c">
<p>Profiling the Customers table, answer the following question.</p>
<p>Are there any columns with null values? Indicate any below. Select all that apply.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org8a0964b">
<h3 id="org8a0964b">Question Five</h3>
<div class="outline-text-3" id="text-org8a0964b">
<p>Find the cities with the most customers and rank in descending order.</p>
<p>Which of the following cities indicate having 2 customers?</p>
</div>
</div>
<div class="outline-3" id="outline-container-org6255f3a">
<h3 id="org6255f3a">Question Six</h3>
<div class="outline-text-3" id="text-org6255f3a">
<p>Create a new customer invoice id by combining a customer‚Äôs invoice id with their first and last name while ordering your query in the following order: firstname, lastname, and invoiceID.</p>
<p>Select all of the correct "AstridGruber" entries that are returned in your results below. Select all that apply.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgc5d411f">
<h3 id="orgc5d411f">Question Seven</h3>
</div>
</div>
<div class="outline-2" id="outline-container-orgfd1ac03">
<h2 id="orgfd1ac03">End</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/web-scraping/calling-a-json-api/">Calling a JSON API</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/web-scraping/calling-a-json-api/" rel="bookmark"><time class="published dt-published" datetime="2019-08-04T11:53:29-07:00" itemprop="datePublished" title="2019-08-04 11:53">2019-08-04 11:53</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/web-scraping/calling-a-json-api/#org82399df">Beginning</a>
<ul>
<li><a href="/posts/web-scraping/calling-a-json-api/#orgc979628">Imports</a>
<ul>
<li><a href="/posts/web-scraping/calling-a-json-api/#org0ce9794">Python</a></li>
<li><a href="/posts/web-scraping/calling-a-json-api/#org0cc3d69">PyPi</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/calling-a-json-api/#org28455d8">Set Up</a>
<ul>
<li><a href="/posts/web-scraping/calling-a-json-api/#org0a30d04">URL</a></li>
<li><a href="/posts/web-scraping/calling-a-json-api/#org2bbff95">Sample</a></li>
<li><a href="/posts/web-scraping/calling-a-json-api/#org3dd109f">Actual</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/web-scraping/calling-a-json-api/#org33c7380">Middle</a>
<ul>
<li><a href="/posts/web-scraping/calling-a-json-api/#orgc93ede2">The Sample</a></li>
<li><a href="/posts/web-scraping/calling-a-json-api/#org18d24d9">The Actual</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/calling-a-json-api/#orgb941af8">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org82399df">
<h2 id="org82399df">Beginning</h2>
<div class="outline-text-2" id="text-org82399df"></div>
<div class="outline-3" id="outline-container-orgc979628">
<h3 id="orgc979628">Imports</h3>
<div class="outline-text-3" id="text-orgc979628"></div>
<div class="outline-4" id="outline-container-org0ce9794">
<h4 id="org0ce9794">Python</h4>
<div class="outline-text-4" id="text-org0ce9794">
<div class="highlight">
<pre><span></span>from pprint import pprint
import json
import urllib
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org0cc3d69">
<h4 id="org0cc3d69">PyPi</h4>
<div class="outline-text-4" id="text-org0cc3d69">
<div class="highlight">
<pre><span></span>from expects import (
    equal,
    expect,
    start_with,
)
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org28455d8">
<h3 id="org28455d8">Set Up</h3>
<div class="outline-text-3" id="text-org28455d8"></div>
<div class="outline-4" id="outline-container-org0a30d04">
<h4 id="org0a30d04">URL</h4>
<div class="outline-text-4" id="text-org0a30d04">
<div class="highlight">
<pre><span></span>API_KEY = 42
API_URL = "http://py4e-data.dr-chuck.net/json?"
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org2bbff95">
<h4 id="org2bbff95">Sample</h4>
<div class="outline-text-4" id="text-org2bbff95">
<div class="highlight">
<pre><span></span>SAMPLE_LOCATION = "South Federal University"
SAMPLE_PLACE_ID = "ChIJ9e_QQm0sDogRhUPatldEFxw"
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org3dd109f">
<h4 id="org3dd109f">Actual</h4>
<div class="outline-text-4" id="text-org3dd109f">
<div class="highlight">
<pre><span></span>ACTUAL_LOCATION = "Kazan Federal University"
ACTUAL_PLACE_ID_STARTS_WITH = "ChIJGf9"
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org33c7380">
<h2 id="org33c7380">Middle</h2>
<div class="outline-text-2" id="text-org33c7380">
<div class="highlight">
<pre><span></span>def get_place_id(location: str) -&gt; str:
    """Get the place ID for the location

    Args:
     location: place to look up

    Returns:
     the place ID for the location
    """
    parameters = {"address": location, "key": API_KEY}
    request = API_URL + urllib.parse.urlencode(parameters)

    with urllib.request.urlopen(request) as response:
        data = json.loads(response.read().decode())
        results = data["results"][0]
        expect(data["status"]).to(equal("OK"))
        place_id = results["place_id"]
        print(f"Location: {location}")
        print(f"Place ID: {place_id}")
    return place_id
</pre></div>
</div>
<div class="outline-3" id="outline-container-orgc93ede2">
<h3 id="orgc93ede2">The Sample</h3>
<div class="outline-text-3" id="text-orgc93ede2">
<div class="highlight">
<pre><span></span>place_id = get_place_id(SAMPLE_LOCATION)
expect(SAMPLE_PLACE_ID).to(equal(place_id))
</pre></div>
<pre class="example">
Location: South Federal University
Place ID: ChIJ9e_QQm0sDogRhUPatldEFxw

</pre></div>
</div>
<div class="outline-3" id="outline-container-org18d24d9">
<h3 id="org18d24d9">The Actual</h3>
<div class="outline-text-3" id="text-org18d24d9">
<div class="highlight">
<pre><span></span>place_id = get_place_id(ACTUAL_LOCATION)
expect(place_id).to(start_with(ACTUAL_PLACE_ID_STARTS_WITH))
</pre></div>
<pre class="example">
Location: Kazan Federal University
Place ID: ChIJGf9kMxGtXkERIzwzBzFo8kY

</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb941af8">
<h2 id="orgb941af8">End</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/web-scraping/extracting-data-from-json/">Extracting Data From JSON</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/web-scraping/extracting-data-from-json/" rel="bookmark"><time class="published dt-published" datetime="2019-08-04T11:22:51-07:00" itemprop="datePublished" title="2019-08-04 11:22">2019-08-04 11:22</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-json/#orgc589c7c">Beginning</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org0d718da">Imports</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org21c2aca">Python</a></li>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org5b09150">PyPi</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org78ae5fb">Set Up</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org7b6a504">The URLs</a></li>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org3b63353">The Expected</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org5e33258">Middle</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org3bafdb5">The Sample</a></li>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org986f540">The Assignment</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/extracting-data-from-json/#org4d0c963">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgc589c7c">
<h2 id="orgc589c7c">Beginning</h2>
<div class="outline-text-2" id="text-orgc589c7c"></div>
<div class="outline-3" id="outline-container-org0d718da">
<h3 id="org0d718da">Imports</h3>
<div class="outline-text-3" id="text-org0d718da"></div>
<div class="outline-4" id="outline-container-org21c2aca">
<h4 id="org21c2aca">Python</h4>
<div class="outline-text-4" id="text-org21c2aca">
<div class="highlight">
<pre><span></span>import json
import urllib
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org5b09150">
<h4 id="org5b09150">PyPi</h4>
<div class="outline-text-4" id="text-org5b09150">
<div class="highlight">
<pre><span></span>from expects import expect, equal
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org78ae5fb">
<h3 id="org78ae5fb">Set Up</h3>
<div class="outline-text-3" id="text-org78ae5fb"></div>
<div class="outline-4" id="outline-container-org7b6a504">
<h4 id="org7b6a504">The URLs</h4>
<div class="outline-text-4" id="text-org7b6a504">
<div class="highlight">
<pre><span></span>SAMPLE_URL = "http://py4e-data.dr-chuck.net/comments_42.json"
ACTUAL_URL = "http://py4e-data.dr-chuck.net/comments_260445.json"
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org3b63353">
<h4 id="org3b63353">The Expected</h4>
<div class="outline-text-4" id="text-org3b63353">
<div class="highlight">
<pre><span></span>SAMPLE_EXPECTED = 2553
ACTUAL_EXPECTED_LAST_TWO_DIGITS = 94
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org5e33258">
<h2 id="org5e33258">Middle</h2>
<div class="outline-text-2" id="text-org5e33258">
<p>We're going to pull a JSON blob and extract the "count" values and sum them. The data is structured with a single top-level key ("comments") which holds a list of dicts with "name" (name of the commenter) and "count" (the number of comments the commenter has made) values.</p>
<div class="highlight">
<pre><span></span>def count(url: str) -&gt; int:
    """Totals the comment counts

    Args:
     url: source of the JSON

    Returns:
     the total of the comment counts
    """
    response = urllib.request.urlopen(url)
    data = json.loads(response.read())
    total = 0
    for index, commenter in enumerate(data["comments"]):
        total += int(commenter["count"])

    print(f"Comments: {index + 1}")
    print(f"Comments: {total: ,}")
    return total
</pre></div>
</div>
<div class="outline-3" id="outline-container-org3bafdb5">
<h3 id="org3bafdb5">The Sample</h3>
<div class="outline-text-3" id="text-org3bafdb5">
<div class="highlight">
<pre><span></span>total = count(SAMPLE_URL)
expect(total).to(equal(SAMPLE_EXPECTED))
</pre></div>
<pre class="example">
Comments: 50
Comments:  2,553

</pre></div>
</div>
<div class="outline-3" id="outline-container-org986f540">
<h3 id="org986f540">The Assignment</h3>
<div class="outline-text-3" id="text-org986f540">
<div class="highlight">
<pre><span></span>total = count(ACTUAL_URL)
expect(int(str(total)[-2:])).to(equal(ACTUAL_EXPECTED_LAST_TWO_DIGITS))
</pre></div>
<pre class="example">
Comments: 50
Comments:  2,594

</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org4d0c963">
<h2 id="org4d0c963">End</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/web-scraping/extracting-data-from-xml/">Extracting Data From XML</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/web-scraping/extracting-data-from-xml/" rel="bookmark"><time class="published dt-published" datetime="2019-08-03T16:24:05-07:00" itemprop="datePublished" title="2019-08-03 16:24">2019-08-03 16:24</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#orgede83d5">Beginning</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org3167ad0">Imports</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org6fffe74">Python</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org6724468">Set Up</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org9456c3d">The URLS</a></li>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org3a4cd1a">The Expected</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org40ca5db">Middle</a>
<ul>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org6c86865">Sample</a></li>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#org860d303">The Assignment</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/extracting-data-from-xml/#orge4cec79">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgede83d5">
<h2 id="orgede83d5">Beginning</h2>
<div class="outline-text-2" id="text-orgede83d5"></div>
<div class="outline-3" id="outline-container-org3167ad0">
<h3 id="org3167ad0">Imports</h3>
<div class="outline-text-3" id="text-org3167ad0"></div>
<div class="outline-4" id="outline-container-org6fffe74">
<h4 id="org6fffe74">Python</h4>
<div class="outline-text-4" id="text-org6fffe74">
<div class="highlight">
<pre><span></span>from xml.etree import ElementTree
import urllib
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org6724468">
<h3 id="org6724468">Set Up</h3>
<div class="outline-text-3" id="text-org6724468"></div>
<div class="outline-4" id="outline-container-org9456c3d">
<h4 id="org9456c3d">The URLS</h4>
<div class="outline-text-4" id="text-org9456c3d">
<div class="highlight">
<pre><span></span>SAMPLE_URL = "http://py4e-data.dr-chuck.net/comments_42.xml"
ACTUAL_URL = "http://py4e-data.dr-chuck.net/comments_260444.xml"
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org3a4cd1a">
<h4 id="org3a4cd1a">The Expected</h4>
<div class="outline-text-4" id="text-org3a4cd1a">
<div class="highlight">
<pre><span></span>SAMPLE_EXPECTED = 2553
ACTUAL_EXPECTED_LAST_TWO_DIGITS = 34
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org40ca5db">
<h2 id="org40ca5db">Middle</h2>
<div class="outline-text-2" id="text-org40ca5db">
<div class="highlight">
<pre><span></span>def get_counts(url: str) -&gt; int:
    """Get the sum of the 'count' tags 

    Args:
     url: URL to get the XML from

    Returns:
     sum of the count tags payloads
    """
    response = urllib.request.urlopen(url)
    tree = ElementTree.fromstring(response.read())
    total = 0
    for index, count in enumerate(tree.findall(".//count")):
        total += int(count.text)

    print(f"Tags: {index + 1}")
    print(f"Sum of Counts: {total}")
    return total
</pre></div>
</div>
<div class="outline-3" id="outline-container-org6c86865">
<h3 id="org6c86865">Sample</h3>
<div class="outline-text-3" id="text-org6c86865">
<div class="highlight">
<pre><span></span>total = get_counts(SAMPLE_URL)
assert total == SAMPLE_EXPECTED
</pre></div>
<pre class="example">
Tags: 50
Sum of Counts: 2553

</pre></div>
</div>
<div class="outline-3" id="outline-container-org860d303">
<h3 id="org860d303">The Assignment</h3>
<div class="outline-text-3" id="text-org860d303">
<div class="highlight">
<pre><span></span>total =get_counts(ACTUAL_URL)
assert int(str(total)[-2:]) == ACTUAL_EXPECTED_LAST_TWO_DIGITS
</pre></div>
<pre class="example">
Tags: 50
Sum of Counts: 2634

</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orge4cec79">
<h2 id="orge4cec79">End</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/web-scraping/web-scraping-assignment-1/">Web Scraping Assignment 1</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/web-scraping/web-scraping-assignment-1/" rel="bookmark"><time class="published dt-published" datetime="2019-08-03T12:07:56-07:00" itemprop="datePublished" title="2019-08-03 12:07">2019-08-03 12:07</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org419e5a1">Beginning</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org7e89448">Imports</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org3fcba4f">Python</a></li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org72127b1">PyPi</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org79aac5f">Setup</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org7ef2f98">The URLs</a></li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org3915553">The Expected</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org4dc1759">Middle</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#orgbb094ec">The Sample</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org2f0bc07">The Way I Would Do It</a></li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org01b373f">The Assignment Way</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org411f09a">The Assignment</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org24ce9e9">Requests HTML</a></li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org48797a9">Urllib</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-1/#org1489652">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org419e5a1">
<h2 id="org419e5a1">Beginning</h2>
<div class="outline-text-2" id="text-org419e5a1">
<p>The goal of this exercise is to find all the <code>&lt;span&gt;</code> tags on a page and sum the numbers they contain.</p>
</div>
<div class="outline-3" id="outline-container-org7e89448">
<h3 id="org7e89448">Imports</h3>
<div class="outline-text-3" id="text-org7e89448"></div>
<div class="outline-4" id="outline-container-org3fcba4f">
<h4 id="org3fcba4f">Python</h4>
<div class="outline-text-4" id="text-org3fcba4f">
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">urllib</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org72127b1">
<h4 id="org72127b1">PyPi</h4>
<div class="outline-text-4" id="text-org72127b1">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">equal</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">,</span>
    <span class="n">be_true</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">requests_html</span> <span class="kn">import</span> <span class="n">HTMLSession</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org79aac5f">
<h3 id="org79aac5f">Setup</h3>
<div class="outline-text-3" id="text-org79aac5f"></div>
<div class="outline-4" id="outline-container-org7ef2f98">
<h4 id="org7ef2f98">The URLs</h4>
<div class="outline-text-4" id="text-org7ef2f98">
<div class="highlight">
<pre><span></span><span class="n">SAMPLE_URL</span> <span class="o">=</span> <span class="s2">" http://py4e-data.dr-chuck.net/comments_42.html"</span>
<span class="n">ACTUAL_URL</span> <span class="o">=</span> <span class="s2">"http://py4e-data.dr-chuck.net/comments_260442.html"</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org3915553">
<h4 id="org3915553">The Expected</h4>
<div class="outline-text-4" id="text-org3915553">
<div class="highlight">
<pre><span></span><span class="n">SAMPLE_EXPECTED</span> <span class="o">=</span> <span class="mi">2553</span>
<span class="n">ACTUAL_EXPECTED_LAST_DIGIT</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org4dc1759">
<h2 id="org4dc1759">Middle</h2>
<div class="outline-text-2" id="text-org4dc1759"></div>
<div class="outline-3" id="outline-container-orgbb094ec">
<h3 id="orgbb094ec">The Sample</h3>
<div class="outline-text-3" id="text-orgbb094ec"></div>
<div class="outline-4" id="outline-container-org2f0bc07">
<h4 id="org2f0bc07">The Way I Would Do It</h4>
<div class="outline-text-4" id="text-org2f0bc07">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">using_requests</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""get the span total</span>

<span class="sd">    Args:</span>
<span class="sd">     url: The URL for the page</span>

<span class="sd">    Returns:</span>
<span class="sd">     the total sum</span>
<span class="sd">    """</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">HTMLSession</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_true</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">span</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"span"</span><span class="p">)):</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Count: {count + 1}"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Sum: {total}"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">using_requests</span><span class="p">(</span><span class="n">SAMPLE_URL</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">total</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">SAMPLE_EXPECTED</span><span class="p">))</span>
</pre></div>
<pre class="example">
Count: 50
Sum: 2553

</pre></div>
</div>
<div class="outline-4" id="outline-container-org01b373f">
<h4 id="org01b373f">The Assignment Way</h4>
<div class="outline-text-4" id="text-org01b373f">
<p>For this kind of thing, using urllib isn't really much more work, I'm used to the older python 2 version which (maybe only seemed at the time) was more complicated to use.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">using_urllib</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""get the span total with urllib and beautiful soup</span>

<span class="sd">    Args:</span>
<span class="sd">     url: the URL for the page</span>

<span class="sd">    Returns:</span>
<span class="sd">     the total of the span contents</span>
<span class="sd">    """</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s2">"html.parser"</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">span</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"span"</span><span class="p">)):</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Count: {count + 1}"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Sum: {total}"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">using_urllib</span><span class="p">(</span><span class="n">SAMPLE_URL</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">total</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">SAMPLE_EXPECTED</span><span class="p">))</span>
</pre></div>
<pre class="example">
Count: 50
Sum: 2553

</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org411f09a">
<h3 id="org411f09a">The Assignment</h3>
<div class="outline-text-3" id="text-org411f09a"></div>
<div class="outline-4" id="outline-container-org24ce9e9">
<h4 id="org24ce9e9">Requests HTML</h4>
<div class="outline-text-4" id="text-org24ce9e9">
<div class="highlight">
<pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">using_requests</span><span class="p">(</span><span class="n">ACTUAL_URL</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">total</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">ACTUAL_EXPECTED_LAST_DIGIT</span><span class="p">))</span>
</pre></div>
<pre class="example">
Count: 50
Sum: 2305

</pre></div>
</div>
<div class="outline-4" id="outline-container-org48797a9">
<h4 id="org48797a9">Urllib</h4>
<div class="outline-text-4" id="text-org48797a9">
<div class="highlight">
<pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">using_urllib</span><span class="p">(</span><span class="n">ACTUAL_URL</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">total</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">ACTUAL_EXPECTED_LAST_DIGIT</span><span class="p">))</span>
</pre></div>
<pre class="example">
Count: 50
Sum: 2305

</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org1489652">
<h2 id="org1489652">End</h2>
<div class="outline-text-2" id="text-org1489652">
<p>Although I normally use <code>requests</code> or <code>requests-html</code>, I must say that the <code>urllib</code> version with <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">BeautifulSoup</a> for this particular exercise wasn't much different.</p>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/web-scraping/web-scraping-assignment-2/">Web Scraping Assignment 2</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/web-scraping/web-scraping-assignment-2/" rel="bookmark"><time class="published dt-published" datetime="2019-08-02T13:43:01-07:00" itemprop="datePublished" title="2019-08-02 13:43">2019-08-02 13:43</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#org3b6c88f">Beginning</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#org7d02c94">Imports</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#org24bb971">Python</a></li>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#orgb2622bb">PyPi</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#orge701625">Setup</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#org9d25631">The URL</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#orga2041b8">Middle</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#org1b3bf5b">The Sample Exercise</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#org5793dc9">The Easy Way</a></li>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#org20a1352">The Slightly Less Easy Way</a></li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#orgd8341f2">The Real One</a>
<ul>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#orgf8dc8c8">The Easy Way</a></li>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#orgcc4147c">The Assignment Way</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/posts/web-scraping/web-scraping-assignment-2/#orgd275add">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org3b6c88f">
<h2 id="org3b6c88f">Beginning</h2>
<div class="outline-text-2" id="text-org3b6c88f">
<p>The goal of this exercise is to crawl through a set of anchor links to get a particular name stored in the <i>nth</i> anchor tag. The assignment specifically says to use <a href="https://docs.python.org/3/library/urllib.html">urllib</a> but, if you go to the documentation for <a href="https://docs.python.org/3/library/urllib.request.html#module-urllib.request">urllib.request</a> it tells you to use to use <a href="https://2.python-requests.org/en/master/">requests</a>, which, if you go to its documentation says that it's in maintenance mode while work is being done on <a href="https://3.python-requests.org/">Requests III</a>‚Ä¶ anyway, I like using <a href="https://html.python-requests.org/">Requests-HTML</a> so I'll use that and urllib side-by-side.</p>
</div>
<div class="outline-3" id="outline-container-org7d02c94">
<h3 id="org7d02c94">Imports</h3>
<div class="outline-text-3" id="text-org7d02c94"></div>
<div class="outline-4" id="outline-container-org24bb971">
<h4 id="org24bb971">Python</h4>
<div class="outline-text-4" id="text-org24bb971">
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">urllib</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgb2622bb">
<h4 id="orgb2622bb">PyPi</h4>
<div class="outline-text-4" id="text-orgb2622bb">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">requests_html</span> <span class="kn">import</span> <span class="n">HTMLSession</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orge701625">
<h3 id="orge701625">Setup</h3>
<div class="outline-text-3" id="text-orge701625"></div>
<div class="outline-4" id="outline-container-org9d25631">
<h4 id="org9d25631">The URL</h4>
<div class="outline-text-4" id="text-org9d25631">
<div class="highlight">
<pre><span></span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">"http://py4e-data.dr-chuck.net/known_by_"</span>
<span class="n">SAMPLE_URL</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"{BASE_URL}Fikret.html"</span>
<span class="n">ASSIGNMENT_URL</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"{BASE_URL}Abdalroof.html"</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orga2041b8">
<h2 id="orga2041b8">Middle</h2>
<div class="outline-text-2" id="text-orga2041b8"></div>
<div class="outline-3" id="outline-container-org1b3bf5b">
<h3 id="org1b3bf5b">The Sample Exercise</h3>
<div class="outline-text-3" id="text-org1b3bf5b"></div>
<div class="outline-4" id="outline-container-org5793dc9">
<h4 id="org5793dc9">The Easy Way</h4>
<div class="outline-text-4" id="text-org5793dc9">
<div class="highlight">
<pre><span></span><span class="n">session</span> <span class="o">=</span> <span class="n">HTMLSession</span><span class="p">()</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SAMPLE_URL</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span>

<span class="n">expression</span> <span class="o">=</span> <span class="s2">"_(?P&lt;name&gt;[^_.]+).html"</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {expression.search(SAMPLE_URL).group('name')}"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hop</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)</span>

    <span class="n">link_element</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {link_element.text}"</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">link_element</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">"href"</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Final Answer: {link_element.text}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Name: Fikret
Name: Montgomery
Name: Mhairade
Name: Butchi
Name: Anayah
Final Answer: Anayah

</pre></div>
</div>
<div class="outline-4" id="outline-container-org20a1352">
<h4 id="org20a1352">The Slightly Less Easy Way</h4>
<div class="outline-text-4" id="text-org20a1352">
<div class="highlight">
<pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">SAMPLE_URL</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {expression.search(SAMPLE_URL).group('name')}"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">hop</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
   <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s2">"html.parser"</span><span class="p">)</span>
   <span class="n">link_element</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> 
   <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {link_element.text}"</span><span class="p">)</span>
   <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">link_element</span><span class="p">[</span><span class="s2">"href"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Final Answer: {link_element.text}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Name: Fikret
Name: Montgomery
Name: Mhairade
Name: Butchi
Name: Anayah

Final Answer: Anayah

</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgd8341f2">
<h3 id="orgd8341f2">The Real One</h3>
<div class="outline-text-3" id="text-orgd8341f2"></div>
<div class="outline-4" id="outline-container-orgf8dc8c8">
<h4 id="orgf8dc8c8">The Easy Way</h4>
<div class="outline-text-4" id="text-orgf8dc8c8">
<div class="highlight">
<pre><span></span><span class="n">session</span> <span class="o">=</span> <span class="n">HTMLSession</span><span class="p">()</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ASSIGNMENT_URL</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span>

<span class="n">expression</span> <span class="o">=</span> <span class="s2">"_(?P&lt;name&gt;[^_.]+).html"</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {expression.search(ASSIGNMENT_URL).group('name')}"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hop</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)</span>

    <span class="n">link_element</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {link_element.text}"</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">link_element</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">"href"</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Final Answer: {link_element.text}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Name: Abdalroof
Name: Billi
Name: Jayse
Name: Amaarah
Name: Cesar
Name: Rosheen
Name: Mohamed
Name: Kiara
Final Answer: Kiara

</pre></div>
</div>
<div class="outline-4" id="outline-container-orgcc4147c">
<h4 id="orgcc4147c">The Assignment Way</h4>
<div class="outline-text-4" id="text-orgcc4147c">
<div class="highlight">
<pre><span></span><span class="n">HOPS</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">FIND_AT_INDEX</span> <span class="o">=</span> <span class="mi">18</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">ASSIGNMENT_URL</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {expression.search(ASSIGNMENT_URL).group('name')}"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">hop</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">HOPS</span><span class="p">):</span>
   <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s2">"html.parser"</span><span class="p">)</span>
   <span class="n">link_element</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)[</span><span class="n">FIND_AT_INDEX</span><span class="p">]</span> 
   <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Name: {link_element.text}"</span><span class="p">)</span>
   <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">link_element</span><span class="p">[</span><span class="s2">"href"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Final Answer: {link_element.text}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Name: Abdalroof
Name: Billi
Name: Jayse
Name: Amaarah
Name: Cesar
Name: Rosheen
Name: Mohamed
Name: Kiara

Final Answer: Kiara
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgd275add">
<h2 id="orgd275add">End</h2>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="next"><a href="/index-4.html" rel="next">Older posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Contents ¬© 2020 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="/assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script> 
</body>
</html>
