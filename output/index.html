<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Adumbrations of data." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Visions, Voices, Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Visions-Voices-Data/" rel="canonical">
<link href="index-2.html" rel="next" type="text/html"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
</script>
<link href="posts/networks/some-networkx-examples/" rel="prefetch" type="text/html">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/Visions-Voices-Data/"><span id="blog-title">Visions, Voices, Data</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pages</a>
<div class="dropdown-menu"><a class="dropdown-item active" href=".">Cloistered Monkey <span class="sr-only">(active)</span></a> <a class="dropdown-item" href="pages/giss/giss-yearly-anomalies-by-climate-zone">GISS Anomalies</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Visions-Voices-Data/"><input name="k8" type="hidden" value="#444444"><input name="k9" type="hidden" value="#D51920"><input name="kt" type="hidden" value="h"><input class="span2" maxlength="255" name="q" placeholder="Searchâ€¦" type="text"><input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/some-networkx-examples/">Some Networkx Examples</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/some-networkx-examples/" rel="bookmark"><time class="published dt-published" datetime="2019-04-12T13:12:58-07:00" itemprop="datePublished" title="2019-04-12 13:12">2019-04-12 13:12</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/some-networkx-examples/#org87f7995">The Departure</a>
<ul>
<li><a href="posts/networks/some-networkx-examples/#org14675b2">Imports</a></li>
<li><a href="posts/networks/some-networkx-examples/#orgc5bc91b">Set Up</a></li>
</ul>
</li>
<li><a href="posts/networks/some-networkx-examples/#orgea00c44">The Initiation</a>
<ul>
<li><a href="posts/networks/some-networkx-examples/#org89e016d">Different Ways to Create Network Graphs</a></li>
<li><a href="posts/networks/some-networkx-examples/#org463b0af">A Chess Example</a></li>
</ul>
</li>
<li><a href="posts/networks/some-networkx-examples/#orgc3bb999">The Return</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org87f7995">
<h2 id="org87f7995">The Departure</h2>
<div class="outline-text-2" id="text-org87f7995">
<p>This is a look at different ways of creating and manipulating graphs using <a href="https://networkx.github.io">NetworkX</a>.</p>
</div>
<div class="outline-3" id="outline-container-org14675b2">
<h3 id="org14675b2">Imports</h3>
<div class="outline-text-3" id="text-org14675b2"></div>
<div class="outline-4" id="outline-container-orgbdcbb4a">
<h4 id="orgbdcbb4a">Python</h4>
<div class="outline-text-4" id="text-orgbdcbb4a">
<div class="highlight">
<pre><span></span>from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org56144b4">
<h4 id="org56144b4">PyPi</h4>
<div class="outline-text-4" id="text-org56144b4">
<div class="highlight">
<pre><span></span>from bokeh.models import HoverTool
import holoviews
import hvplot.pandas
import networkx
import numpy
import pandas
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgfb165c9">
<h4 id="orgfb165c9">My Stuff</h4>
<div class="outline-text-4" id="text-orgfb165c9">
<div class="highlight">
<pre><span></span>from graeae.visualization import EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc5bc91b">
<h3 id="orgc5bc91b">Set Up</h3>
<div class="outline-text-3" id="text-orgc5bc91b">
<div class="highlight">
<pre><span></span>SLUG = "some-networkx-examples"
OUTPUT_PATH = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=OUTPUT_PATH)
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgea00c44">
<h2 id="orgea00c44">The Initiation</h2>
<div class="outline-text-2" id="text-orgea00c44"></div>
<div class="outline-3" id="outline-container-org89e016d">
<h3 id="org89e016d">Different Ways to Create Network Graphs</h3>
<div class="outline-text-3" id="text-org89e016d">
<p><b>NetworkX</b> has a few different ways to create graphs, some more flexible than others. This is a non-exhaustive showing of some of them.</p>
</div>
<div class="outline-4" id="outline-container-org80f975a">
<h4 id="org80f975a">Adding Edges To An Existing Graph</h4>
<div class="outline-text-4" id="text-org80f975a">
<p>You can create a graph using the graph constructors. This is an example of an undirected <a href="https://networkx.github.io/documentation/stable/reference/classes/graph.html">Graph</a>.</p>
<div class="highlight">
<pre><span></span>graph_1 = networkx.Graph()
</pre></div>
<div class="highlight">
<pre><span></span>G1.add_edges_from([(0, 1),
                   (0, 2),
                   (0, 3),
                   (0, 5),
                   (1, 3),
                   (1, 6),
                   (3, 4),
                   (4, 5),
                   (4, 7),
                   (5, 8),
                   (8, 9)])

networkx.draw_networkx(G1)
</pre></div>
<div class="figure">
<p><img alt="graph_one.png" src="file:///tmp/graph_one.png"></p>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org105c70a">
<h4 id="org105c70a">Adjacency List</h4>
<div class="outline-text-4" id="text-org105c70a">
<div class="highlight">
<pre><span></span>with open("G_adjlist.txt") as reader:
    print(reader.read())
</pre></div>
<div class="highlight">
<pre><span></span>G2 = networkx.read_adjlist('G_adjlist.txt', nodetype=int)
G2.edges()
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org71b7368">
<h4 id="org71b7368">Adjacency Matrix</h4>
<div class="outline-text-4" id="text-org71b7368">
<div class="highlight">
<pre><span></span>G_mat = numpy.array([[0, 1, 1, 1, 0, 1, 0, 0, 0, 0],
                     [1, 0, 0, 1, 0, 0, 1, 0, 0, 0],
                     [1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                     [1, 1, 0, 0, 1, 0, 0, 0, 0, 0],
                     [0, 0, 0, 1, 0, 1, 0, 1, 0, 0],
                     [1, 0, 0, 0, 1, 0, 0, 0, 1, 0],
                     [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                     [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                     [0, 0, 0, 0, 0, 1, 0, 0, 0, 1],
                     [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]])
G_mat
</pre></div>
<div class="highlight">
<pre><span></span>G3 = networkx.Graph(G_mat)
G3.edges()
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org6d639c7">
<h4 id="org6d639c7">Edgelist</h4>
<div class="outline-text-4" id="text-org6d639c7">
<div class="highlight">
<pre><span></span>with open('G_edgelist.txt') as reader:
    print(reader.read())
</pre></div>
<div class="highlight">
<pre><span></span>G4 = networkx.read_edgelist('G_edgelist.txt', data=[('Weight', int)])

G4.edges(data=True)
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org6ded988">
<h4 id="org6ded988">Pandas DataFrame</h4>
<div class="outline-text-4" id="text-org6ded988">
<div class="highlight">
<pre><span></span>G_df = pandas.read_csv('G_edgelist.txt', delim_whitespace=True, 
                       header=None, names=['n1', 'n2', 'weight'])
G_df
</pre></div>
<div class="highlight">
<pre><span></span>G5 = networkx.from_pandas_dataframe(G_df, 'n1', 'n2', edge_attr='weight')
G5.edges(data=True)
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org463b0af">
<h3 id="org463b0af">A Chess Example</h3>
<div class="outline-text-3" id="text-org463b0af">
<div class="highlight">
<pre><span></span>with open('chess_graph.txt') as reader:
    count = 0
    for line in reader:
        print(line.strip())
        count += 1
        if count == 5:
            break
</pre></div>
<div class="highlight">
<pre><span></span>chess = networkx.read_edgelist('chess_graph.txt', data=[('outcome', int), ('timestamp', float)], 
                         create_using=networkx.MultiDiGraph())
</pre></div>
<div class="highlight">
<pre><span></span>chess.is_directed(), chess.is_multigraph()
</pre></div>
<div class="highlight">
<pre><span></span>chess.edges(data=True)[:5]
</pre></div>
<div class="highlight">
<pre><span></span>games_played = chess.degree()
games_played
</pre></div>
<div class="highlight">
<pre><span></span>max_value = max(games_played.values())
max_key, = [i for i in games_played.keys() if games_played[i] == max_value]

print('player {}\n{} games'.format(max_key, max_value))
</pre></div>
<div class="highlight">
<pre><span></span>df = pd.DataFrame(chess.edges(data=True), columns=['white', 'black', 'outcome'])
df.head()
</pre></div>
<div class="highlight">
<pre><span></span>df['outcome'] = df['outcome'].map(lambda x: x['outcome'])
df.head()
</pre></div>
<div class="highlight">
<pre><span></span>won_as_white = df[df['outcome']==1].groupby('white').sum()
won_as_black = df[df['outcome']==-1].groupby('black').sum()
win_count = won_as_white.add(won_as_black, fill_value=0)
print(win_count.head())
</pre></div>
<div class="highlight">
<pre><span></span>win_count.nlargest(5, 'outcome')
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgc3bb999">
<h2 id="orgc3bb999">The Return</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/company-moving-night/">Company Movie Night</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/company-moving-night/" rel="bookmark"><time class="published dt-published" datetime="2019-04-11T13:04:23-07:00" itemprop="datePublished" title="2019-04-11 13:04">2019-04-11 13:04</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/company-moving-night/#org2bc9d7e">The Departure</a>
<ul>
<li><a href="posts/networks/company-moving-night/#org23b5893">Imports</a></li>
<li><a href="posts/networks/company-moving-night/#orgb5dd9c8">Set Up</a></li>
<li><a href="posts/networks/company-moving-night/#org3d59bef">The Plotting</a></li>
</ul>
</li>
<li><a href="posts/networks/company-moving-night/#orgca2c334">The Initiation</a>
<ul>
<li><a href="posts/networks/company-moving-night/#org682623f">The Data</a></li>
<li><a href="posts/networks/company-moving-night/#org9acb9d3">Plot Graph</a></li>
<li><a href="posts/networks/company-moving-night/#org80c0970">The Employee Movie Choices Graph</a></li>
<li><a href="posts/networks/company-moving-night/#org73e9f2c">Question 2</a></li>
<li><a href="posts/networks/company-moving-night/#org4934d2c">Question 3</a></li>
<li><a href="posts/networks/company-moving-night/#orgf0d4a96">Question 4</a></li>
</ul>
</li>
<li><a href="posts/networks/company-moving-night/#orgb72da45">The Return</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org2bc9d7e">
<h2 id="org2bc9d7e">The Departure</h2>
<div class="outline-text-2" id="text-org2bc9d7e">
<p>This is a look at working with networks using <a href="https://networkx.github.io">networkx</a>. Our scene - eight employees are trying to choose three movies to watch. We have two sources of data - the candidate movies and the <i>relationship</i> between pairs of employees. The relationships are on a scale from -100 to 100, with -100 being the strongest of enemies and 100 meaning they are best of friends. Zero either means they have no relationship (don't interact) or are indifferent about the other person.</p>
</div>
<div class="outline-3" id="outline-container-org23b5893">
<h3 id="org23b5893">Imports</h3>
<div class="outline-text-3" id="text-org23b5893"></div>
<div class="outline-4" id="outline-container-orgc8c8630">
<h4 id="orgc8c8630">From Python</h4>
<div class="outline-text-4" id="text-orgc8c8630">
<div class="highlight">
<pre><span></span>from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org561316d">
<h4 id="org561316d">From PyPi</h4>
<div class="outline-text-4" id="text-org561316d">
<div class="highlight">
<pre><span></span>from dotenv import load_dotenv
from bokeh.models import HoverTool
import holoviews
import hvplot.pandas
import networkx
import pandas
import numpy
from networkx.algorithms import bipartite
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org7479a5f">
<h4 id="org7479a5f">My Stuff</h4>
<div class="outline-text-4" id="text-org7479a5f">
<div class="highlight">
<pre><span></span>from graeae.visualization import EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgb5dd9c8">
<h3 id="orgb5dd9c8">Set Up</h3>
<div class="outline-text-3" id="text-orgb5dd9c8"></div>
<div class="outline-4" id="outline-container-orgd00db63">
<h4 id="orgd00db63">Load Dotenv</h4>
<div class="outline-text-4" id="text-orgd00db63">
<div class="highlight">
<pre><span></span>load_dotenv(".env", override=True)
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org3d59bef">
<h3 id="org3d59bef">The Plotting</h3>
<div class="outline-text-3" id="text-org3d59bef">
<div class="highlight">
<pre><span></span>SLUG = 'company-movie-night'
OUTPUT = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=OUTPUT)
holoviews.extension("bokeh")
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgca2c334">
<h2 id="orgca2c334">The Initiation</h2>
<div class="outline-text-2" id="text-orgca2c334"></div>
<div class="outline-3" id="outline-container-org682623f">
<h3 id="org682623f">The Data</h3>
<div class="outline-text-3" id="text-org682623f"></div>
<div class="outline-4" id="outline-container-orgbc5dc1e">
<h4 id="orgbc5dc1e">This Is the Set Of Employee-Relationships</h4>
<div class="outline-text-4" id="text-orgbc5dc1e">
<div class="highlight">
<pre><span></span>employee_relationships_path = Path(os.environ.get("EMPLOYEE_RELATIONSHIPS"))
relationships_data = pandas.read_csv(
    employee_relationships_path, 
    delimiter="\t", 
    header=None,
    names="employee_1 employee_2 relationship".split())
</pre></div>
<div class="highlight">
<pre><span></span>table = holoviews.Table(relationships_data)
Embed(plot=table, file_name="relationships_data")()
</pre></div>
<object data="posts/networks/company-moving-night/relationships_data.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>employees = set(relationships_data.employee_1.unique()) | set(relationships_data.employee_2.unique())
print(employees)
</pre></div>
<pre class="example">
{'Claude', 'Pablo', 'Lee', 'Andy', 'Vincent', 'Joan', 'Frida', 'Georgia'}

</pre>
<div class="highlight">
<pre><span></span>print(len(employees))
</pre></div>
<pre class="example">
8

</pre>
<div class="highlight">
<pre><span></span>print(len(relationships_data))
</pre></div>
<pre class="example">
28

</pre>
<p>We have eight employees and twenty-eight links. Is this a fully connected graph? The handshake problem says that the amount of links in a fully-connected network is:</p>
<p>\[ links = \frac{n(n-1)}{2} \]</p>
<div class="highlight">
<pre><span></span>print(len(employees) * (len(employees) - 1)/2)
</pre></div>
<pre class="example">
28.0

</pre>
<p>It looks like our relationships data creates a fully-connected network (unless there is a duplicate which would be an error).</p>
</div>
</div>
<div class="outline-4" id="outline-container-org05df5ff">
<h4 id="org05df5ff">This Is the Movie Choices</h4>
<div class="outline-text-4" id="text-org05df5ff">
<div class="highlight">
<pre><span></span>employee_movies_path = Path(os.environ.get("EMPLOYEE_MOVIE_CHOICES"))
movies_data = pandas.read_csv(
    employee_movies_path, 
    delimiter="\t", 
    header=None,
    skiprows=1,
    names="employee movie".split())
print(movies_data.head())
</pre></div>
<pre class="example">
  employee                            movie
0     Andy                         Anaconda
1     Andy                       Mean Girls
2     Andy                       The Matrix
3   Claude                         Anaconda
4   Claude  Monty Python and the Holy Grail

</pre>
<div class="highlight">
<pre><span></span>movies = set(movies_data.movie.unique())
print(movies)
print(len(movies))
</pre></div>
<p>The eight employees chose 11 movies between them.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org9acb9d3">
<h3 id="org9acb9d3">Plot Graph</h3>
<div class="outline-text-3" id="text-org9acb9d3">
<p>You can use the following function to plot graphs.</p>
<div class="highlight">
<pre><span></span>def plot_graph(graph, file_name, plot_title, weight_name=None, directed=False):
    """Plots an interactive graph using the spring-layout

    Args:
     graph: a networkx graph
     file_name: name to store the plot (without extension)
     plot_title: name to give the plot
     weight_name: name of the attribute for plotting edge weights (if G is weighted)
     directed: whether it is a directed graph
    """
    plot = holoviews.Graph.from_networkx(graph,
                                         networkx.spring_layout).opts(
                                             cmap="Set1",                                             
                                             fontsize=Plot.fontsize,
                                             width=Plot.width,
                                             height=Plot.height,
                                             edge_line_color=Plot.edge_color,
                                             title=plot_title,
                                             xaxis=None, yaxis=None, directed=directed)
    Embed(plot=plot, file_name=file_name)()
    return
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org80c0970">
<h3 id="org80c0970">The Employee Movie Choices Graph</h3>
<div class="outline-text-3" id="text-org80c0970">
<p>The employee-movie network consists of employees and movies as nodes and the edges indicate an employee chose a movie. Not every movie is chosen by every employee, so it isn't a complete graph.</p>
<div class="highlight">
<pre><span></span>expected_edges = len(movies_data)
expected_nodes = len(employees) + len(movies)
print("Expected Edges: {}".format(expected_edges))
print("Expected Nodes: {}".format(expected_nodes))
</pre></div>
<pre class="example">
Expected Edges: 24
Expected Nodes: 19

</pre>
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(friendship_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("gender"), cmap="Set1",
                                         tools=[hover],
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,
                                         edge_line_color=Plot.edge_color,
                                         title="Friendship Network by Gender",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="employee_movie_choices_plot")()
</pre></div>
<div class="highlight">
<pre><span></span>def answer_one():
    """Loads the Employee Movie Choices

    Returns:
     Graph: graph with movie and employees as nodes
    """
    movie_choices = pandas.read_table('Employee_Movie_Choices.txt')
    movie_choices = networkx.from_pandas_dataframe(movie_choices, "#Employee", "Movie")
    return movie_choices
</pre></div>
<div class="highlight">
<pre><span></span>movie_choices = answer_one()
edges = movie_choices.edges()
assert len(edges) == 24
assert len(movie_choices.nodes()) == 19
assert networkx.is_bipartite(movie_choices)
positions = networkx.spring_layout(movie_choices)

networkx.draw_networkx(movie_choices, positions, edges=edges)
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org73e9f2c">
<h3 id="org73e9f2c">Question 2</h3>
<div class="outline-text-3" id="text-org73e9f2c">
<p>Using the graph from the previous question, add nodes attributes named `'type'` where movies have the value `'movie'` and employees have the value `'employee'` and return that graph.</p>
<p><b>This function should return a networkx graph with node attributes `{'type': 'movie'}` or `{'type': 'employee'}`</b></p>
<div class="highlight">
<pre><span></span>def answer_two():
    """Adds 'type' to nodes from movie-graph

    Returns:
     Graph: answer_one with 'type' attribute added (employee or movie)
    """
    graph = answer_one()
    new_graph = networkx.Graph()
    nodes = graph.nodes()
    employee_nodes = [node for node in nodes if node in employees]
    movie_nodes = [node for node in nodes if node in movies]
    new_graph.add_nodes_from(employee_nodes, bipartite=0, type='employee')
    new_graph.add_nodes_from(movie_nodes, bipartite=1, type="movie")
    new_graph.add_edges_from(graph.edges())
    return new_graph
</pre></div>
<div class="highlight">
<pre><span></span>two = answer_two()
two.nodes(data=True)
</pre></div>
<div class="highlight">
<pre><span></span>plot_graph(two)
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org4934d2c">
<h3 id="org4934d2c">Question 3</h3>
<div class="outline-text-3" id="text-org4934d2c">
<p>Find a weighted projection of the graph from `answer<sub>two</sub>` which tells us how many movies different pairs of employees have in common.</p>
<p><b>This function should return a weighted projected graph.</b></p>
<div class="highlight">
<pre><span></span>def answer_three():
    graph = answer_two()
    assert networkx.is_bipartite(graph)
    return bipartite.weighted_projected_graph(graph, employees)
</pre></div>
<div class="highlight">
<pre><span></span>three = answer_three()
plot_graph(three)
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf0d4a96">
<h3 id="orgf0d4a96">Question 4</h3>
<div class="outline-text-3" id="text-orgf0d4a96">
<p>Suppose you'd like to find out if people that have a high relationship score also like the same types of movies.</p>
<p>Find the Pearson correlation ( using `DataFrame.corr()` ) between employee relationship scores and the number of movies they have in common. If two employees have no movies in common it should be treated as a 0, not a missing value, and should be included in the correlation calculation.</p>
<p><b>This function should return a float.</b></p>
<div class="highlight">
<pre><span></span>def answer_four():
    """calculates the pearson correlation for data

    Returns:
     float: Pearson correlation for weight and relationship_score
    """
    three = answer_three()
    relationships = pandas.read_table(
        "Employee_Relationships.txt",
        names="employee_left employee_right relationship_score".split())
    relationships["employees"] = relationships.apply(
        lambda row: tuple(sorted((row["employee_left"],
                                  row['employee_right']))), axis=1)

    weights = pandas.DataFrame(
        three.edges(data=True),
        columns="employee_left employee_right weight".split())
    weights["weight"] = weights.weight.map(lambda row: row["weight"])
    weights["employees"] = weights.apply(lambda row: tuple(sorted(
        (row["employee_left"],
         row["employee_right"]))),
                                         axis=1)

    joined = pandas.merge(relationships, weights, how="outer", 
                          on=['employees'])
    assert len(joined) == len(relationships)
    joined['weight'] = joined["weight"].fillna(0)

    data = joined[["relationship_score", "weight"]]
    correlation = data.corr()
    return correlation.relationship_score.weight
</pre></div>
<div class="highlight">
<pre><span></span>print(answer_four())
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb72da45">
<h2 id="orgb72da45">The Return</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/libraries/prophet/getting-started-with-prophet/">Getting Started With Prophet</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/libraries/prophet/getting-started-with-prophet/" rel="bookmark"><time class="published dt-published" datetime="2019-04-05T14:53:40-07:00" itemprop="datePublished" title="2019-04-05 14:53">2019-04-05 14:53</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#org60746f0">The Departure</a>
<ul>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#orgd5c6a3c">Imports</a></li>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#org05ebdeb">Setup</a></li>
</ul>
</li>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#orgf8599f6">The Initiation</a>
<ul>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#orgf70637c">Load The Data</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org60746f0">
<h2 id="org60746f0">The Departure</h2>
<div class="outline-text-2" id="text-org60746f0">
<p>This is a first look at <a href="https://facebook.github.io/prophet/">Prophet</a> a time-series forecasting library. It depends on <code>pystan</code>, a Bayesian modelling platform, which in turn depends on <code>numpy</code> and <code>cython</code>.</p>
</div>
<div class="outline-3" id="outline-container-orgd5c6a3c">
<h3 id="orgd5c6a3c">Imports</h3>
<div class="outline-text-3" id="text-orgd5c6a3c"></div>
<div class="outline-4" id="outline-container-orge1d6939">
<h4 id="orge1d6939">Python</h4>
<div class="outline-text-4" id="text-orge1d6939">
<div class="highlight">
<pre><span></span>from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgca8ceb5">
<h4 id="orgca8ceb5">PyPi</h4>
<div class="outline-text-4" id="text-orgca8ceb5">
<div class="highlight">
<pre><span></span>from dotenv import load_dotenv
import modin.pandas as pandas
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgcafcba7">
<h4 id="orgcafcba7">My Stuff</h4>
<div class="outline-text-4" id="text-orgcafcba7">
<div class="highlight">
<pre><span></span>from graeae.timers import Timer
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org05ebdeb">
<h3 id="org05ebdeb">Setup</h3>
<div class="outline-text-3" id="text-org05ebdeb"></div>
<div class="outline-4" id="outline-container-org30fd0f5">
<h4 id="org30fd0f5">The Paths</h4>
<div class="outline-text-4" id="text-org30fd0f5">
<div class="highlight">
<pre><span></span>load_dotenv(".env", override=True)
DATA = Path(os.environ.get("PEYTON_MANNING_WIKIPEDIA_VIEWS")).expanduser()
assert DATA.is_file()
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgd569bf6">
<h4 id="orgd569bf6">The Timer</h4>
<div class="outline-text-4" id="text-orgd569bf6">
<div class="highlight">
<pre><span></span>TIMER = Timer()
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf8599f6">
<h2 id="orgf8599f6">The Initiation</h2>
<div class="outline-text-2" id="text-orgf8599f6"></div>
<div class="outline-3" id="outline-container-orgf70637c">
<h3 id="orgf70637c">Load The Data</h3>
<div class="outline-text-3" id="text-orgf70637c">
<div class="highlight">
<pre><span></span>with TIMER:
    data = pandas.read_csv(DATA)
print(data.shape)
</pre></div>
<pre class="example">
WARNING: Falling back to serializing objects of type &lt;class 'pathlib.PosixPath'&gt; by using pickle. This may be inefficient.
Started: 2019-04-05 15:23:56.038686
Ended: 2019-04-05 15:23:56.236422
Elapsed: 0:00:00.197736
(2905, 2)

</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/high-school-contact-networks/">High School Contact Networks</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/high-school-contact-networks/" rel="bookmark"><time class="published dt-published" datetime="2019-03-27T17:38:17-07:00" itemprop="datePublished" title="2019-03-27 17:38">2019-03-27 17:38</time> <span class="updated">(updated <time class="dt-updated" datetime="2019-03-27T00:11:17-07:00" itemprop="dateUpdated" title="2019-03-27 00:11">2019-03-27 00:11</time>)</span></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/high-school-contact-networks/#org774e9d9">The Departure</a>
<ul>
<li><a href="posts/networks/high-school-contact-networks/#org8416791">Setup The Plotting</a></li>
<li><a href="posts/networks/high-school-contact-networks/#orgd45eb7b">Load The Data</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-contact-networks/#org819fb51">The Descent</a></li>
<li><a href="posts/networks/high-school-contact-networks/#org27ca107">End</a>
<ul>
<li><a href="posts/networks/high-school-contact-networks/#org2e3db1d">Citations</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org774e9d9">
<h2 id="org774e9d9">The Departure</h2>
<div class="outline-text-2" id="text-org774e9d9">
<p>This looks at data provided by <a href="http://www.sociopatterns.org">SocioPatterns</a> that looks a the interactions between students at a High School in Marseilles, France, in December of 2013.</p>
</div>
<div class="outline-4" id="outline-container-org66ddbd0">
<h4 id="org66ddbd0">Imports</h4>
<div class="outline-text-4" id="text-org66ddbd0"></div>
<div class="outline-5" id="outline-container-orgfeca3d8">
<h5 id="orgfeca3d8">From Python</h5>
<div class="outline-text-5" id="text-orgfeca3d8">
<div class="highlight">
<pre><span></span>from collections import Counter
from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org08c7377">
<h5 id="org08c7377">From PyPi</h5>
<div class="outline-text-5" id="text-org08c7377">
<div class="highlight">
<pre><span></span>from bokeh.models import HoverTool
from dotenv import load_dotenv
from holoviews import dim, opts
from holoviews.operation.datashader import datashade, bundle_graph
import holoviews
import hvplot.pandas
import networkx
import pandas as pandas
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org271ec56">
<h5 id="org271ec56">My Stuff</h5>
<div class="outline-text-5" id="text-org271ec56">
<div class="highlight">
<pre><span></span>from graeae.timers import Timer
from graeae.visualization import EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org3ef45c5">
<h4 id="org3ef45c5">Load the Dotenv</h4>
<div class="outline-text-4" id="text-org3ef45c5">
<div class="highlight">
<pre><span></span>load_dotenv(".env")
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org500ba9a">
<h4 id="org500ba9a">Build the Timer</h4>
<div class="outline-text-4" id="text-org500ba9a">
<div class="highlight">
<pre><span></span>TIMER = Timer()
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org8416791">
<h3 id="org8416791">Setup The Plotting</h3>
<div class="outline-text-3" id="text-org8416791">
<div class="highlight">
<pre><span></span>holoviews.extension("bokeh")
SLUG = "high-school-contact-networks/"
output = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=output)
</pre></div>
<div class="highlight">
<pre><span></span>class Plot:
    """Constants for plotting"""
    width = 1000
    height = 800
    fontsize = 18
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgd45eb7b">
<h3 id="orgd45eb7b">Load The Data</h3>
<div class="outline-text-3" id="text-orgd45eb7b">
<p>Let's take a look at the data before loading it into pandas.</p>
<div class="highlight">
<pre><span></span>HIGH_SCHOOL = Path(os.environ.get("HIGH_SCHOOL")).expanduser()
assert HIGH_SCHOOL.is_dir()

#+begin_src ipython :session highschool :results none
class Files:
    metadata = "metadata_2013.txt"
    contact_diaries = "Contact-diaries-network_data_2013.csv"
    facebook = "Facebook-known-pairs_data_2013.csv"
    friendship = "Friendship-network_data_2013.csv"
    high_school = "High-School_data_2013.csv"
</pre></div>
</div>
<div class="outline-4" id="outline-container-orge6f14c4">
<h4 id="orge6f14c4">MetaData</h4>
<div class="outline-text-4" id="text-orge6f14c4">
<div class="highlight">
<pre><span></span>metadata_path = HIGH_SCHOOL.joinpath(Files.metadata)
assert metadata_path.is_file()
with metadata_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
650     2BIO1   F
498     2BIO1   F
627     2BIO1   F
857     2BIO1   F
487     2BIO1   F

</pre>
<p>This first file has the meta-data for the students. The three columns are the student's ID, class, and gender.</p>
<div class="highlight">
<pre><span></span>meta_data = pandas.read_csv(metadata_path, sep="\t", 
                            names=["id", "class", "gender"])
meta_data.loc[:, "class"] = meta_data["class"].astype("category")
meta_data.loc[:, "gender"] = meta_data.gender.astype("category")
</pre></div>
</div>
<div class="outline-5" id="outline-container-orga3eb430">
<h5 id="orga3eb430">Classes</h5>
<div class="outline-text-5" id="text-orga3eb430">
<p>First a bar-plot to look at how the classes are distributed.</p>
<div class="highlight">
<pre><span></span>grouped = meta_data.groupby(["class", "gender"]).agg(
    {"class": "count", "gender": "count"})
grouped.columns = ["class_count", "gender_count"]
grouped = grouped.reset_index()
</pre></div>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", 
                          x="class", y="class_count", 
                          stacked=True,
                          by="gender", height=Plot.height, 
                          width=Plot.width,
                          ylabel="Count",
                          xlabel="Class",
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/gender_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/gender_counts_stacked.html">Link to Plot</a></p>
<p>This is a look at the same thing except not stacked.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", x="class", 
                          y="class_count",
                          xlabel="Class",
                          ylabel="Count",
                          by="gender", height=Plot.height, width=Plot.width, 
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/gender_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/gender_counts.html">Link to Plot</a></p>
<p>Strangely, the classes that start with <code>2BIO</code> are more female while the others are more male.</p>
</div>
</div>
<div class="outline-5" id="outline-container-orgb76cbdd">
<h5 id="orgb76cbdd">Gender</h5>
<div class="outline-text-5" id="text-orgb76cbdd">
<p>A stacked bar plot to get a sense of not just the distribution among genders but among classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          stacked=True,
                          by="class", 
                          xlabel="Count",
                          ylabel="Gender",
                          fontsize=Plot.fontsize,
                          width=Plot.width,
                          height=Plot.height).opts(
                              xrotation=90, 
                              xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/class_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/class_counts_stacked.html">Link to Plot</a></p>
<p>A non-stacked bar plot to get a better sense of how the genders fill the different classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          xlabel="Gender",
                          ylabel="Count",
                          by="class", 
                          height=Plot.height,
                          width=Plot.width,
                          fontsize=Plot.fontsize).opts(
                              xrotation=90, xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/class_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/class_counts.html">Link to Plot</a></p>
<p>It looks like there were a little more males than females, but not a whole lot more.</p>
</div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org819fb51">
<h2 id="org819fb51">The Descent</h2>
<div class="outline-text-2" id="text-org819fb51"></div>
<div class="outline-4" id="outline-container-org9c05dcc">
<h4 id="org9c05dcc">The Contact Network</h4>
<div class="outline-text-4" id="text-org9c05dcc">
<p>This is a dataset that shows whether a student logged contact with another student.</p>
<div class="highlight">
<pre><span></span>contact_path = HIGH_SCHOOL.joinpath(Files.contact_diaries)
assert contact_path.is_file()
with contact_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
3 28 2
3 106 1
3 147 4
3 177 1
3 295 4

</pre>
<p>The columns are the person who was making the report, the person that was identified as a contact, and the time spent ecoded into one of four values.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Code</th>
<th class="org-right" scope="col">Lower Limit (minutes)</th>
<th class="org-right" scope="col">Upper Limit (minutes)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">5</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">15</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">15</td>
<td class="org-right">60</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">60</td>
<td class="org-right">infinity</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span>contact_data = pandas.read_csv(contact_path, delimiter=" ", 
                                  names=["reporter", "contact", "time"])
contact_data = contact_data.dropna()
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org27ca107">
<h2 id="org27ca107">End</h2>
<div class="outline-text-2" id="text-org27ca107"></div>
<div class="outline-3" id="outline-container-org2e3db1d">
<h3 id="org2e3db1d">Citations</h3>
<div class="outline-text-3" id="text-org2e3db1d">
<ul class="org-ul">
<li>R. Mastrandrea, J. Fournet, A. Barrat,</li>
</ul>
<p>Contact patterns in a high school: a comparison between data collected using wearable sensors, contact diaries and friendship surveys. PLoS ONE 10(9): e0136497 (2015)</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/high-school-facebook-networks/">High School Facebook Networks</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/high-school-facebook-networks/" rel="bookmark"><time class="published dt-published" datetime="2019-03-27T17:38:17-07:00" itemprop="datePublished" title="2019-03-27 17:38">2019-03-27 17:38</time> <span class="updated">(updated <time class="dt-updated" datetime="2019-03-27T00:11:17-07:00" itemprop="dateUpdated" title="2019-03-27 00:11">2019-03-27 00:11</time>)</span></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#org8b5d508">The Departure</a>
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#orgf7ed5a0">Setup The Plotting</a></li>
<li><a href="posts/networks/high-school-facebook-networks/#org000ad90">Load The Data</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-facebook-networks/#orgb5d79df">The Descent</a></li>
<li><a href="posts/networks/high-school-facebook-networks/#orgcd266b3">The Descent</a>
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#org7b00256">Looking at the Friendship Network</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-facebook-networks/#org2c55dc1">End</a>
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#org509ea5e">Citations</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org8b5d508">
<h2 id="org8b5d508">The Departure</h2>
<div class="outline-text-2" id="text-org8b5d508">
<p>This looks at data provided by <a href="http://www.sociopatterns.org">SocioPatterns</a> that looks a the interactions between students at a High School in Marseilles, France, in December of 2013.</p>
</div>
<div class="outline-4" id="outline-container-org11891c6">
<h4 id="org11891c6">Imports</h4>
<div class="outline-text-4" id="text-org11891c6"></div>
<div class="outline-5" id="outline-container-orgbab260a">
<h5 id="orgbab260a">From Python</h5>
<div class="outline-text-5" id="text-orgbab260a">
<div class="highlight">
<pre><span></span>from collections import Counter
from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org6adb087">
<h5 id="org6adb087">From PyPi</h5>
<div class="outline-text-5" id="text-org6adb087">
<div class="highlight">
<pre><span></span>from bokeh.models import HoverTool
from dotenv import load_dotenv
from holoviews import dim, opts
from holoviews.operation.datashader import datashade, bundle_graph
import holoviews
import hvplot.pandas
import networkx
import pandas as pandas
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org6478d6c">
<h5 id="org6478d6c">My Stuff</h5>
<div class="outline-text-5" id="text-org6478d6c">
<div class="highlight">
<pre><span></span>from graeae.timers import Timer
from graeae.visualization import EmbedBokeh, EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-orgaaef694">
<h4 id="orgaaef694">Load the Dotenv</h4>
<div class="outline-text-4" id="text-orgaaef694">
<div class="highlight">
<pre><span></span>load_dotenv(".env")
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orga41344f">
<h4 id="orga41344f">Build the Timer</h4>
<div class="outline-text-4" id="text-orga41344f">
<div class="highlight">
<pre><span></span>TIMER = Timer()
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf7ed5a0">
<h3 id="orgf7ed5a0">Setup The Plotting</h3>
<div class="outline-text-3" id="text-orgf7ed5a0">
<div class="highlight">
<pre><span></span>holoviews.extension("bokeh")
SLUG = "high-school-contact-and-friendship-networks/"
output = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=output)
EmbedB = partial(EmbedBokeh, folder_path=output)
</pre></div>
<div class="highlight">
<pre><span></span>class Plot:
    """Constants for plotting"""
    width = 1000
    height = 800
    fontsize = 18
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org000ad90">
<h3 id="org000ad90">Load The Data</h3>
<div class="outline-text-3" id="text-org000ad90">
<p>Let's take a look at the data before loading it into pandas.</p>
<div class="highlight">
<pre><span></span>HIGH_SCHOOL = Path(os.environ.get("HIGH_SCHOOL")).expanduser()
assert HIGH_SCHOOL.is_dir()

#+begin_src ipython :session highschool :results none
class Files:
    metadata = "metadata_2013.txt"
    contact_diaries = "Contact-diaries-network_data_2013.csv"
    facebook = "Facebook-known-pairs_data_2013.csv"
    friendship = "Friendship-network_data_2013.csv"
    high_school = "High-School_data_2013.csv"
</pre></div>
</div>
<div class="outline-4" id="outline-container-org33b0740">
<h4 id="org33b0740">MetaData</h4>
<div class="outline-text-4" id="text-org33b0740">
<div class="highlight">
<pre><span></span>metadata_path = HIGH_SCHOOL.joinpath(Files.metadata)
assert metadata_path.is_file()
with metadata_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
650     2BIO1   F
498     2BIO1   F
627     2BIO1   F
857     2BIO1   F
487     2BIO1   F

</pre>
<p>This first file has the meta-data for the students. The three columns are the student's ID, class, and gender.</p>
<div class="highlight">
<pre><span></span>meta_data = pandas.read_csv(metadata_path, sep="\t", 
                            names=["id", "class", "gender"])
meta_data.loc[:, "class"] = meta_data["class"].astype("category")
meta_data.loc[:, "gender"] = meta_data.gender.astype("category")
</pre></div>
</div>
<div class="outline-5" id="outline-container-orgbe1437a">
<h5 id="orgbe1437a">Classes</h5>
<div class="outline-text-5" id="text-orgbe1437a">
<p>First a bar-plot to look at how the classes are distributed.</p>
<div class="highlight">
<pre><span></span>grouped = meta_data.groupby(["class", "gender"]).agg(
    {"class": "count", "gender": "count"})
grouped.columns = ["class_count", "gender_count"]
grouped = grouped.reset_index()
</pre></div>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", 
                          x="class", y="class_count", 
                          stacked=True,
                          by="gender", height=Plot.height, 
                          width=Plot.width,
                          ylabel="Count",
                          xlabel="Class",
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/gender_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>This is a look at the same thing except not stacked.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", x="class", 
                          y="class_count",
                          xlabel="Class",
                          ylabel="Count",
                          by="gender", height=Plot.height, width=Plot.width, 
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/gender_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Strangely, the classes that start with <code>2BIO</code> are more female while the others are more male.</p>
</div>
</div>
<div class="outline-5" id="outline-container-org68df08d">
<h5 id="org68df08d">Gender</h5>
<div class="outline-text-5" id="text-org68df08d">
<p>A stacked bar plot to get a sense of not just the distribution among genders but among classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          stacked=True,
                          by="class", 
                          xlabel="Count",
                          ylabel="Gender",
                          fontsize=Plot.fontsize,
                          width=Plot.width,
                          height=Plot.height).opts(
                              xrotation=90, 
                              xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/class_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>A non-stacked bar plot to get a better sense of how the genders fill the different classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          xlabel="Gender",
                          ylabel="Count",
                          by="class", 
                          height=Plot.height,
                          width=Plot.width,
                          fontsize=Plot.fontsize).opts(
                              xrotation=90, xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/class_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It looks like there were a little more males than females, but not a whole lot more.</p>
</div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb5d79df">
<h2 id="orgb5d79df">The Descent</h2>
<div class="outline-text-2" id="text-orgb5d79df"></div>
<div class="outline-4" id="outline-container-org1889f86">
<h4 id="org1889f86">The Facebook Network</h4>
<div class="outline-text-4" id="text-org1889f86">
<p>This is a dataset that shows whether a student was <i>facebook</i> friends with another student.</p>
<div class="highlight">
<pre><span></span>facebook_path = HIGH_SCHOOL.joinpath(Files.facebook)
assert facebook_path.is_file()
with facebook_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
1 984 0
1 883 1
1 941 0
1 650 0
1 132 1

</pre>
<p>The columns are <i>one student</i>, <i>next student</i>, <i>facebook friends</i>.</p>
<p>The third column is <i>0</i> if they aren't facebook friends and <i>1</i> if they are.</p>
<div class="highlight">
<pre><span></span>facebook_data = pandas.read_csv(facebook_path, delimiter=" ", 
                                names=["reporter", "other", "friend"])
facebook_data = facebook_data.dropna()
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgcd266b3">
<h2 id="orgcd266b3">The Descent</h2>
<div class="outline-text-2" id="text-orgcd266b3"></div>
<div class="outline-3" id="outline-container-org7b00256">
<h3 id="org7b00256">Looking at the Friendship Network</h3>
<div class="outline-text-3" id="text-org7b00256">
<div class="highlight">
<pre><span></span>with TIMER:
    facebook_graph = networkx.convert_matrix.from_pandas_edgelist(
        facebook_data, "reporter", "other", 
        create_using=networkx.DiGraph)
</pre></div>
<pre class="example">
Started: 2019-03-27 23:05:04.495114
Ended: 2019-03-27 23:05:04.499622
Elapsed: 0:00:00.004508

</pre>
<div class="highlight">
<pre><span></span>genders = dict(zip(meta_data.id, meta_data.gender))
classes = dict(zip(meta_data.id, meta_data["class"]))
</pre></div>
<div class="highlight">
<pre><span></span>for node in facebook_graph.nodes:
    facebook_graph.nodes[node]["gender"] = genders[node]
    facebook_graph.nodes[node]["class"] = classes[node]
</pre></div>
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips = [
         ("Gender", "@gender"),
         ("Class", "@class"),
    ],
)

plot = holoviews.Graph.from_networkx(facebook_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("gender"), cmap="Set1",
                                         tools=[hover],
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,                                        
                                         title="Facebook Network by Gender",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_circular")()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_circular.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It's a little hard to see what's going on here, other than to note that you can see some people are more popular than others.</p>
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips = [
         ("Gender", "@gender"),
         ("Class", "@class"),
    ],
)

plot = holoviews.Graph.from_networkx(facebook_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("class"), cmap="Set1",
                                         tools=[hover],
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,                                        
                                         title="Facebook Network by Class",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_circular_class")()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_circular_class.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(facebook_graph, networkx.spring_layout, ).opts(
                                         node_color=dim("class"), cmap="Set1",
                                         tools=["hover"],
                                         width=800,
                                         height=800,
                                         title="Facebook Network By Class",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_class_spring", height_in_pixels=810)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_class_spring.html" height="810" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(facebook_graph, networkx.spring_layout, ).opts(
                                         node_color=dim("gender"), cmap="Set1",
                                         tools=["hover"],
                                         width=800,
                                         height=800,
                                         title="Facebook Network By Gender",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_gender_spring", height_in_pixels=810)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_gender_spring.html" height="810" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
</div>
<div class="outline-2" id="outline-container-org2c55dc1">
<h2 id="org2c55dc1">End</h2>
<div class="outline-text-2" id="text-org2c55dc1"></div>
<div class="outline-3" id="outline-container-org509ea5e">
<h3 id="org509ea5e">Citations</h3>
<div class="outline-text-3" id="text-org509ea5e">
<ul class="org-ul">
<li>R. Mastrandrea, J. Fournet, A. Barrat,</li>
</ul>
<p>Contact patterns in a high school: a comparison between data collected using wearable sensors, contact diaries and friendship surveys. PLoS ONE 10(9): e0136497 (2015)</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/high-school-friendship-networks/">High School Friendship Networks</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/high-school-friendship-networks/" rel="bookmark"><time class="published dt-published" datetime="2019-03-24T17:38:17-07:00" itemprop="datePublished" title="2019-03-24 17:38">2019-03-24 17:38</time> <span class="updated">(updated <time class="dt-updated" datetime="2019-03-27T00:11:17-07:00" itemprop="dateUpdated" title="2019-03-27 00:11">2019-03-27 00:11</time>)</span></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/high-school-friendship-networks/#org59967bc">The Departure</a>
<ul>
<li><a href="posts/networks/high-school-friendship-networks/#org3b48468">Setup The Plotting</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-friendship-networks/#org3c481ca">The Initiation</a>
<ul>
<li><a href="posts/networks/high-school-friendship-networks/#org60b87ee">Meta-Data</a></li>
<li><a href="posts/networks/high-school-friendship-networks/#org5ad9f26">The Friendship Network</a></li>
<li><a href="posts/networks/high-school-friendship-networks/#orge214e59">Looking at the Friendship Network</a></li>
<li><a href="posts/networks/high-school-friendship-networks/#org644eaab">Plotting</a></li>
<li><a href="posts/networks/high-school-friendship-networks/#orgc9883fa">Degree Distribution</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-friendship-networks/#org9a6618c">The Return</a>
<ul>
<li><a href="posts/networks/high-school-friendship-networks/#org74c80ba">Citations</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org59967bc">
<h2 id="org59967bc">The Departure</h2>
<div class="outline-text-2" id="text-org59967bc">
<p>This looks at data provided by <a href="http://www.sociopatterns.org">SocioPatterns</a> that looks a the interactions between students at a High School in Marseilles, France, in December of 2013. In particular, I'm going to look at the <i>Friendship Networks</i> data - wherein the students reported who they were friends with.</p>
</div>
<div class="outline-4" id="outline-container-orga18a8ab">
<h4 id="orga18a8ab">Imports</h4>
<div class="outline-text-4" id="text-orga18a8ab"></div>
<div class="outline-5" id="outline-container-org8027d23">
<h5 id="org8027d23">From Python</h5>
<div class="outline-text-5" id="text-org8027d23">
<div class="highlight">
<pre><span></span>from collections import Counter
from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-orgdaca34e">
<h5 id="orgdaca34e">From PyPi</h5>
<div class="outline-text-5" id="text-orgdaca34e">
<div class="highlight">
<pre><span></span>from bokeh.models import HoverTool
from dotenv import load_dotenv
from holoviews import dim, opts
from holoviews.operation.datashader import datashade, bundle_graph
import holoviews
import hvplot.pandas
import networkx
import pandas as pandas
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org58fc731">
<h5 id="org58fc731">My Stuff</h5>
<div class="outline-text-5" id="text-org58fc731">
<div class="highlight">
<pre><span></span>from graeae.timers import Timer
from graeae.tables import CountPercentage
from graeae.visualization import EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-orgf8d1185">
<h4 id="orgf8d1185">Load the Dotenv</h4>
<div class="outline-text-4" id="text-orgf8d1185">
<div class="highlight">
<pre><span></span>load_dotenv(".env")
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgfc95434">
<h4 id="orgfc95434">Build the Timer</h4>
<div class="outline-text-4" id="text-orgfc95434">
<div class="highlight">
<pre><span></span>TIMER = Timer()
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org3b48468">
<h3 id="org3b48468">Setup The Plotting</h3>
<div class="outline-text-3" id="text-org3b48468">
<div class="highlight">
<pre><span></span>holoviews.extension("bokeh")
SLUG = "high-school-friendship-networks/"
output = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=output)
</pre></div>
<div class="highlight">
<pre><span></span>class Plot:
    """Constants for plotting"""
    width = 1000
    height = 800
    fontsize = 18
    edge_color = "LightSteelBlue"
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org3c481ca">
<h2 id="org3c481ca">The Initiation</h2>
<div class="outline-text-2" id="text-org3c481ca"></div>
<div class="outline-3" id="outline-container-org60b87ee">
<h3 id="org60b87ee">Meta-Data</h3>
<div class="outline-text-3" id="text-org60b87ee">
<p>Let's take a look at the meta-data before loading it into pandas.</p>
<div class="highlight">
<pre><span></span>HIGH_SCHOOL = Path(os.environ.get("HIGH_SCHOOL")).expanduser()
assert HIGH_SCHOOL.is_dir()

#+begin_src ipython :session highschool :results none
class Files:
    metadata = "metadata_2013.txt"
    contact_diaries = "Contact-diaries-network_data_2013.csv"
    facebook = "Facebook-known-pairs_data_2013.csv"
    friendship = "Friendship-network_data_2013.csv"
    high_school = "High-School_data_2013.csv"
</pre></div>
<div class="highlight">
<pre><span></span>metadata_path = HIGH_SCHOOL.joinpath(Files.metadata)
assert metadata_path.is_file()
with metadata_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
650     2BIO1   F
498     2BIO1   F
627     2BIO1   F
857     2BIO1   F
487     2BIO1   F

</pre>
<p>This file has the meta-data for the students. The three columns are the student's ID, class, and gender. I don't know what <i>class</i> refers to here.</p>
<div class="highlight">
<pre><span></span>meta_data = pandas.read_csv(metadata_path, sep="\t", 
                            names=["id", "class", "gender"])
meta_data.loc[:, "class"] = meta_data["class"].astype("category")
meta_data.loc[:, "gender"] = meta_data.gender.astype("category")
</pre></div>
<div class="highlight">
<pre><span></span>print(len(meta_data))
print(len(meta_data.id.unique()))
</pre></div>
<pre class="example">
329
329

</pre>
<p>So there's one entry for each student, meaning the student's can't belong to more than one class.</p>
</div>
<div class="outline-4" id="outline-container-org6a05ee9">
<h4 id="org6a05ee9">Classes</h4>
<div class="outline-text-4" id="text-org6a05ee9">
<p>First a table of the counts.</p>
<div class="highlight">
<pre><span></span>table = CountPercentage(meta_data["class"]).holoviews_table.opts(
    width=Plot.width,
    height=256,
    fontsize=Plot.fontsize,
)
Embed(plot=table, file_name="class_table", height_in_pixels=270)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/class_table.html" height="270" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>The fact that there are nine classes makes it seem like it's not likely they are 'classes' in the sense of freshman, sophomores, etc. At the same time, since each student only has one class, it doesn't seem like they are 'classes' in the sense of "Biology 101".</p>
<p>Now a bar-plot to look at how the classes are distributed.</p>
<div class="highlight">
<pre><span></span>grouped = meta_data.groupby(["class", "gender"]).agg(
    {"class": "count", "gender": "count"})
grouped.columns = ["class_count", "gender_count"]
grouped = grouped.reset_index()
</pre></div>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", 
                          x="class", y="class_count", 
                          stacked=True,
                          by="gender", height=Plot.height, 
                          width=Plot.width,
                          ylabel="Count",
                          xlabel="Class",
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/gender_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-friendship-networks/gender_counts_stacked.html">Link to Plot</a></p>
<p>This is a look at the same thing except not stacked.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", x="class", 
                          y="class_count",
                          xlabel="Class",
                          ylabel="Count",
                          by="gender", height=Plot.height, width=Plot.width, 
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/gender_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-friendship-networks/gender_counts.html">Link to Plot</a></p>
<p>Strangely, the classes that start with <code>2BIO</code> are more female while the others are more male.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org384d153">
<h4 id="org384d153">Gender</h4>
<div class="outline-text-4" id="text-org384d153">
<p>A stacked bar plot to get a sense of not just the distribution among genders but among classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          stacked=True,
                          by="class", 
                          xlabel="Count",
                          ylabel="Gender",
                          fontsize=Plot.fontsize,
                          width=Plot.width,
                          height=Plot.height).opts(
                              legend_position="top_right",
                              xrotation=90, 
                              xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/class_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-friendship-networks/class_counts_stacked.html">Link to Plot</a></p>
<p>A non-stacked bar plot to get a better sense of how the genders fill the different classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          xlabel="Gender",
                          ylabel="Count",
                          by="class", 
                          height=Plot.height,
                          width=Plot.width,
                          fontsize=Plot.fontsize).opts(
                              xrotation=90, xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/class_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-friendship-networks/class_counts.html">Link to Plot</a></p>
<p>It looks like there were a little more males than females, but not a whole lot more.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org5ad9f26">
<h3 id="org5ad9f26">The Friendship Network</h3>
<div class="outline-text-3" id="text-org5ad9f26">
<p>This is a dataset that shows whether a student identified another student as their friend.</p>
<div class="highlight">
<pre><span></span>friendship_path = HIGH_SCHOOL.joinpath(Files.friendship)
assert friendship_path.is_file()
with friendship_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
1 55
1 205
1 272
1 494
1 779

</pre>
<p>The first column is the person who reported who his or her friends were and the second column is the person that was identified as a friend.</p>
<div class="highlight">
<pre><span></span>friendship_data = pandas.read_csv(friendship_path, delimiter=" ", 
                                  names=["reporter", "friend"])
friendship_data = friendship_data.dropna()
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orge214e59">
<h3 id="orge214e59">Looking at the Friendship Network</h3>
<div class="outline-text-3" id="text-orge214e59">
<div class="highlight">
<pre><span></span>with TIMER:
    friendship_graph = networkx.convert_matrix.from_pandas_edgelist(
        friendship_data, "reporter", "friend", 
        create_using=networkx.DiGraph)
</pre></div>
<pre class="example">
Started: 2019-04-10 15:15:14.469087
Ended: 2019-04-10 15:15:14.471246
Elapsed: 0:00:00.002159

</pre>
<div class="highlight">
<pre><span></span>genders = dict(zip(meta_data.id, meta_data.gender))
classes = dict(zip(meta_data.id, meta_data["class"]))
</pre></div>
<div class="highlight">
<pre><span></span>for node in friendship_graph.nodes:
    friendship_graph.nodes[node]["gender"] = genders[node]
    friendship_graph.nodes[node]["class"] = classes[node]
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org644eaab">
<h3 id="org644eaab">Plotting</h3>
<div class="outline-text-3" id="text-org644eaab"></div>
<div class="outline-4" id="outline-container-orgeaaad38">
<h4 id="orgeaaad38">Friendship Network Circular</h4>
<div class="outline-text-4" id="text-orgeaaad38"></div>
<div class="outline-5" id="outline-container-orgf70360f">
<h5 id="orgf70360f">By Gender</h5>
<div class="outline-text-5" id="text-orgf70360f">
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips = [
         ("Gender", "@gender"),
         ("Class", "@class"),
    ],
)

plot = holoviews.Graph.from_networkx(friendship_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("gender"), cmap="Set1",
                                         tools=[hover],
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,
                                         edge_line_color=Plot.edge_color,
                                         title="Friendship Network by Gender",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="friendship_network_circular")()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/friendship_network_circular.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It's a little hard to see what's going on here, other than to note that you can see some people are more popular than others.</p>
</div>
</div>
<div class="outline-5" id="outline-container-orgddc7e0a">
<h5 id="orgddc7e0a">By Class</h5>
<div class="outline-text-5" id="text-orgddc7e0a">
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips = [
         ("Gender", "@gender"),
         ("Class", "@class"),
    ],
)

plot = holoviews.Graph.from_networkx(friendship_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("class"), cmap="Set1",
                                         tools=[hover],
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,
                                         edge_line_color=Plot.edge_color,
                                         title="Friendship Network by Class",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="friendship_network_circular_class")()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/friendship_network_circular_class.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-friendship-networks/friendship_network_circular_class.html">Link to Plot</a></p>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org046475d">
<h4 id="org046475d">Spring Layout</h4>
<div class="outline-text-4" id="text-org046475d"></div>
<div class="outline-5" id="outline-container-org3371b92">
<h5 id="org3371b92">Class</h5>
<div class="outline-text-5" id="text-org3371b92">
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(friendship_graph, networkx.spring_layout, ).opts(
    node_color=dim("class"), cmap="Set1",
    tools=["hover"],
    width=800,
    height=800,
    edge_line_color=Plot.edge_color,
    title="Friendship Network By Class",
    xaxis=None, yaxis=None, directed=True,
    legend_position="right"
)
Embed(plot=plot, file_name="friendship_network_class_spring", height_in_pixels=810)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/friendship_network_class_spring.html" height="810" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-friendship-networks/friendship_network_class_spring.html">Link to Plot</a></p>
<p>Unlike the circular plot, this plot shows that there are disconnected neighborhoods within the network and there seems to be a clustering by class.</p>
</div>
</div>
<div class="outline-5" id="outline-container-org2680784">
<h5 id="org2680784">Gender</h5>
<div class="outline-text-5" id="text-org2680784">
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(friendship_graph, networkx.spring_layout, ).opts(
                                         node_color=dim("gender"), cmap="Set1",
                                         tools=["hover"],
                                         width=800,
                                         height=800,
                                         edge_line_color=Plot.edge_color,
                                         title="Friendship Network By Gender",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="friendship_network_gender_spring", height_in_pixels=810)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/friendship_network_gender_spring.html" height="810" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-friendship-networks/friendship_network_gender_spring.html">Link to Plot</a></p>
<p>Interestingly, this view seems to show that there is also some segregation by gender.</p>
</div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc9883fa">
<h3 id="orgc9883fa">Degree Distribution</h3>
<div class="outline-text-3" id="text-orgc9883fa"></div>
<div class="outline-4" id="outline-container-org21dcbb9">
<h4 id="org21dcbb9">Total Degrees</h4>
<div class="outline-text-4" id="text-org21dcbb9">
<div class="highlight">
<pre><span></span>degree_sequence = sorted((degree for node, degree in friendship_graph.degree()))
degree_counts = Counter(degree_sequence)
degrees, counts = zip(*degree_counts.items())
</pre></div>
<div class="highlight">
<pre><span></span>table = holoviews.Table({"Degrees": degrees, "Count": counts}, ["Degrees"], ["Count"])
plot = table.to.bars(kdims=["Degrees"], vdims=["Count"]).opts(
    width=Plot.width,
    height=Plot.height,
    fontsize=Plot.fontsize,
    title="Degree Distribution",
    tools=["hover"],
)
Embed(plot=plot, file_name="degree_distribution")()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/degree_distribution.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
<div class="outline-4" id="outline-container-org2df1c5f">
<h4 id="org2df1c5f">In-Degree Distribution</h4>
<div class="outline-text-4" id="text-org2df1c5f">
<div class="highlight">
<pre><span></span>in_degree_sequence = sorted((degree for node, degree in friendship_graph.in_degree))
in_degree_counts = Counter(in_degree_sequence)
in_degrees, in_counts = zip(*in_degree_counts.items())

in_data = pandas.DataFrame.from_dict({"Degrees": in_degrees, "Count": in_counts})
in_data["Direction"] = "in"

plot = in_data.hvplot.bar(x="Degrees", y="Count").opts(
    width=Plot.width,
    height=Plot.height,
    fontsize=Plot.fontsize,
    title="In-Degree Distribution",
    tools=["hover"],
)
Embed(plot=plot, file_name="in_degree_distribution")()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/in_degree_distribution.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>The in-degree represents the number of times a student (the node) was identified by someone else as a friend. Three people weren't identified as friends at all and the most common count was 2, although someone was identified 15 times.</p>
</div>
</div>
<div class="outline-4" id="outline-container-orgb5473b1">
<h4 id="orgb5473b1">Out-Degree Distribution</h4>
<div class="outline-text-4" id="text-orgb5473b1">
<div class="highlight">
<pre><span></span>out_degree_sequence = sorted((degree for node, degree in friendship_graph.out_degree))
out_degree_counts = Counter(out_degree_sequence)
out_degrees, out_counts = zip(*out_degree_counts.items())

out_data = pandas.DataFrame.from_dict({"Degrees": out_degrees, "Count": out_counts})
out_data["Direction"] = "out"
# table = holoviews.Table(, ["Degrees"], ["Count"])
plot = out_data.hvplot.bar(x="Degrees", y="Count").opts(
    width=Plot.width,
    height=Plot.height,
    fontsize=Plot.fontsize,
    title="Out-Degree Distribution",
    tools=["hover"],
)
Embed(plot=plot, file_name="out_degree_distribution")()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/out_degree_distribution.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>The out-degree is the number of other students a student identified as a friend.</p>
</div>
</div>
<div class="outline-4" id="outline-container-orgad7527d">
<h4 id="orgad7527d">In-and-Out Degree</h4>
<div class="outline-text-4" id="text-orgad7527d">
<div class="highlight">
<pre><span></span>in_out = pandas.concat([in_data, 
                        out_data]).sort_values(by="Degrees")
plot = in_out.hvplot.bar(x="Degrees", y="Count", by="Direction").opts(
    width=Plot.width,
    height=Plot.height,
    fontsize=Plot.fontsize,
    title="In and Out-Degree Distribution",
    tools=["hover"],
)
Embed(plot=plot, file_name="in_and_out_degree_distribution")()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/in_and_out_degree_distribution.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>for node in friendship_graph.nodes:
    friendship_graph.nodes[node]["In-Degree"] = friendship_graph.in_degree[node]
    friendship_graph.nodes[node]["Out-Degree"] = friendship_graph.out_degree[node]
</pre></div>
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(friendship_graph, networkx.spring_layout)
plot = plot.opts(
    node_color=dim("gender"), cmap="Set1",
    tools=["hover"],
    width=800,
    height=800,
#    edge_line_color="In-Degree",
    edge_cmap="viridis",
#    edge_line_width=holoviews.dim("In-Degree"),
    title="Friendship Network In-Degrees By Gender",
    xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="friendship_network_in_degree_gender_spring", height_in_pixels=810)()
</pre></div>
<object data="posts/networks/high-school-friendship-networks/friendship_network_in_degree_gender_spring.html" height="810" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org9a6618c">
<h2 id="org9a6618c">The Return</h2>
<div class="outline-text-2" id="text-org9a6618c"></div>
<div class="outline-3" id="outline-container-org74c80ba">
<h3 id="org74c80ba">Citations</h3>
<div class="outline-text-3" id="text-org74c80ba">
<ul class="org-ul">
<li>R. Mastrandrea, J. Fournet, A. Barrat,</li>
</ul>
<p>Contact patterns in a high school: a comparison between data collected using wearable sensors, contact diaries and friendship surveys. PLoS ONE 10(9): e0136497 (2015)</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/network-datasets/">Network Datasets</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/network-datasets/" rel="bookmark"><time class="published dt-published" datetime="2019-03-24T15:47:26-07:00" itemprop="datePublished" title="2019-03-24 15:47">2019-03-24 15:47</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div class="outline-2" id="outline-container-org4cbcb4d">
<h2 id="org4cbcb4d">Data Sources</h2>
<div class="outline-text-2" id="text-org4cbcb4d">
<p>These are sources for data-set repositories that specifically keep network (graph) data.</p>
<ul class="org-ul">
<li><a href="http://snap.stanford.edu/data/">Stanford Large Network Dataset Collection</a></li>
<li><a href="https://networkdata.ics.uci.edu">UCI Network Data Repository</a></li>
<li><a href="http://networkrepository.com/">Network Repository</a> - Large but not as well documented.</li>
<li><a href="http://konect.uni-koblenz.de/">Koblenz Network Collection (Konect)</a></li>
<li><a href="http://www.sociopatterns.org/datasets/">SocioPatterns</a></li>
<li><a href="https://sites.google.com/site/ucinetsoftware/datasets">UCI Net Software</a> - Different from the UCI Repository above</li>
<li><a href="https://github.com/briatte/awesome-network-analysis#datasets">Awesome Network Analysis</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/amazon-related-products/">Amazon Related Products</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/amazon-related-products/" rel="bookmark"><time class="published dt-published" datetime="2019-03-22T22:29:20-07:00" itemprop="datePublished" title="2019-03-22 22:29">2019-03-22 22:29</time> <span class="updated">(updated <time class="dt-updated" datetime="2019-03-23T22:29:20-07:00" itemprop="dateUpdated" title="2019-03-23 22:29">2019-03-23 22:29</time>)</span></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/amazon-related-products/#orga89f001">Beginning</a>
<ul>
<li><a href="posts/networks/amazon-related-products/#org6a025aa">Description</a></li>
<li><a href="posts/networks/amazon-related-products/#orge3ede7d">Setting Up</a></li>
<li><a href="posts/networks/amazon-related-products/#orge5ebf59">Setup The Bokeh</a></li>
<li><a href="posts/networks/amazon-related-products/#orged919b2">Load The Data</a></li>
</ul>
</li>
<li><a href="posts/networks/amazon-related-products/#org151a65d">Middle</a>
<ul>
<li><a href="posts/networks/amazon-related-products/#org75546da">Reducing Our Data Set</a></li>
</ul>
</li>
<li><a href="posts/networks/amazon-related-products/#org012cdde">End</a>
<ul>
<li><a href="posts/networks/amazon-related-products/#org1dbec11">Citation</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orga89f001">
<h2 id="orga89f001">Beginning</h2>
<div class="outline-text-2" id="text-orga89f001"></div>
<div class="outline-3" id="outline-container-org6a025aa">
<h3 id="org6a025aa">Description</h3>
<div class="outline-text-3" id="text-org6a025aa">
<p>This is an examination of data from the <a href="http://snap.stanford.edu/data/">Stanford Large Network Dataset Collection</a>. There are two parts to the dataset:</p>
<ul class="org-ul">
<li><a href="http://snap.stanford.edu/data/amazon0601.html">Amazon Product Co-Purchasing Network, June 1, 2003</a></li>
<li><a href="http://snap.stanford.edu/data/amazon-meta.html">Amazon Co-Purchasing Network Metadata</a></li>
</ul>
<p>From the site's description:</p>
<blockquote>
<p>Network was collected by crawling Amazon website. It is based on Customers Who Bought This Item Also Bought feature of the Amazon website. If a product i is frequently co-purchased with product j, the graph contains a directed edge from i to j.</p>
<p>The data was collected in June 01 2003.</p>
</blockquote>
</div>
</div>
<div class="outline-3" id="outline-container-orge3ede7d">
<h3 id="orge3ede7d">Setting Up</h3>
<div class="outline-text-3" id="text-orge3ede7d"></div>
<div class="outline-4" id="outline-container-org8adccee">
<h4 id="org8adccee">Imports</h4>
<div class="outline-text-4" id="text-org8adccee"></div>
<div class="outline-5" id="outline-container-orgf111711">
<h5 id="orgf111711">From Python</h5>
<div class="outline-text-5" id="text-orgf111711">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-orgda5dcc3">
<h5 id="orgda5dcc3">From PyPi</h5>
<div class="outline-text-5" id="text-orgda5dcc3">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">HoverTool</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span>
<span class="kn">from</span> <span class="nn">holoviews.operation.datashader</span> <span class="kn">import</span> <span class="n">datashade</span><span class="p">,</span> <span class="n">bundle_graph</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">modin.pandas</span> <span class="kn">as</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">networkx</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pandas_og</span>
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org2eaedc0">
<h5 id="org2eaedc0">My Stuff</h5>
<div class="outline-text-5" id="text-org2eaedc0">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graeae.timers</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">graeae.visualization</span> <span class="kn">import</span> <span class="n">EmbedHoloview</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org9b6e6ae">
<h4 id="org9b6e6ae">Load the Dotenv</h4>
<div class="outline-text-4" id="text-org9b6e6ae">
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">".env"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orge03d51b">
<h4 id="orge03d51b">Build the Timer</h4>
<div class="outline-text-4" id="text-orge03d51b">
<div class="highlight">
<pre><span></span><span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orge5ebf59">
<h3 id="orge5ebf59">Setup The Bokeh</h3>
<div class="outline-text-3" id="text-orge5ebf59">
<div class="highlight">
<pre><span></span><span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/networks/amazon-related-products/"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedHoloview</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orged919b2">
<h3 id="orged919b2">Load The Data</h3>
<div class="outline-text-3" id="text-orged919b2">
<p>Normally I'd load this stuff in pandas, but let's take a look at the data first.</p>
<div class="highlight">
<pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"AMAZON_DATA"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">data_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="k">with</span> <span class="n">data_path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
</pre></div>
<pre class="example">
# Directed graph (each unordered pair of nodes is saved once): Amazon0601.txt 
# Amazon product co-purchaisng network from June 01 2003
# Nodes: 403394 Edges: 3387388
# FromNodeId    ToNodeId
0       1
0       2

</pre>
<p>So it isn't a CSV, it's just a lot of pairs of nodes (edge definitions) separated by tabs (a Tab-Separated-Values file). So I guess we can load it with pandas. What about the meta-data?</p>
<div class="highlight">
<pre><span></span><span class="n">metadata_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"AMAZON_METADATA"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="k">with</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
</pre></div>
<pre class="example">
# Full information about Amazon Share the Love products
Total items: 548552

Id:   0
ASIN: 0771044445
  discontinued product

Id:   1
ASIN: 0827229534
  title: Patterns of Preaching: A Sermon Sampler
</pre>
<p>So, it looks like there might be some information here to make it more human-readable, which would be useful, but there are a lot of points, so I don't know how useful it would be, but it turns out NetworkX will <a href="https://networkx.github.io/documentation/stable/reference/generated/networkx.convert_matrix.from_pandas_edgelist.html">create a graph from a pandas dataframe edge-list</a> so we might as well make use of everything at first and throw it away later if it's not useful.</p>
</div>
<div class="outline-4" id="outline-container-org7cfb4cc">
<h4 id="org7cfb4cc">Load the TSV</h4>
<div class="outline-text-4" id="text-org7cfb4cc"></div>
<div class="outline-5" id="outline-container-orgba26299">
<h5 id="orgba26299">Take One (with modin)</h5>
<div class="outline-text-5" id="text-orgba26299">
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> 
                            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">"Source"</span><span class="p">,</span> <span class="s2">"Target"</span><span class="p">],</span> 
                            <span class="n">skiprows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
<pre class="example">
Started: 2019-03-23 15:18:59.565073
Ended: 2019-03-23 15:18:59.751270
Elapsed: 0:00:00.186197
(3387392, 2)

</pre>
<p>If we look at the header we can see that there should be 3,387,388 edges, not 3,387,392â€¦ it looks like we picked up four extras.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
<pre class="example">
                                              Source    Target
0  # Directed graph (each unordered pair of nodes...       NaN
1  # Amazon product co-purchaisng network from Ju...       NaN
2                     # Nodes: 403394 Edges: 3387388       NaN
3                                       # FromNodeId  ToNodeId
4                                                  0         1

</pre>
<p>It looks lke the <code>skiprows</code> argument doesn't worlk like I thought it does. According to the documentation:</p>
<blockquote>
<p><b>skiprows</b> : <i>list-like, int or callable, optional</i> Line numbers to skip (0-indexed) or number of lines to skip (int) at the start of the file.</p>
</blockquote>
<p>So I don't know why that didn't work, but it didn'tâ€¦ oh, well.</p>
<div class="highlight">
<pre><span></span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3387388</span>
</pre></div>
<p>We have the edges (and it was fairly painless), now how do we add the labels? Since we have edge-pairs it doesn't really make sense, now that I think about it. Maybe later it will make sense to re-map the ID numbers to titles.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">id_graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">convert_matrix</span><span class="o">.</span><span class="n">from_pandas_edgelist</span><span class="p">(</span>
        <span class="n">edges</span><span class="p">,</span> <span class="s2">"Source"</span><span class="p">,</span> <span class="s2">"Target"</span><span class="p">,</span> 
        <span class="n">create_using</span><span class="o">=</span><span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>
</pre></div>
<pre class="example">
Started: 2019-03-23 15:30:07.750906
Ended: 2019-03-23 15:31:08.065932
Elapsed: 0:01:00.315026

</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">id_graph</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
</pre></div>
<pre class="example">
464045

</pre>
<p>So, we have a problem here since, according to the header, there should be 403,394 nodes, not 464,045.</p>
<div class="highlight">
<pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">Target</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>
</pre></div>
<pre class="example">
464045

</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
<pre class="example">
  Source Target
4      0      1
5      0      2
6      0      3
7      0      4
8      0      5
         Source  Target
3387387  403392  121379
3387388  403392  190663
3387389  403393  318438
3387390  403393  326962
3387391  403393  403383
</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
<pre class="example">
object

</pre>
<p>I think that that initial problem with skipping rows might have messed things up a little.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">edges</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"Source"</span><span class="p">]</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">edges</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"Target"</span><span class="p">]</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">Target</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">Target</span><span class="o">.</span><span class="n">unique</span><span class="p">())))</span>
</pre></div>
<p>That produced an error:</p>
<pre class="example">
Exception: Internal Error. Please email bug_reports@modin.org with the traceback and command that caused this error.
</pre>
<p>Maybe <code>modin</code> is still not ready for prime time.</p>
</div>
</div>
<div class="outline-5" id="outline-container-orgd7b1449">
<h5 id="orgd7b1449">Take Two (with pandas)</h5>
<div class="outline-text-5" id="text-orgd7b1449">
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">pandas_og</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> 
                               <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">"source"</span><span class="p">,</span> <span class="s2">"target"</span><span class="p">],</span> 
                               <span class="n">skiprows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3387388</span>
</pre></div>
<pre class="example">
Started: 2019-03-24 13:59:14.697145
Ended: 2019-03-24 13:59:15.142454
Elapsed: 0:00:00.445309

</pre>
<p>So that fixes the <code>skiprows</code> problem, first off.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">id_graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">convert_matrix</span><span class="o">.</span><span class="n">from_pandas_edgelist</span><span class="p">(</span>
        <span class="n">edges</span><span class="p">,</span> <span class="s2">"source"</span><span class="p">,</span> <span class="s2">"target"</span><span class="p">,</span> 
        <span class="n">create_using</span><span class="o">=</span><span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>
</pre></div>
<pre class="example">
Started: 2019-03-24 13:59:19.883328
Ended: 2019-03-24 13:59:26.128711
Elapsed: 0:00:06.245383

</pre>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">id_graph</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">id_graph</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="mi">403394</span>
</pre></div>
<pre class="example">
403394

</pre>
<p>So, using pandas fixes both our problemsâ€¦</p>
</div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org151a65d">
<h2 id="org151a65d">Middle</h2>
<div class="outline-text-2" id="text-org151a65d"></div>
<div class="outline-3" id="outline-container-org75546da">
<h3 id="org75546da">Reducing Our Data Set</h3>
<div class="outline-text-3" id="text-org75546da">
<p>It turns out that this graph is just too big - it takes too long to create and the browser won't load it even if you do build it. We'll need to reduce it somehow.</p>
</div>
<div class="outline-4" id="outline-container-orgc839c68">
<h4 id="orgc839c68">Load the Metadata</h4>
<div class="outline-text-4" id="text-orgc839c68">
<p>I didn't show enough lines to really see what a metadata entry looks like. Here's the full entry for the node with ID 1.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
</pre></div>
<pre class="example">
Id:   1
ASIN: 0827229534
  title: Patterns of Preaching: A Sermon Sampler
  group: Book
  salesrank: 396585
  similar: 5  0804215715  156101074X  0687023955  0687074231  082721619X
  categories: 2
   |Books[283155]|Subjects[1000]|Religion & Spirituality[22]|Christianity[12290]|Clergy[12360]|Preaching[12368]
   |Books[283155]|Subjects[1000]|Religion & Spirituality[22]|Christianity[12290]|Clergy[12360]|Sermons[12370]
  reviews: total: 2  downloaded: 2  avg rating: 5
    2000-7-28  cutomer: A2JW67OY8U6HHK  rating: 5  votes:  10  helpful:   9
    2003-12-14  cutomer: A2VE83MZF98ITY  rating: 5  votes:   6  helpful:   5
</pre>
<p>So we may be able to cut it down using groups, categories, or maybe even the "cutomer" ratings.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="s2">"group:"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">groups</span><span class="p">))</span>
</pre></div>
<pre class="example">
{'CE', 'Toy', 'Book', 'DVD', 'Games', 'Product', 'Sports', 'Remediation', 'Software', 'Video', 'Music'}

</pre>
<div class="highlight">
<pre><span></span><span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"{}: {:,}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
</pre></div>
<pre class="example">
Book: 393,561
Music: 103,144
DVD: 19,828
Video: 26,131
Toy: 8
Games: 1
Software: 5
Product: 1
CE: 4
Sports: 1
Remediation: 1
</pre>
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span><span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">"Group"</span><span class="p">,</span> <span class="s2">"@Group"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Count"</span><span class="p">,</span> <span class="s2">"@Count{0,0}"</span><span class="p">),</span>
<span class="p">],</span>
                  <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"Count"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
                  <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Bars</span><span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                     <span class="n">holoviews</span><span class="o">.</span><span class="n">Dimension</span><span class="p">(</span><span class="s2">"Group"</span><span class="p">),</span> <span class="s2">"Count"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                         <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                         <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                         <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
                         <span class="n">title</span><span class="o">=</span><span class="s2">"Product Groups"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"product_groups"</span><span class="p">)()</span>
</pre></div>
<object data="posts/networks/amazon-related-products/product_groups.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It looks like just using the books alone would be too large, and maybe the music as well. I think I'll have to do a little more exploration.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="s2">"|Book"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">])</span>
<span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">categories</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"{}: {:,}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
</pre></div>
<pre class="example">
|Books[283155]|Subjects[1000]|Business & Investing[3]|General[2612]: 18,437
|Books[283155]|Subjects[1000]|Reference[21]|General[408268]: 13,703
|Books[283155]|Subjects[1000]|Biographies & Memoirs[2]|General[2375]: 12,243
|Books[283155]|Subjects[1000]|Nonfiction[53]|Social Sciences[11232]|Sociology[11288]|General[11289]: 11,779
|Books[283155]|Subjects[1000]|Literature & Fiction[17]|General[10125]|Contemporary[10129]: 11,448
|Books[283155]|Subjects[1000]|Children's Books[4]|Ages 4-8[2785]|General[170062]: 11,439
|Books[283155]|Subjects[1000]|Nonfiction[53]|Education[10605]|General[10635]: 8,762
|Books[283155]|Subjects[1000]|Computers & Internet[5]|General[657762]: 8,661
|Books[283155]|Subjects[1000]|Health, Mind & Body[10]|Psychology & Counseling[11119]|General[11175]: 8,064
|Books[283155]|Subjects[1000]|Children's Books[4]|Ages 9-12[2786]|General[170063]: 8,008
</pre>
<p>It turns out there's 11,463 categories. Maybe too much to look at. What if we only look at the third token?</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"|"</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="s2">"|Book"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">])</span>
<span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">categories</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"{}: {:,}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
</pre></div>
<pre class="example">
Children's Books[4]: 134,299
Nonfiction[53]: 106,977
Religion & Spirituality[22]: 93,690
Literature & Fiction[17]: 84,721
Business & Investing[3]: 74,125
Professional & Technical[173507]: 67,693
Computers & Internet[5]: 66,742
Health, Mind & Body[10]: 66,380
Reference[21]: 50,115
History[9]: 48,131
</pre>
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span><span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">"Subject"</span><span class="p">,</span> <span class="s2">"@Subject"</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"Count"</span><span class="p">,</span> <span class="s2">"@Count{0,0}"</span><span class="p">),</span>
<span class="p">],</span>
                  <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s2">"Count"</span><span class="p">:</span> <span class="s2">"numeral"</span><span class="p">},</span>
                  <span class="n">mode</span><span class="o">=</span><span class="s2">"vline"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Bars</span><span class="p">(</span><span class="n">categories</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                     <span class="n">holoviews</span><span class="o">.</span><span class="n">Dimension</span><span class="p">(</span><span class="s2">"Subject"</span><span class="p">),</span> <span class="s2">"Count"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                         <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                         <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                         <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
                         <span class="n">xrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="s2">"Book Subjects"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"book_subjects"</span><span class="p">)()</span>
</pre></div>
<object data="posts/networks/amazon-related-products/book_subjects.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>One problem I just realized is that if I try to use a single group or category and it turns out that the edges cross-over to another group or category then I'll be missing nodes that I needâ€¦ This is turning out to be more than I want to deal with at this point - since I'm just trying to figure out how to make a visualizationâ€¦</p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org012cdde">
<h2 id="org012cdde">End</h2>
<div class="outline-text-2" id="text-org012cdde"></div>
<div class="outline-3" id="outline-container-org1dbec11">
<h3 id="org1dbec11">Citation</h3>
<div class="outline-text-3" id="text-org1dbec11">
<ul class="org-ul">
<li>J. Leskovec, L. Adamic and B. Adamic. The Dynamics of Viral Marketing. ACM Transactions on the Web (ACM TWEB), 1(1), 2007.</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/">Walking Through the PyViz Network Graphs Examples</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/" rel="bookmark"><time class="published dt-published" datetime="2019-03-20T14:55:24-07:00" itemprop="datePublished" title="2019-03-20 14:55">2019-03-20 14:55</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org4e7b4c6">Beginning</a>
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org9866f9e">Imports</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#orgc41a36d">Setup</a></li>
</ul>
</li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org4cdade4">Middle</a>
<ul>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org05803bb">A Simple Graph</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#orge764020">Re-Using the Nodes and Edges</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#orgbb2a2f0">Explicit Paths</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org75edbc7">Hover</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org4e67228">More Information</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org0f29864">Edge Weights and Colors</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org2f932fa">Using A Dataset</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org1928918">Using NetworkX</a></li>
<li><a href="posts/libraries/walking-through-the-pyviz-network-graphs-examples/#org643d4b6">Facebook</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org4e7b4c6">
<h2 id="org4e7b4c6">Beginning</h2>
<div class="outline-text-2" id="text-org4e7b4c6">
<p>This is a walk-through of the <a href="http://pyviz.org/tutorial/06_Network_Graphs.html">pyviz networks graphs examples</a> so I can check that I can replicate them.</p>
</div>
<div class="outline-3" id="outline-container-org9866f9e">
<h3 id="org9866f9e">Imports</h3>
<div class="outline-text-3" id="text-org9866f9e"></div>
<div class="outline-4" id="outline-container-org9e25611">
<h4 id="org9e25611">Python</h4>
<div class="outline-text-4" id="text-org9e25611">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org775a11e">
<h4 id="org775a11e">PyPi</h4>
<div class="outline-text-4" id="text-org775a11e">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">HoverTool</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">holoviews</span> <span class="kn">import</span> <span class="n">opts</span><span class="p">,</span> <span class="n">dim</span>
<span class="kn">from</span> <span class="nn">holoviews.operation.datashader</span> <span class="kn">import</span> <span class="n">bundle_graph</span>

<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">networkx</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgd8be741">
<h4 id="orgd8be741">My Stuff</h4>
<div class="outline-text-4" id="text-orgd8be741">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graeae.visualization</span> <span class="kn">import</span> <span class="n">EmbedBokeh</span>
<span class="kn">from</span> <span class="nn">graeae.tables</span> <span class="kn">import</span> <span class="n">CountPercentage</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc41a36d">
<h3 id="orgc41a36d">Setup</h3>
<div class="outline-text-3" id="text-orgc41a36d"></div>
<div class="outline-4" id="outline-container-org7d36a21">
<h4 id="org7d36a21">The Plotting</h4>
<div class="outline-text-4" id="text-org7d36a21">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Plot</span><span class="p">:</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">800</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">800</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">)</span>
<span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">defaults</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">EdgePaths</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">),</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgaa7f1b2">
<h4 id="orgaa7f1b2">The Bokeh Embedder</h4>
<div class="outline-text-4" id="text-orgaa7f1b2">
<div class="highlight">
<pre><span></span><span class="n">OUTPUT_FOLDER</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/libraries/"</span>
                     <span class="s2">"walking-through-the-pyviz-network-graphs-examples/"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedBokeh</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="n">OUTPUT_FOLDER</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org4cdade4">
<h2 id="org4cdade4">Middle</h2>
<div class="outline-text-2" id="text-org4cdade4"></div>
<div class="outline-3" id="outline-container-org05803bb">
<h3 id="org05803bb">A Simple Graph</h3>
<div class="outline-text-3" id="text-org05803bb">
<p>You can define a graph by giving two arrays which together represent pairs of nodes connected by an edge (they call the first array the nodes and the second the edges). As an example we can create a graph where all the nodes (other than the first node) have an edge to the first node (Node 0 in this case).</p>
<div class="highlight">
<pre><span></span><span class="n">NODE_COUNT</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">NODES</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NODE_COUNT</span><span class="p">)</span>
<span class="n">EDGES</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">NODE_COUNT</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Graph</span><span class="p">(((</span><span class="n">EDGES</span><span class="p">,</span> <span class="n">NODES</span><span class="p">),))</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"We're All Connected to Five"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"first_graph"</span><span class="p">)()</span>
</pre></div>
<script id="2b9cdb9c-fb7d-4852-afb8-ff2d79cddff1" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/first_graph.js">
</script>
<p>The arguments to the <code>Graph</code> looks odd, and it's not obvious from the docstring why you need to pass in a tuple of tuples, but you do.</p>
<p>If you hover over the nodes you'll see that they all connect to the one with <code>index</code> 5, the value we gave to the edges array.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orge764020">
<h3 id="orge764020">Re-Using the Nodes and Edges</h3>
<div class="outline-text-3" id="text-orge764020">
<p>The <code>Graph</code> keeps the <code>Nodes</code> and <code>EdgePaths</code> as separate objects that are themselves plotable.</p>
<div class="highlight">
<pre><span></span><span class="n">dimensions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="o">+</span> <span class="n">graph</span><span class="o">.</span><span class="n">edgepaths</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Nodes and Edges"</span><span class="p">,</span> 
                                            <span class="n">fontsize</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontsize</span><span class="p">,</span> 
                                            <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"nodes_and_edges"</span><span class="p">)()</span>
</pre></div>
<script id="08fa283a-f8ba-4f2f-83be-5ca28defc8a6" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/nodes_and_edges.js">
</script>
<p>Note that changing the title worked (although it lost the font-size unless I explicitly passed it in) but changing the plot size didn't, even when I tried the <code>redim</code> method instead. This might be another one of those problematic HoloViews things that I need to figure out.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgbb2a2f0">
<h3 id="orgbb2a2f0">Explicit Paths</h3>
<div class="outline-text-3" id="text-orgbb2a2f0">
<p>The next example is supposedly about suppyling explicit paths instead of letting HoloViews create them but there's so much unexplained that I'm not going to bother trying to understand it for now.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">bezier</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)):</span>
    <span class="k">return</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">steps</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">start</span> 
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">steps</span><span class="p">)</span> <span class="o">*</span> <span class="n">steps</span> <span class="o">*</span> <span class="n">control</span> 
            <span class="o">+</span> <span class="n">steps</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">end</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">node_index</span> <span class="ow">in</span> <span class="n">NODES</span><span class="p">:</span>
    <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">node_index</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">node_index</span><span class="p">]</span>
    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">bezier</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ex</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">bezier</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ey</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]))</span>

<span class="n">padding</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
<span class="n">bezier_graph</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Graph</span><span class="p">(((</span><span class="n">EDGES</span><span class="p">,</span> <span class="n">NODES</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">NODES</span><span class="p">),</span> <span class="n">paths</span><span class="p">))</span><span class="o">.</span><span class="n">redim</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">**</span><span class="n">padding</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">bezier_graph</span><span class="p">,</span> <span class="s2">"bezier_graph"</span><span class="p">)()</span>
</pre></div>
<script id="39076e44-df29-4c9c-b694-a6f0e35ba0f3" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/bezier_graph.js">
</script></div>
</div>
<div class="outline-3" id="outline-container-org75edbc7">
<h3 id="org75edbc7">Hover</h3>
<div class="outline-text-3" id="text-org75edbc7">
<p>By default the hover tool will give you information about the Node you mouse-over, but you can set it to give you the nodes connected to an edge instead.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">inspection_policy</span><span class="o">=</span><span class="s2">"edges"</span><span class="p">,</span> 
                      <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> 
                      <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> 
                      <span class="n">title</span><span class="o">=</span><span class="s2">"Edge Hover"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"edge_hove_tool"</span><span class="p">)()</span>
</pre></div>
<script id="a991c8b1-f3bc-44bc-9c44-6978668c0c12" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/edge_hove_tool.js">
</script>
<p>There were several things to note here:</p>
<ul class="org-ul">
<li>Although I wasn't able to change the size when I plotted the nodes and edges side by side, this plot came out at the small size I had tried to use until I set it myself</li>
<li>The hover is now triggered by hovering over the edges</li>
<li>Although this is an undirected graph, they define the nodes as 'start' and 'end'</li>
</ul>
<p>You can change the colors for hover activation as well.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">node_hover_fill_color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">,</span>
                      <span class="n">edge_hover_line_color</span><span class="o">=</span><span class="s2">"pink"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"colored_hover"</span><span class="p">)()</span>
</pre></div>
<script id="1898ed6f-c4f6-4e5d-ba9f-6c9bf31cb3e9" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/colored_hover.js">
</script></div>
</div>
<div class="outline-3" id="outline-container-org4e67228">
<h3 id="org4e67228">More Information</h3>
<div class="outline-text-3" id="text-org4e67228">
<p>If we create the <code>Nodes</code> ourselves we can add labels to them.</p>
<p>First get the values that the <code>Graph</code> created for the <i>x</i> and <i>y</i> coordinates of the nodes.</p>
<div class="highlight">
<pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
<p>There's no explanation for the method that I could find, other than the docstring, so I'll just take that on faith. I don't know how you would get the values yourself without first creating a <code>Graph</code> then taking the values and creating a new one, which doesn't seem right.</p>
<p>Now create the labels in the same order as the nodes that they are labeling.</p>
<div class="highlight">
<pre><span></span><span class="n">node_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Barbara"</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"Gloria"</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"Barbara"</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
</pre></div>
<p>Now create the nodes and the new graph. Note that the first argument is a tuple and the nodes gets passed in as that mystery argument that I was wondering about earlier.</p>
<div class="highlight">
<pre><span></span><span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">(</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"@Name"</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Nodes</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">NODES</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">),</span> <span class="n">vdims</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Graph</span><span class="p">(((</span><span class="n">EDGES</span><span class="p">,</span> <span class="n">NODES</span><span class="p">),</span> <span class="n">nodes</span><span class="p">))</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span> 
    <span class="n">title</span><span class="o">=</span><span class="s2">"Labeled Nodes"</span><span class="p">,</span> 
    <span class="n">node_color</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">"Set1"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"named_nodes"</span><span class="p">)()</span>
</pre></div>
<script id="b08b52fb-88c9-453e-950f-c71b2f1f6cd4" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/named_nodes.js">
</script></div>
</div>
<div class="outline-3" id="outline-container-org0f29864">
<h3 id="org0f29864">Edge Weights and Colors</h3>
<div class="outline-text-3" id="text-org0f29864">
<p>We can also change the thickness and color of the edges based on their weights. First we need to create the edge-weights.</p>
<div class="highlight">
<pre><span></span><span class="n">edge_weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">EDGES</span><span class="p">))</span>
</pre></div>
<p><code>numpy.random.rand</code> creates an array of numbers ranging from 0 to 1 (but not 1).</p>
<p>Once again we have to create a new graph, this time passing in the edge-weights (and I'll add the nodes too).</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Graph</span><span class="p">(((</span><span class="n">EDGES</span><span class="p">,</span> <span class="n">NODES</span><span class="p">,</span> <span class="n">edge_weights</span><span class="p">),</span> <span class="n">nodes</span><span class="p">),</span> <span class="n">vdims</span><span class="o">=</span><span class="s2">"Weight"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Edge Weights"</span><span class="p">,</span>
    <span class="n">inspection_policy</span><span class="o">=</span><span class="s2">"edges"</span><span class="p">,</span>
    <span class="n">node_color</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">"Set1"</span><span class="p">,</span>
    <span class="n">edge_color</span><span class="o">=</span><span class="s2">"Weight"</span><span class="p">,</span> 
    <span class="n">edge_cmap</span><span class="o">=</span><span class="s2">"viridis"</span><span class="p">,</span> 
    <span class="n">edge_line_width</span><span class="o">=</span><span class="n">holoviews</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
        <span class="p">)</span>
<span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"edge_weights"</span><span class="p">)()</span>
</pre></div>
<script id="977d191b-89fc-4eef-90db-4aee89b36b89" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/edge_weights.js">
</script>
<p>Note that the edge-hover doesn't use our node-labels, which is sort of disappointing. I wonder if there's a way to fix that.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org2f932fa">
<h3 id="org2f932fa">Using A Dataset</h3>
<div class="outline-text-3" id="text-org2f932fa">
<p>I previously created the Nodes using the values from a Graph that had the Nodes, which seemed kind of circular, it turns out that the way to do it is to pass in a <code>Dataset</code> with the labels.</p>
<div class="highlight">
<pre><span></span><span class="n">node_labels</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Anne Barbara Carol Donna Eleanor "</span>
               <span class="s2">"Francis Gloria Helen Iris Janet"</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">node_stuff</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">vdims</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="p">(</span>
        <span class="p">(</span><span class="n">EDGES</span><span class="p">,</span> <span class="n">NODES</span><span class="p">,</span> <span class="n">edge_weights</span><span class="p">),</span> 
        <span class="n">node_stuff</span><span class="p">),</span> 
    <span class="n">vdims</span><span class="o">=</span><span class="s2">"Weight"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">opts</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">"Nodes From a Dataset"</span><span class="p">,</span>
        <span class="n">node_color</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">"Set1"</span><span class="p">,</span>
        <span class="n">edge_color</span><span class="o">=</span><span class="s2">"Weight"</span><span class="p">,</span> 
        <span class="n">edge_cmap</span><span class="o">=</span><span class="s2">"plasma"</span><span class="p">,</span>
        <span class="n">edge_line_width</span><span class="o">=</span><span class="n">holoviews</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="s2">"Weight"</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">hover</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"dataset_node_labels"</span><span class="p">)()</span>
</pre></div>
<script id="5aba0f29-e1a4-4420-938a-770a2c068059" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/dataset_node_labels.js">
</script></div>
</div>
<div class="outline-3" id="outline-container-org1928918">
<h3 id="org1928918">Using NetworkX</h3>
<div class="outline-text-3" id="text-org1928918"></div>
<div class="outline-4" id="outline-container-org6459876">
<h4 id="org6459876">Karate Club</h4>
<div class="outline-text-4" id="text-org6459876">
<p>First we'll load in the included karate club graph that comes with networkx. This was a graph created from the members of a karate club that eventually splintered in two. The nodes are members and an edge between two nodes meant that they socialized outside of the club.</p>
<div class="highlight">
<pre><span></span><span class="n">karate_graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">karate_club_graph</span><span class="p">()</span>
</pre></div>
<p>This isn't explained in the example, but each node in the graph is a dict that has a some information set on it that you can reference.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">karate_graph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<pre class="example">
{'club': 'Mr. Hi'}

</pre>
<p>We're going to re-use these options again so I'll store them in a variable.</p>
<div class="highlight">
<pre><span></span><span class="n">karate_options</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"NetworkX Karate Club"</span><span class="p">,</span>
                            <span class="n">node_color</span><span class="o">=</span><span class="n">holoviews</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="s2">"club"</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"Set1"</span><span class="p">,</span> 
                            <span class="n">xlabel</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
</pre></div>
<p>Now we can create the HoloViews graph from the karate club graph.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_networkx</span><span class="p">(</span><span class="n">karate_graph</span><span class="p">,</span> 
                                      <span class="n">networkx</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
                                          <span class="n">karate_options</span><span class="p">,</span>
                                      <span class="p">)</span>

<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"karate_club"</span><span class="p">)()</span>
</pre></div>
<script id="e5a4d0ac-cd15-41f4-b284-b3af3a0f467c" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/karate_club.js">
</script></div>
</div>
<div class="outline-4" id="outline-container-orgc27ab4a">
<h4 id="orgc27ab4a">Animating the Layout</h4>
<div class="outline-text-4" id="text-orgc27ab4a">
<div class="highlight">
<pre><span></span>numpy.random.seed(0)

def get_graph(iteration: int) -&gt; holoviews.Graph:
    """Creates a graph laid out using Fruchterman-Reingold force-direction

    Args:
     iteration: maximum number of iterations to run the algorithm
    """
    return holoviews.Graph.from_networkx(karate_graph,
                                         networkx.spring_layout, 
                                         iterations=iteration)

holo_map = holoviews.HoloMap({iteration: get_graph(iteration).opts(karate_options)
                              for iteration in range(0, 55, 5)},
                             kdims="Iterations")


filename = "animated_spring.html"
path = OUTPUT_FOLDER.joinpath(filename)
holoviews.save(holo_map, path)

print('''#+begin_export html
&lt;object type="text/html" data="{}" style="width:100%" height={}&gt;
  &lt;p&gt;Failed to load&lt;/p&gt;
&lt;/object&gt;
#+end_export'''.format(filename, Plot.height
))
</pre></div>
<object data="posts/libraries/walking-through-the-pyviz-network-graphs-examples/animated_spring.html" height="800" style="width:100%" type="text/html">
<p>Failed to load</p>
</object>
<p>This is the first time I managed to get the holoviews widgets to work inside a post - I'm going to need to update how I do this.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org643d4b6">
<h3 id="org643d4b6">Facebook</h3>
<div class="outline-text-3" id="text-org643d4b6">
<p>In this section we'll work with a graph of Facebook users who have been associated with a 'circle' (of friends).</p>
<p>Turn off the x and y axes.</p>
<div class="highlight">
<pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">opts</span><span class="o">.</span><span class="n">defaults</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">),</span> <span class="n">opts</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">))</span>
</pre></div>
<p>Read in the dataframes for the edges and nodes.</p>
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">".env"</span><span class="p">)</span>
<span class="n">edge_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"FACEBOOK_EDGES"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="n">node_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"FACEBOOK_NODES"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">edge_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">node_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>

<span class="n">edge_data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">edge_path</span><span class="p">)</span>
<span class="n">node_data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">node_path</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">edge_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">node_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">node_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<p>So you can see that the <code>circle</code> is part of the node data.</p>
<div class="highlight">
<pre><span></span><span class="n">circle_counts</span> <span class="o">=</span> <span class="n">CountPercentage</span><span class="p">(</span><span class="n">node_data</span><span class="o">.</span><span class="n">circle</span><span class="p">)</span>
<span class="n">circle_counts</span><span class="p">()</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Value</th>
<th class="org-right" scope="col">Count</th>
<th class="org-right" scope="col">Percentage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">circle15</td>
<td class="org-right">119</td>
<td class="org-right">35.74</td>
</tr>
<tr>
<td class="org-left">None</td>
<td class="org-right">56</td>
<td class="org-right">16.82</td>
</tr>
<tr>
<td class="org-left">circle16</td>
<td class="org-right">31</td>
<td class="org-right">9.31</td>
</tr>
<tr>
<td class="org-left">circle11</td>
<td class="org-right">29</td>
<td class="org-right">8.71</td>
</tr>
<tr>
<td class="org-left">circle0</td>
<td class="org-right">15</td>
<td class="org-right">4.50</td>
</tr>
<tr>
<td class="org-left">circle19</td>
<td class="org-right">13</td>
<td class="org-right">3.90</td>
</tr>
<tr>
<td class="org-left">circle4</td>
<td class="org-right">10</td>
<td class="org-right">3.00</td>
</tr>
<tr>
<td class="org-left">circle2</td>
<td class="org-right">9</td>
<td class="org-right">2.70</td>
</tr>
<tr>
<td class="org-left">circle6</td>
<td class="org-right">8</td>
<td class="org-right">2.40</td>
</tr>
<tr>
<td class="org-left">circle17</td>
<td class="org-right">8</td>
<td class="org-right">2.40</td>
</tr>
<tr>
<td class="org-left">circle9</td>
<td class="org-right">7</td>
<td class="org-right">2.10</td>
</tr>
<tr>
<td class="org-left">circle20</td>
<td class="org-right">6</td>
<td class="org-right">1.80</td>
</tr>
<tr>
<td class="org-left">circle13</td>
<td class="org-right">5</td>
<td class="org-right">1.50</td>
</tr>
<tr>
<td class="org-left">circle10</td>
<td class="org-right">4</td>
<td class="org-right">1.20</td>
</tr>
<tr>
<td class="org-left">circle23</td>
<td class="org-right">3</td>
<td class="org-right">0.90</td>
</tr>
<tr>
<td class="org-left">circle3</td>
<td class="org-right">3</td>
<td class="org-right">0.90</td>
</tr>
<tr>
<td class="org-left">circle14</td>
<td class="org-right">2</td>
<td class="org-right">0.60</td>
</tr>
<tr>
<td class="org-left">circle7</td>
<td class="org-right">2</td>
<td class="org-right">0.60</td>
</tr>
<tr>
<td class="org-left">circle12</td>
<td class="org-right">1</td>
<td class="org-right">0.30</td>
</tr>
<tr>
<td class="org-left">circle18</td>
<td class="org-right">1</td>
<td class="org-right">0.30</td>
</tr>
<tr>
<td class="org-left">circle22</td>
<td class="org-right">1</td>
<td class="org-right">0.30</td>
</tr>
</tbody>
</table>
<p>For some reason the second most circle value is <code>None</code>.</p>
<p>Set up the colors.</p>
<div class="highlight">
<pre><span></span><span class="n">black</span> <span class="o">=</span> <span class="s2">"#000000"</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">black</span><span class="p">]</span> <span class="o">+</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="s2">"Category20"</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</pre></div>
<p>Setup the nodes and the graph.</p>
<div class="highlight">
<pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="n">node_data</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Graph</span><span class="p">((</span><span class="n">edge_data</span><span class="p">,</span> <span class="n">nodes</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Facebook Circles"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
    <span class="n">node_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">edge_line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">node_line_color</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">,</span>
    <span class="n">node_color</span><span class="o">=</span><span class="s2">"circle"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">Embed</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s2">"facebook_circles"</span><span class="p">)()</span>
</pre></div>
<script id="64f0f3fe-e901-4b28-909d-7724e34abb56" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/facebook_circles.js">
</script>
<p>It's interesting that the most populus circle <code>circle15</code> is the first circle after we sort, is the sort working by value counts? I tried setting the second color to red, but this got assigned to <code>circle0</code> which isn't the second most common, so apparently not, but then why did it work for <code>circle15</code>?</p>
</div>
<div class="outline-4" id="outline-container-org915a68b">
<h4 id="org915a68b">Bundling</h4>
<div class="outline-text-4" id="text-org915a68b">
<div class="highlight">
<pre><span></span><span class="n">bundled</span> <span class="o">=</span> <span class="n">bundle_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Bundled Facebook Circles"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">bundled</span><span class="p">,</span> <span class="s2">"bundled_graph"</span><span class="p">)()</span>
</pre></div>
<script id="44aab32c-2fc0-405c-8cda-b37c4b4f2476" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/bundled_graph.js">
</script>
<p>This view helps to eliminate some of the noise from the edges, but I wonder if it does that at the expense of disproportionately diminishing the presence of <code>circle15</code> (the black circles).</p>
</div>
</div>
<div class="outline-4" id="outline-container-org635752e">
<h4 id="org635752e">Circles</h4>
<div class="outline-text-4" id="text-org635752e">
<p>We can select circles from the graph instead of showing all of them.</p>
<div class="highlight">
<pre><span></span><span class="n">circles</span> <span class="o">=</span> <span class="n">circle_counts</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">Value</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">circle_plots</span> <span class="o">=</span> <span class="p">[</span><span class="n">bundled</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">circle</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">selection_mode</span><span class="o">=</span><span class="s2">"nodes"</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">circles</span><span class="p">]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">circle_plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">next_plot</span> <span class="ow">in</span> <span class="n">circle_plots</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">plot</span> <span class="o">*=</span> <span class="n">next_plot</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Top Five Bundled Circles"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s2">"bundled_graph_circles"</span><span class="p">)()</span>
</pre></div>
<script id="cfea487b-0daf-4d4e-b8d1-6d49c0838bd4" src="posts/libraries/walking-through-the-pyviz-network-graphs-examples/bundled_graph_circles.js">
</script>
<p>This view helps to eliminate some of the noise from the edges, but I wonder if it does that at the expense of disproportionately diminishing the presence of <code>circle15</code> (the black circles).</p>
</div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/amazon-related-products-problem-description/">Amazon Related Products Problem Description</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/amazon-related-products-problem-description/" rel="bookmark"><time class="published dt-published" datetime="2019-03-20T13:31:59-07:00" itemprop="datePublished" title="2019-03-20 13:31">2019-03-20 13:31</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/amazon-related-products-problem-description/#org1301947">Requirements</a></li>
<li><a href="posts/networks/amazon-related-products-problem-description/#orgf5b810d">Rubric</a>
<ul>
<li><a href="posts/networks/amazon-related-products-problem-description/#org6c0800a">Proximate Layout</a></li>
<li><a href="posts/networks/amazon-related-products-problem-description/#orge240ed6">Design of the Visulization</a></li>
<li><a href="posts/networks/amazon-related-products-problem-description/#orgec4cac2">Contest</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org1301947">
<h2 id="org1301947">Requirements</h2>
<div class="outline-text-2" id="text-org1301947">
<ol class="org-ol">
<li>Create and upload a visualization</li>
<li>Note if a subset of the data was used</li>
<li>Note particular features of note in the visualization</li>
<li>Describe what the data and visualization show</li>
</ol>
</div>
</div>
<div class="outline-2" id="outline-container-orgf5b810d">
<h2 id="orgf5b810d">Rubric</h2>
<div class="outline-text-2" id="text-orgf5b810d"></div>
<div class="outline-3" id="outline-container-org6c0800a">
<h3 id="org6c0800a">Proximate Layout</h3>
<div class="outline-text-3" id="text-org6c0800a">
<p>How well are related items placed near each other? Do the edges cross or do items overlap when perhaps they do not need to? Are the crossings distracting?</p>
</div>
</div>
<div class="outline-3" id="outline-container-orge240ed6">
<h3 id="orge240ed6">Design of the Visulization</h3>
<div class="outline-text-3" id="text-orge240ed6">
<p>Dose the visualization effectively use the assignment of variables to elements and design of a visualization?</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgec4cac2">
<h3 id="orgec4cac2">Contest</h3>
<div class="outline-text-3" id="text-orgec4cac2">
<p>How interesting is the result? Does this represent an interesting choice of data and/or an interesting way to display the data?</p>
</div>
</div>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="next"><a href="index-2.html" rel="next">Older posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Contents Â© 2019 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="assets/js/all-nocdn.js">
</script>
<script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>
</body>
</html>
