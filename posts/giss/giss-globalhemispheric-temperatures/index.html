<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Plotting the Global and Hemispheric Temperatures." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>GISS Global/Hemispheric Temperatures | Visions, Voices, Data</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Visions-Voices-Data/posts/giss/giss-globalhemispheric-temperatures/" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script><!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"
</script>
-->
<script async src="../../../assets/javascript/p5.min.js" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="/posts/giss/giss-surface-temperature-analysis-gistemp-v32/" rel="prev" title="GISS Surface Temperature Analysis (GISTEMP v32)" type="text/html">
<link href="/posts/libraries/holoviews-tabular-datasets/" rel="next" title="HoloViews Tabular Datasets" type="text/html">
<meta content="Visions, Voices, Data" property="og:site_name">
<meta content="GISS Global/Hemispheric Temperatures" property="og:title">
<meta content="https://necromuralist.github.io/Visions-Voices-Data/posts/giss/giss-globalhemispheric-temperatures/" property="og:url">
<meta content="Plotting the Global and Hemispheric Temperatures." property="og:description">
<meta content="article" property="og:type">
<meta content="2019-02-28T12:58:07-08:00" property="article:published_time">
<meta content="giss" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="/"><span id="blog-title">Visions, Voices, Data</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="/categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="/rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Monkey Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">Cloistered Monkey</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach Pig Rump & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Give-The-Fish/">Give the Fish</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="https://necromuralist.github.io/Terribilis-Ludum/">Terribilis Ludum</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Visions-Voices-Data/"> <input name="k8" type="hidden" value="#444444"> <input name="k9" type="hidden" value="#D51920"> <input name="kt" type="hidden" value="h"> <input class="span2" maxlength="255" name="q" placeholder="Search…" type="text"> <input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="/posts/giss/giss-globalhemispheric-temperatures/index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href="/posts/giss/giss-globalhemispheric-temperatures/">GISS Global/Hemispheric Temperatures</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/giss/giss-globalhemispheric-temperatures/" rel="bookmark"><time class="published dt-published" datetime="2019-02-28T12:58:07-08:00" itemprop="datePublished" title="2019-02-28 12:58">2019-02-28 12:58</time></a></p>
<p class="sourceline"><a class="sourcelink" href="/posts/giss/giss-globalhemispheric-temperatures/index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/giss/giss-globalhemispheric-temperatures/#orgc22d560">Set Up</a>
<ul>
<li><a href="/posts/giss/giss-globalhemispheric-temperatures/#org06f4f01">Imports</a></li>
<li><a href="/posts/giss/giss-globalhemispheric-temperatures/#org20076e0">Setup the Embed</a></li>
</ul>
</li>
<li><a href="/posts/giss/giss-globalhemispheric-temperatures/#orgce73e27">Load the Data</a></li>
<li><a href="/posts/giss/giss-globalhemispheric-temperatures/#org14b4adc">Plot</a>
<ul>
<li><a href="/posts/giss/giss-globalhemispheric-temperatures/#orgc5e41ca">Global/Hemispheric</a></li>
<li><a href="/posts/giss/giss-globalhemispheric-temperatures/#orgd8bd4db">Embed the Plot</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgc22d560">
<h2 id="orgc22d560">Set Up</h2>
<div class="outline-text-2" id="text-orgc22d560"></div>
<div class="outline-3" id="outline-container-org06f4f01">
<h3 id="org06f4f01">Imports</h3>
<div class="outline-text-3" id="text-org06f4f01"></div>
<div class="outline-4" id="outline-container-org3dfa1d7">
<h4 id="org3dfa1d7">Python</h4>
<div class="outline-text-4" id="text-org3dfa1d7">
<div class="highlight">
<pre><span></span>from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgf905f9d">
<h4 id="orgf905f9d">PyPi</h4>
<div class="outline-text-4" id="text-orgf905f9d">
<div class="highlight">
<pre><span></span>from bokeh.layouts import column
from bokeh.palettes import Set1
from bokeh.models import (
    BoxZoomTool,
    HoverTool,
    Legend,
    PanTool,
    ResetTool,
    SaveTool,
    Span,
    WheelZoomTool,
)
from bokeh.models.widgets import Panel, Tabs
from bokeh.plotting import (figure, 
                            ColumnDataSource,
)
from dotenv import load_dotenv
import holoviews
import pandas
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org02a6516">
<h4 id="org02a6516">This Project</h4>
<div class="outline-text-4" id="text-org02a6516">
<div class="highlight">
<pre><span></span>from bartleby_the_penguin.tangles.embed_bokeh import EmbedBokeh
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org20076e0">
<h3 id="org20076e0">Setup the Embed</h3>
<div class="outline-text-3" id="text-org20076e0">
<div class="highlight">
<pre><span></span>files_path = Path("../../files/posts/giss/giss-globalhemispheric-temperatures/")
Embed = partial(
    EmbedBokeh,
    folder_path=files_path)
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgd94652f">
<h4 id="orgd94652f">Set Up Bokeh</h4>
<div class="outline-text-4" id="text-orgd94652f">
<p>I originally createde EmbedBokeh to use HoloViews to do the rendering so you have to set bokeh to be the backend or it will try to use <code>matplotlib</code> instead.</p>
<div class="highlight">
<pre><span></span>holoviews.extension("bokeh")
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgce73e27">
<h2 id="orgce73e27">Load the Data</h2>
<div class="outline-text-2" id="text-orgce73e27">
<div class="highlight">
<pre><span></span>load_dotenv(".env")
path = Path(os.environ.get("ZONES")).expanduser()
assert path.is_file()
with path.open() as reader:
    giss = pandas.read_csv(path)
giss.loc[:, "Year"] = giss.Year.astype("int32")
</pre></div>
<div class="highlight">
<pre><span></span>print(giss.describe())
</pre></div>
<pre class="example">
              Year        Glob        NHem        SHem     24N-90N  \
count   139.000000  139.000000  139.000000  139.000000  139.000000   
mean   1949.000000    0.032302    0.056043    0.008561    0.077698   
std      40.269923    0.336896    0.393435    0.301848    0.464606   
min    1880.000000   -0.490000   -0.540000   -0.490000   -0.580000   
25%    1914.500000   -0.200000   -0.220000   -0.235000   -0.280000   
50%    1949.000000   -0.070000   -0.010000   -0.080000    0.020000   
75%    1983.500000    0.215000    0.210000    0.265000    0.255000   
max    2018.000000    0.980000    1.260000    0.710000    1.500000   

          24S-24N     90S-24S     64N-90N     44N-64N     24N-44N     EQU-24N  \
count  139.000000  139.000000  139.000000  139.000000  139.000000  139.000000   
mean     0.036115   -0.018561    0.111079    0.117770    0.027698    0.027626   
std      0.331384    0.295695    0.917715    0.516729    0.356416    0.326111   
min     -0.650000   -0.470000   -1.640000   -0.710000   -0.590000   -0.720000   
25%     -0.215000   -0.250000   -0.545000   -0.270000   -0.200000   -0.230000   
50%     -0.030000   -0.100000    0.020000    0.000000   -0.070000    0.000000   
75%      0.255000    0.230000    0.660000    0.360000    0.135000    0.240000   
max      0.970000    0.700000    3.050000    1.440000    1.060000    0.930000   

          24S-EQU     44S-24S     64S-44S     90S-64S  
count  139.000000  139.000000  139.000000  139.000000  
mean     0.045683    0.020432   -0.069353   -0.078129  
std      0.343385    0.312688    0.269380    0.732359  
min     -0.580000   -0.430000   -0.540000   -2.570000  
25%     -0.210000   -0.220000   -0.265000   -0.490000  
50%     -0.030000   -0.080000   -0.090000    0.050000  
75%      0.290000    0.260000    0.180000    0.410000  
max      1.020000    0.780000    0.450000    1.270000  
</pre>
<div class="highlight">
<pre><span></span>print(giss.iloc[0])
print()
print(giss.iloc[-1])
</pre></div>
<pre class="example">
Year       1880.00
Glob         -0.18
NHem         -0.31
SHem         -0.06
24N-90N      -0.38
24S-24N      -0.17
90S-24S      -0.01
64N-90N      -0.97
44N-64N      -0.47
24N-44N      -0.25
EQU-24N      -0.21
24S-EQU      -0.13
44S-24S      -0.04
64S-44S       0.05
90S-64S       0.67
Name: 0, dtype: float64

Year       2018.00
Glob          0.82
NHem          0.99
SHem          0.66
24N-90N       1.19
24S-24N       0.64
90S-24S       0.70
64N-90N       1.87
44N-64N       1.09
24N-44N       1.03
EQU-24N       0.69
24S-EQU       0.59
44S-24S       0.78
64S-44S       0.37
90S-64S       1.07
Name: 138, dtype: float64
</pre>
<div class="highlight">
<pre><span></span>print(giss.columns)
giss = giss.rename(columns=dict(
    Glob="Global", 
    NHem="Northern Hemisphere", 
    SHem="Southern Hemisphere"))
print(giss.columns)
</pre></div>
<pre class="example">
Index(['Year', 'Glob', 'NHem', 'SHem', '24N-90N', '24S-24N', '90S-24S',
       '64N-90N', '44N-64N', '24N-44N', 'EQU-24N', '24S-EQU', '44S-24S',
       '64S-44S', '90S-64S'],
      dtype='object')
Index(['Year', 'Global', 'Northern Hemisphere', 'Southern Hemisphere',
       '24N-90N', '24S-24N', '90S-24S', '64N-90N', '44N-64N', '24N-44N',
       'EQU-24N', '24S-EQU', '44S-24S', '64S-44S', '90S-64S'],
      dtype='object')
</pre></div>
</div>
<div class="outline-2" id="outline-container-org14b4adc">
<h2 id="org14b4adc">Plot</h2>
<div class="outline-text-2" id="text-org14b4adc"></div>
<div class="outline-3" id="outline-container-orgc5e41ca">
<h3 id="orgc5e41ca">Global/Hemispheric</h3>
<div class="outline-text-3" id="text-orgc5e41ca">
<div class="highlight">
<pre><span></span>class Plot:
    width = 1000
    height = 800
    line_width = 4
    alpha = 0.8
    light_alpha = 0.2
    title_font_size = "14pt"
</pre></div>
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips = [
        ("Year", "@year"),
        ("Difference From Normal", "@anomaly")
    ]
)

tools = [
    hover,
    PanTool(),
    WheelZoomTool(),
    BoxZoomTool(),
    ResetTool(),
    SaveTool(),
]

plot = figure(plot_width=Plot.width, plot_height=Plot.height, 
              x_range=(giss.Year.min(), giss.Year.max()),
              x_axis_label="Year",
              y_axis_label="Difference (Celsius)",
              tools=tools)

plot.title.text = "Yearly Temperature Difference from Mean 1931-1980 Temperature by Hemisphere"
plot.title.text_font_size = Plot.title_font_size

horizontal = Span(location=0, dimension="width", line_color="darkgray",
                  line_width=Plot.line_width, 
                  line_cap="round",
                  line_dash="dashed")
plot.renderers.extend([horizontal])
locations = ["Global", "Northern Hemisphere", "Southern Hemisphere"]
for location, color in zip(locations, Set1[3]):
    columns = ColumnDataSource(
        data=dict(
            year=giss.Year,
            anomaly=giss[location],
            smoothed=giss.rolling(5, on="Year", min_periods=1)[location].mean(),
        )
    )
    line = plot.circle("year", "anomaly", source=columns, 
                       color=color, 
                       line_width=Plot.line_width, 
                       alpha=Plot.light_alpha,
                       legend=location)
    line = plot.line("year", "smoothed", source=columns,
                     color=color,
                     line_width=Plot.line_width, alpha=Plot.alpha,
                     legend="{} Rolling 5 Year Mean".format(location))
plot.legend.click_policy = "hide"
plot.legend.location = "top_left"
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgd8bd4db">
<h3 id="orgd8bd4db">Embed the Plot</h3>
<div class="outline-text-3" id="text-orgd8bd4db">
<p>I need to fix the <code>EmbedBokeh</code> class.</p>
<div class="highlight">
<pre><span></span>embed = Embed(plot, "global_temperature_anomalies")
embed._figure = plot
embed()
</pre></div>
<script id="dc18ca51-6ee7-4d09-8658-d696c50a9e60" src="/posts/giss/giss-globalhemispheric-temperatures/global_temperature_anomalies.js"></script>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/giss/" rel="tag">giss</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../giss-surface-temperature-analysis-gistemp-v32/" rel="prev" title="GISS Surface Temperature Analysis (GISTEMP v32)">Previous post</a></li>
<li class="next"><a href="../../libraries/holoviews-tabular-datasets/" rel="next" title="HoloViews Tabular Datasets">Next post</a></li>
</ul>
</nav>
</aside>
<!--End of body content-->
<footer id="footer">Contents © 2023 <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script> </div>
</div>
</div>
</div>
</article>
</div>
</div>
</body>
</html>
