<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Using simulation to check for gender discrimination." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Gender Discrimination Inference | Visions, Voices, Data</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Visions-Voices-Data/posts/gender-discrimination/" rel="canonical"><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script><!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"
</script>
-->
<script async src="../../javascript/p5.min.js" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="/posts/introductory-statistics-with-randomization-and-simulation/" rel="prev" title="Introductory Statistics with Randomization and Simulation" type="text/html">
<link href="/posts/opportunity-cost/" rel="next" title="Opportunity Cost" type="text/html">
<meta content="Visions, Voices, Data" property="og:site_name">
<meta content="Gender Discrimination Inference" property="og:title">
<meta content="https://necromuralist.github.io/Visions-Voices-Data/posts/gender-discrimination/" property="og:url">
<meta content="Using simulation to check for gender discrimination." property="og:description">
<meta content="article" property="og:type">
<meta content="2020-09-22T17:04:38-07:00" property="article:published_time">
<meta content="inference" property="article:tag">
<meta content="openintro" property="article:tag">
<meta content="simulation" property="article:tag">
<meta content="statistics" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="/"><span id="blog-title">Visions, Voices, Data</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="/categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="/rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Monkey Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">Cloistered Monkey</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach Pig Rump & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Give-The-Fish/">Give the Fish</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="https://necromuralist.github.io/Terribilis-Ludum/">Terribilis Ludum</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Visions-Voices-Data/"> <input name="k8" type="hidden" value="#444444"> <input name="k9" type="hidden" value="#D51920"> <input name="kt" type="hidden" value="h"> <input class="span2" maxlength="255" name="q" placeholder="Search…" type="text"> <input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="/posts/gender-discrimination/index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href="/posts/gender-discrimination/">Gender Discrimination Inference</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/gender-discrimination/" rel="bookmark"><time class="published dt-published" datetime="2020-09-22T17:04:38-07:00" itemprop="datePublished" title="2020-09-22 17:04">2020-09-22 17:04</time></a></p>
<p class="sourceline"><a class="sourcelink" href="/posts/gender-discrimination/index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="/posts/gender-discrimination/#orgd427375">Beginning</a>
<ul>
<li><a href="/posts/gender-discrimination/#org4ef1347">Imports</a></li>
<li><a href="/posts/gender-discrimination/#org4f0336b">Randomness</a></li>
<li><a href="/posts/gender-discrimination/#org4b9d3d6">Plotting, Tables, and a Timer</a></li>
</ul>
</li>
<li><a href="/posts/gender-discrimination/#orgd7f0041">Middle</a>
<ul>
<li><a href="/posts/gender-discrimination/#org4fc6b43">The Original Study</a></li>
<li><a href="/posts/gender-discrimination/#org3febf3d">The Experiment</a></li>
<li><a href="/posts/gender-discrimination/#orgf768624">Looking at the Distribution</a></li>
<li><a href="/posts/gender-discrimination/#org67782c5">A Hypothesis Test</a></li>
</ul>
</li>
<li><a href="/posts/gender-discrimination/#org13a8535">End</a>
<ul>
<li><a href="/posts/gender-discrimination/#org319a0b2">In Abstract</a></li>
<li><a href="/posts/gender-discrimination/#org42649df">Source</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgd427375">
<h2 id="orgd427375">Beginning</h2>
<div class="outline-text-2" id="text-orgd427375"></div>
<div class="outline-3" id="outline-container-org4ef1347">
<h3 id="org4ef1347">Imports</h3>
<div class="outline-text-3" id="text-org4ef1347">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">Namespace</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">equal</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">,</span>    
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># my stuff</span>
<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">EmbedHoloviews</span><span class="p">,</span> <span class="n">Timer</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org4f0336b">
<h3 id="org4f0336b">Randomness</h3>
<div class="outline-text-3" id="text-org4f0336b">
<div class="highlight">
<pre><span></span><span class="n">numpy_random</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org4b9d3d6">
<h3 id="org4b9d3d6">Plotting, Tables, and a Timer</h3>
<div class="outline-text-3" id="text-org4b9d3d6"></div>
<div class="outline-4" id="outline-container-org1b73532">
<h4 id="org1b73532">Plotting</h4>
<div class="outline-text-4" id="text-org1b73532">
<div class="highlight">
<pre><span></span><span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedHoloviews</span><span class="p">,</span>
                <span class="n">folder_path</span><span class="o">=</span><span class="s2">"files/posts/gender-discrimination/"</span><span class="p">)</span>
<span class="n">Plot</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">990</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">780</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">tan</span><span class="o">=</span><span class="s2">"#ddb377"</span><span class="p">,</span>
    <span class="n">blue</span><span class="o">=</span><span class="s2">"#4687b7"</span><span class="p">,</span>
    <span class="n">red</span><span class="o">=</span><span class="s2">"#ce7b6d"</span><span class="p">,</span>
    <span class="n">color_cycle</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Cycle</span><span class="p">([</span><span class="s2">"#4687b7"</span><span class="p">,</span> <span class="s2">"#ce7b6d"</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org5954eba">
<h4 id="org5954eba">The Table</h4>
<div class="outline-text-4" id="text-org5954eba">
<div class="highlight">
<pre><span></span><span class="n">TABLE</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tabulate</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgab8eaad">
<h4 id="orgab8eaad">The Timer</h4>
<div class="outline-text-4" id="text-orgab8eaad">
<div class="highlight">
<pre><span></span><span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgd7f0041">
<h2 id="orgd7f0041">Middle</h2>
<div class="outline-text-2" id="text-orgd7f0041"></div>
<div class="outline-3" id="outline-container-org4fc6b43">
<h3 id="org4fc6b43">The Original Study</h3>
<div class="outline-text-3" id="text-org4fc6b43">
<p>This starts with a study where bank managers were each given a personnel file and asked to decide if they would promote the person represented by the file to branch manager. The files were identical but half of them were filled out as male and half as female. The researchers wanted to know if these manager were biased in favor of men. There was actually two types of jobs, one described by the authors as "simple" and one as "complex". This only looks at the "simple" job. The table below shows their results.</p>
<div class="highlight">
<pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Promoted"</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
                          <span class="s2">"Not Promoted"</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]},</span>
                         <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">"Male"</span><span class="p">,</span> <span class="s2">"Female"</span><span class="p">])</span>
<span class="n">row</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">row</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Total"</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
<span class="n">study</span><span class="p">[</span><span class="s2">"Total"</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">study</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">Promoted</th>
<th class="org-right" scope="col">Not Promoted</th>
<th class="org-right" scope="col">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Male</td>
<td class="org-right">21</td>
<td class="org-right">3</td>
<td class="org-right">24</td>
</tr>
<tr>
<td class="org-left">Female</td>
<td class="org-right">14</td>
<td class="org-right">10</td>
<td class="org-right">24</td>
</tr>
<tr>
<td class="org-left">Total</td>
<td class="org-right">35</td>
<td class="org-right">13</td>
<td class="org-right">48</td>
</tr>
</tbody>
</table>
<p>Let's look at the values (without the totals) as a plot.</p>
<div class="highlight">
<pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="k">del</span><span class="p">(</span><span class="n">plotter</span><span class="p">[</span><span class="s2">"Total"</span><span class="p">])</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"index"</span><span class="p">],</span>
                       <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Promoted"</span><span class="p">,</span> <span class="s2">"Not Promoted"</span><span class="p">])</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">"Gender"</span><span class="p">,</span>
                                      <span class="n">value</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">,</span>
                                      <span class="n">variable</span><span class="o">=</span><span class="s2">"Decision"</span><span class="p">))</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Gender"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">"Decision"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Outcome by Gender"</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">color_cycle</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"promotions_by_gender"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="/posts/gender-discrimination/promotions_by_gender.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It looks like a considerable majority of the males were promoted whereas for the females only a slight majority were promoted.</p>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Decision"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">"Gender"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Male Vs Female by Decision"</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">color_cycle</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"decision_by_gender"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="/posts/gender-discrimination/decision_by_gender.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>This plot doesn't make the disparity look quite as extreme as the previous plot did, I think.</p>
</div>
<div class="outline-4" id="outline-container-org499b6a2">
<h4 id="org499b6a2">About the Variables</h4>
<div class="outline-text-4" id="text-org499b6a2">
<p>I started using them without explicity stating it but we have two variable here - <code>Promoted</code> and <code>Not Promoted</code> are part of the <code>decision</code> variable and <code>Male</code> and <code>Female</code> are part of the <code>gender</code> variable.</p>
<p>Anyway… so more males were chosen for promotion than female, but by what proportion?</p>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">study</span><span class="o">/</span><span class="n">study</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">"Total"</span><span class="p">]))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">Promoted</th>
<th class="org-right" scope="col">Not Promoted</th>
<th class="org-right" scope="col">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Male</td>
<td class="org-right">0.6</td>
<td class="org-right">0.230769</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-left">Female</td>
<td class="org-right">0.4</td>
<td class="org-right">0.769231</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-left">Total</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>So 60% of the promoted were male and 40% of the promoted were female.</p>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="mf">.6</span><span class="o">/</span><span class="mf">.4</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<pre class="example">
1.50
</pre>
<p>If you were promoted you were one and a half times more likely to be male. Another way to look at it is to ask - <i>What proportion of each gender was promoted?</i></p>
<div class="highlight">
<pre><span></span><span class="n">fractions</span> <span class="o">=</span> <span class="n">study</span><span class="o">/</span><span class="n">study</span><span class="o">.</span><span class="n">Total</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">fractions</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">Promoted</th>
<th class="org-right" scope="col">Not Promoted</th>
<th class="org-right" scope="col">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Male</td>
<td class="org-right">0.875</td>
<td class="org-right">0.125</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-left">Female</td>
<td class="org-right">0.583333</td>
<td class="org-right">0.416667</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-left">Total</td>
<td class="org-right">1.45833</td>
<td class="org-right">0.541667</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>So about 88% of the males were promoted while only 58% of the females were promoted.</p>
<div class="highlight">
<pre><span></span><span class="n">POINT_ESTIMATE</span> <span class="o">=</span> <span class="p">(</span><span class="n">fractions</span><span class="o">.</span><span class="n">Promoted</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'Male'</span><span class="p">]</span>
                  <span class="o">-</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Promoted</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'Female'</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">POINT_ESTIMATE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<pre class="example">
0.29
</pre>
<p>There was a 30% difference between the rate of male promotion and the rate of female promotion. The question we have now is - <i>could this difference have happened by random chance or is this evidence of bias?</i>.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org3febf3d">
<h3 id="org3febf3d">The Experiment</h3>
<div class="outline-text-3" id="text-org3febf3d">
<p>We have a <b>point estimate</b> of the difference of 0.29 - is this evidence of bias?</p>
</div>
<div class="outline-4" id="outline-container-orgbf6fac3">
<h4 id="orgbf6fac3">Our Hypotheses</h4>
<div class="outline-text-4" id="text-orgbf6fac3">
<ul class="org-ul">
<li>\(H_0\): <b>Null Hypothesis.</b> The variables <code>gender</code> and =decision are independent and the observed difference was due to chance.</li>
<li>\(H_A\): <b>Alternative Hypothesis.</b> The variables <code>gender</code> and <code>decision</code> are not independent and the difference was not due to chance, but rather women were less likely to be promoted than men.</li>
</ul>
<p>I'm going to pick an arbitrary confidence interval of 0.95.</p>
<div class="highlight">
<pre><span></span><span class="n">ALPHA</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org44efb01">
<h4 id="org44efb01">The Simulation</h4>
<div class="outline-text-4" id="text-org44efb01">
<p>The basic method here is we'll create an "urn" with an equal number of "balls" for men and women (24 of each in this case) and then randomly select 35 balls representing the number that were promoted and see the difference in the fraction of males promoted vs the number of females. To make the math simple I'll run it a number of times that is a power of 10.</p>
</div>
<ul class="org-ul">
<li><a id="orgcd29ddc"></a>Some Setup<br>
<div class="outline-text-5" id="text-orgcd29ddc">
<p>To make the counting easier I'll set males to be 1 and females to be 0 (so the number of males promoted is the sum and the females is the remainder).</p>
<div class="highlight">
<pre><span></span><span class="n">NUMBER_OF_MALES</span> <span class="o">=</span> <span class="n">NUMBER_OF_FEMALES</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">MALE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">FEMALE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">PROMOTED</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">MALES</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">NUMBER_OF_MALES</span><span class="p">)</span>
<span class="n">FEMALES</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUMBER_OF_FEMALES</span><span class="p">)</span>
<span class="n">URN</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MALES</span><span class="p">,</span> <span class="n">FEMALES</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">URN</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">NUMBER_OF_MALES</span> <span class="o">+</span> <span class="n">NUMBER_OF_FEMALES</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">URN</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">NUMBER_OF_MALES</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><a id="orgc2794dc"></a>The Trials<br>
<div class="outline-text-5" id="text-orgc2794dc">
<div class="highlight">
<pre><span></span><span class="n">TRIALS</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
<span class="n">males_promoted</span> <span class="o">=</span> <span class="p">[</span><span class="n">numpy_random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">URN</span><span class="p">,</span> <span class="n">PROMOTED</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                  <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TRIALS</span><span class="p">)]</span>
<span class="n">females_promoted</span> <span class="o">=</span> <span class="p">[</span><span class="n">PROMOTED</span> <span class="o">-</span> <span class="n">males</span> <span class="k">for</span> <span class="n">males</span> <span class="ow">in</span> <span class="n">males_promoted</span><span class="p">]</span>
<span class="n">proportion_males_promoted</span> <span class="o">=</span> <span class="p">[</span><span class="n">males</span><span class="o">/</span><span class="n">NUMBER_OF_MALES</span> <span class="k">for</span> <span class="n">males</span> <span class="ow">in</span> <span class="n">males_promoted</span><span class="p">]</span>
<span class="n">proportion_females_promoted</span> <span class="o">=</span> <span class="p">[</span><span class="n">females</span><span class="o">/</span><span class="n">NUMBER_OF_FEMALES</span> <span class="k">for</span> <span class="n">females</span> <span class="ow">in</span> <span class="n">females_promoted</span><span class="p">]</span>
<span class="n">pairs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">proportion_males_promoted</span><span class="p">,</span> <span class="n">proportion_females_promoted</span><span class="p">)</span>
<span class="n">differences</span> <span class="o">=</span> <span class="p">[</span><span class="n">males</span> <span class="o">-</span> <span class="n">females</span> <span class="k">for</span> <span class="n">males</span><span class="p">,</span> <span class="n">females</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="outline-3" id="outline-container-orgf768624">
<h3 id="orgf768624">Looking at the Distribution</h3>
<div class="outline-text-3" id="text-orgf768624">
<div class="highlight">
<pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span>
    <span class="s2">"Point Estimate"</span><span class="p">:</span> <span class="n">differences</span><span class="p">,</span>
    <span class="s2">"Males Promoted"</span><span class="p">:</span> <span class="n">males_promoted</span><span class="p">,</span>
    <span class="s2">"Females Promoted"</span><span class="p">:</span> <span class="n">females_promoted</span><span class="p">,</span>
    <span class="s2">"Proportion Males Promoted"</span><span class="p">:</span> <span class="n">proportion_males_promoted</span><span class="p">,</span>
    <span class="s2">"Proportion Females Promoted"</span><span class="p">:</span> <span class="n">proportion_females_promoted</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s2">"Point Estimate"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Distribution of Differences in Gender Promotion"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"difference_distribution"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="/posts/gender-discrimination/difference_distribution.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>The distribution looks <i>mostly</i> normal. As you might guess the distribution is centered around 0 (cases where exactly the same number of males and females were promoted - although 35 were promoted each time so the trials are never exactly 0). The cases where the difference in proportion is as great or greater than as it was in the original study are in the rightmost two bins.</p>
<p>I should note that because the sample size is so small, there's a weird distribution of the points - there's not enough variation in the differences to make a smooth curve (thus the gaps in the histogram).</p>
<div class="highlight">
<pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"Point Estimate"</span><span class="p">])</span>
<span class="n">theoretical</span><span class="p">,</span> <span class="n">actual</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">first</span> <span class="o">=</span> <span class="n">theoretical</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">last</span> <span class="o">=</span> <span class="n">theoretical</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Curve</span><span class="p">([(</span><span class="n">first</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">first</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">),</span> <span class="p">(</span><span class="n">last</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">last</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">)],</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">red</span><span class="p">)</span>

<span class="n">qq_frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span>
    <span class="s2">"Theoretical Quantiles"</span><span class="p">:</span> <span class="n">theoretical</span><span class="p">,</span>
    <span class="s2">"Differences In Hiring Rates"</span><span class="p">:</span> <span class="n">actual</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">scatter</span> <span class="o">=</span> <span class="n">qq_frame</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Theoretical Quantiles"</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="s2">"Differences In Hiring Rates"</span><span class="p">,</span> <span class="n">datashade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">scatter</span> <span class="o">*</span> <span class="n">line</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Hiring Probability Plot"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="n">fontscale</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">fontscale</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">outcome</span> <span class="o">=</span> <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"differences_qq"</span><span class="p">)()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
<object data="/posts/gender-discrimination/differences_qq.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Hmm… I'm not sure I'm doing that right. But it looks reasonable, I suppose.</p>
<div class="highlight">
<pre><span></span><span class="n">lowest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"Point Estimate"</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">data_sorted</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"Point Estimate"</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>

<span class="n">max_loc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_sorted</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">)</span>
<span class="n">highest</span> <span class="o">=</span> <span class="n">data_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">max_loc</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Point Estimate: </span><span class="si">{</span><span class="n">POINT_ESTIMATE</span><span class="si">:</span><span class="s2"> 0.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="n">lowest</span><span class="si">:</span><span class="s2"> 0.3f</span><span class="si">}</span><span class="s2"> , </span><span class="si">{</span><span class="n">highest</span><span class="si">:</span><span class="s2"> 0.3f</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Point Estimate:  0.292
(-0.542 ,  0.208)
</pre>
<p>Looking at the confidence interval we can see that the original point estimate is higher than 95 % of the values, but the original book example used a hypothesis test so let's finish it up.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org67782c5">
<h3 id="org67782c5">A Hypothesis Test</h3>
<div class="outline-text-3" id="text-org67782c5">
<p>But anyway, what proportion of our simulations had as much or more of a difference than that found in the study?</p>
<div class="highlight">
<pre><span></span><span class="n">proportion</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">"Point Estimate"</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">POINT_ESTIMATE</span><span class="p">])</span><span class="o">/</span><span class="n">TRIALS</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Proportion: </span><span class="si">{</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">proportion</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> %"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Proportion: 2.450 %
</pre>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Probability of our study's difference in promotion between genders by chance alone: </span><span class="si">{</span><span class="n">proportion</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Our tolerance was </span><span class="si">{</span><span class="n">ALPHA</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
</pre></div>
<pre class="example">
Probability of our study's difference in promotion between genders by chance alone: 0.02.
Our tolerance was 0.05.
</pre>
<p>So we reject the null hypothesis and conclude that there is a statistically significant chance that the number of women promoted vs men in the original study was the result of bias.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org13a8535">
<h2 id="org13a8535">End</h2>
<div class="outline-text-2" id="text-org13a8535">
<p>Well, that was the replication (sort of) of this problem from <a href="/posts/introductory-statistics-with-randomization-and-simulation/">Introductory Statistics with Randomization and Simulation</a>. The point of it was to both review Hypothesis Testing and see how it can be done using simulation rather than a p-test.</p>
</div>
<div class="outline-3" id="outline-container-org319a0b2">
<h3 id="org319a0b2">In Abstract</h3>
<div class="outline-text-3" id="text-org319a0b2">
<ol class="org-ol">
<li>Is your problem that you suspect some kind of bias in outcomes for two groups?</li>
<li>Get the <b>Point Estimate</b> for the value you want to test</li>
<li>State the <b>Null Hypothesis</b> that what happened could happen by chance and the <b>Alternative Hypothesis</b> that there was bias involved.</li>
<li>Decide on a tolerance level for the probability that it happened by chance.</li>
<li>Set up your urn</li>
<li>Simulate random selections for a large number of trials.</li>
<li>Calculate the proporiton of the trials that were greater than the original studies Point Estimate.</li>
<li>Make a conclusion whether the original outcome could have happened by random chance or not.</li>
</ol>
</div>
</div>
<div class="outline-3" id="outline-container-org42649df">
<h3 id="org42649df">Source</h3>
<div class="outline-text-3" id="text-org42649df">
<ul class="org-ul">
<li><a href="/posts/introductory-statistics-with-randomization-and-simulation/">Introductory Statistics with Randomization and Simulation</a></li>
<li>Rosen B, Jerdee TH. Influence of sex role stereotypes on personnel decisions. Journal of Applied Psychology. 1974 Feb;59(1):9 <a href="https://pdfs.semanticscholar.org/39f6/d40e907ff08af4ddd3280c2ceee55ee1ddb6.pdf">Link to PDF</a></li>
</ul>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="/categories/inference/" rel="tag">inference</a></li>
<li><a class="tag p-category" href="/categories/openintro/" rel="tag">openintro</a></li>
<li><a class="tag p-category" href="/categories/simulation/" rel="tag">simulation</a></li>
<li><a class="tag p-category" href="/categories/statistics/" rel="tag">statistics</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="/posts/introductory-statistics-with-randomization-and-simulation/" rel="prev" title="Introductory Statistics with Randomization and Simulation">Previous post</a></li>
<li class="next"><a href="/posts/opportunity-cost/" rel="next" title="Opportunity Cost">Next post</a></li>
</ul>
</nav>
</aside>
<script crossorigin="anonymous" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">

        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
</script><!--End of body content-->
<footer id="footer">Contents © 2023 <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
<script src="../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script> </article>
</div>
</div>
</body>
</html>
