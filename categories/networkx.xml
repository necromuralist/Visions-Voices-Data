<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Visions, Voices, Data (Posts about networkx)</title><link>https://necromuralist.github.io/Visions-Voices-Data/</link><description></description><atom:link href="https://necromuralist.github.io/Visions-Voices-Data/categories/networkx.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2019 &lt;a href="mailto:necromuralist@protonmail.com"&gt;Cloistered Monkey&lt;/a&gt; </copyright><lastBuildDate>Wed, 24 Apr 2019 02:41:50 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Some Networkx Examples</title><link>https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/#org655365f"&gt;The Departure&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/#orgbda8c92"&gt;Imports&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/#org42127b5"&gt;Set Up&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/#orgf719c5b"&gt;The Initiation&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/#org813fd2f"&gt;Different Ways to Create Network Graphs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/#org0a0aa7b"&gt;A Chess Example&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/#orgb187ad2"&gt;The Return&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org655365f" class="outline-2"&gt;
&lt;h2 id="org655365f"&gt;The Departure&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org655365f"&gt;
&lt;p&gt;
This is a look at different ways of creating and manipulating graphs using &lt;a href="https://networkx.github.io"&gt;NetworkX&lt;/a&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgbda8c92" class="outline-3"&gt;
&lt;h3 id="orgbda8c92"&gt;Imports&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgbda8c92"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org2eb1683" class="outline-4"&gt;
&lt;h4 id="org2eb1683"&gt;Python&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org2eb1683"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from functools import partial
from pathlib import Path
import os
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgd524745" class="outline-4"&gt;
&lt;h4 id="orgd524745"&gt;PyPi&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orgd524745"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from bokeh.models import HoverTool
import holoviews
import hvplot.pandas
import networkx
import numpy
import pandas
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org37771fe" class="outline-4"&gt;
&lt;h4 id="org37771fe"&gt;My Stuff&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org37771fe"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from graeae.visualization import EmbedHoloview
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org42127b5" class="outline-3"&gt;
&lt;h3 id="org42127b5"&gt;Set Up&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org42127b5"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SLUG = "some-networkx-examples"
OUTPUT_PATH = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=OUTPUT_PATH)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgf719c5b" class="outline-2"&gt;
&lt;h2 id="orgf719c5b"&gt;The Initiation&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgf719c5b"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org813fd2f" class="outline-3"&gt;
&lt;h3 id="org813fd2f"&gt;Different Ways to Create Network Graphs&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org813fd2f"&gt;
&lt;p&gt;
&lt;b&gt;NetworkX&lt;/b&gt; has a few different ways to create graphs, some more flexible than others. This is a non-exhaustive showing of some of them.
&lt;/p&gt;
&lt;/div&gt;
&lt;div id="outline-container-org860d460" class="outline-4"&gt;
&lt;h4 id="org860d460"&gt;Adding Edges To An Existing Graph&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org860d460"&gt;
&lt;p&gt;
You can create a graph using the graph constructors. This is an example of an undirected &lt;a href="https://networkx.github.io/documentation/stable/reference/classes/graph.html"&gt;Graph&lt;/a&gt;.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;graph_1 = networkx.Graph()
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;G1.add_edges_from([(0, 1),
		   (0, 2),
		   (0, 3),
		   (0, 5),
		   (1, 3),
		   (1, 6),
		   (3, 4),
		   (4, 5),
		   (4, 7),
		   (5, 8),
		   (8, 9)])

networkx.draw_networkx(G1)
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="figure"&gt;
&lt;p&gt;&lt;img src="file:///tmp/graph_one.png" alt="graph_one.png"&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org8baf85a" class="outline-4"&gt;
&lt;h4 id="org8baf85a"&gt;Adjacency List&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org8baf85a"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;with open("G_adjlist.txt") as reader:
    print(reader.read())
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;G2 = networkx.read_adjlist('G_adjlist.txt', nodetype=int)
G2.edges()
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgced4ac0" class="outline-4"&gt;
&lt;h4 id="orgced4ac0"&gt;Adjacency Matrix&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orgced4ac0"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;G_mat = numpy.array([[0, 1, 1, 1, 0, 1, 0, 0, 0, 0],
		     [1, 0, 0, 1, 0, 0, 1, 0, 0, 0],
		     [1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
		     [1, 1, 0, 0, 1, 0, 0, 0, 0, 0],
		     [0, 0, 0, 1, 0, 1, 0, 1, 0, 0],
		     [1, 0, 0, 0, 1, 0, 0, 0, 1, 0],
		     [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
		     [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
		     [0, 0, 0, 0, 0, 1, 0, 0, 0, 1],
		     [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]])
G_mat
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;G3 = networkx.Graph(G_mat)
G3.edges()
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org98f8245" class="outline-4"&gt;
&lt;h4 id="org98f8245"&gt;Edgelist&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org98f8245"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;with open('G_edgelist.txt') as reader:
    print(reader.read())
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;G4 = networkx.read_edgelist('G_edgelist.txt', data=[('Weight', int)])

G4.edges(data=True)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org1e609e0" class="outline-4"&gt;
&lt;h4 id="org1e609e0"&gt;Pandas DataFrame&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org1e609e0"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;G_df = pandas.read_csv('G_edgelist.txt', delim_whitespace=True, 
		       header=None, names=['n1', 'n2', 'weight'])
G_df
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;G5 = networkx.from_pandas_dataframe(G_df, 'n1', 'n2', edge_attr='weight')
G5.edges(data=True)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org0a0aa7b" class="outline-3"&gt;
&lt;h3 id="org0a0aa7b"&gt;A Chess Example&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org0a0aa7b"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;with open('chess_graph.txt') as reader:
    count = 0
    for line in reader:
	print(line.strip())
	count += 1
	if count == 5:
	    break
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chess = networkx.read_edgelist('chess_graph.txt', data=[('outcome', int), ('timestamp', float)], 
			 create_using=networkx.MultiDiGraph())
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chess.is_directed(), chess.is_multigraph()
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chess.edges(data=True)[:5]
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;games_played = chess.degree()
games_played
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;max_value = max(games_played.values())
max_key, = [i for i in games_played.keys() if games_played[i] == max_value]

print('player {}\n{} games'.format(max_key, max_value))
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;df = pd.DataFrame(chess.edges(data=True), columns=['white', 'black', 'outcome'])
df.head()
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;df['outcome'] = df['outcome'].map(lambda x: x['outcome'])
df.head()
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;won_as_white = df[df['outcome']==1].groupby('white').sum()
won_as_black = df[df['outcome']==-1].groupby('black').sum()
win_count = won_as_white.add(won_as_black, fill_value=0)
print(win_count.head())
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;win_count.nlargest(5, 'outcome')
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgb187ad2" class="outline-2"&gt;
&lt;h2 id="orgb187ad2"&gt;The Return&lt;/h2&gt;
&lt;/div&gt;</description><category>networks</category><category>networkx</category><guid>https://necromuralist.github.io/Visions-Voices-Data/posts/networks/some-networkx-examples/</guid><pubDate>Fri, 12 Apr 2019 20:12:58 GMT</pubDate></item><item><title>Company Movie Night</title><link>https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#org2aea77c"&gt;The Departure&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#orga9b6686"&gt;Imports&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#orge4fc13c"&gt;Set Up&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#org3a5bedf"&gt;The Plotting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#orgbe5b59c"&gt;The Initiation&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#org4dbaddc"&gt;The Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#org235bc80"&gt;Plotting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#org6322dad"&gt;Question One&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#orge5a944d"&gt;Question 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#org18e193b"&gt;Question 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#orgd5588b1"&gt;Question 4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/#org7b57d4f"&gt;The Return&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org2aea77c" class="outline-2"&gt;
&lt;h2 id="org2aea77c"&gt;The Departure&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org2aea77c"&gt;
&lt;p&gt;
This is a look at working with networks using &lt;a href="https://networkx.github.io"&gt;networkx&lt;/a&gt;. Our scene - eight employees are trying to choose three movies to watch for company movie nights. We have two sources of data - the &lt;i&gt;candidate movies&lt;/i&gt; and the &lt;i&gt;relationship&lt;/i&gt; between pairs of employees. The relationships are on a scale from -100 to 100, with -100 being the strongest of enemies and 100 meaning they are best of friends. Zero either means they have no relationship (don't interact) or are indifferent about the other person.
&lt;/p&gt;
&lt;/div&gt;
&lt;div id="outline-container-orga9b6686" class="outline-3"&gt;
&lt;h3 id="orga9b6686"&gt;Imports&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orga9b6686"&gt;
&lt;/div&gt;
&lt;div id="outline-container-orga3e612e" class="outline-4"&gt;
&lt;h4 id="orga3e612e"&gt;From Python&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orga3e612e"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from argparse import Namespace
from functools import partial
from pathlib import Path
import os
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org4ed7813" class="outline-4"&gt;
&lt;h4 id="org4ed7813"&gt;From PyPi&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org4ed7813"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from dotenv import load_dotenv
from bokeh.models import HoverTool
from bokeh.models.graphs import EdgesAndLinkedNodes
import holoviews
import hvplot.pandas
import networkx
import pandas
import numpy
from networkx.algorithms import bipartite
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org3e0689d" class="outline-4"&gt;
&lt;h4 id="org3e0689d"&gt;My Stuff&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org3e0689d"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from graeae.visualization import EmbedBokeh, EmbedHoloview
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orge4fc13c" class="outline-3"&gt;
&lt;h3 id="orge4fc13c"&gt;Set Up&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orge4fc13c"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org51b58e9" class="outline-4"&gt;
&lt;h4 id="org51b58e9"&gt;Load Dotenv&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org51b58e9"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;load_dotenv(".env", override=True)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org3a5bedf" class="outline-3"&gt;
&lt;h3 id="org3a5bedf"&gt;The Plotting&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org3a5bedf"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SLUG = 'company-movie-night/'
OUTPUT = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=OUTPUT)
EmbedB = partial(EmbedBokeh, folder_path=OUTPUT)
holoviews.extension("bokeh")
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Plot = Namespace(
    width=800,
    height=800,
    fontsize=18,
    padding=dict(x=(-1, 1), y=(-1, 1))
)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgbe5b59c" class="outline-2"&gt;
&lt;h2 id="orgbe5b59c"&gt;The Initiation&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgbe5b59c"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org4dbaddc" class="outline-3"&gt;
&lt;h3 id="org4dbaddc"&gt;The Data&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org4dbaddc"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org04fda8f" class="outline-4"&gt;
&lt;h4 id="org04fda8f"&gt;This Is the Set Of Employee-Relationships&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org04fda8f"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;employee_relationships_path = Path(os.environ.get("EMPLOYEE_RELATIONSHIPS"))
relationships_data = pandas.read_csv(
    employee_relationships_path, 
    delimiter="\t", 
    header=None,
    names="employee_1 employee_2 relationship".split())
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;table = holoviews.Table(relationships_data).opts(height=Plot.height)
Embed(plot=table, file_name="relationships_data")()
&lt;/pre&gt;&lt;/div&gt;

&lt;object type="text/html" data="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/relationships_data.html" style="width:100%" height="800"&gt;
  &lt;p&gt;Figure Missing&lt;/p&gt;
&lt;/object&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;employees = set(relationships_data.employee_1.unique()) | set(relationships_data.employee_2.unique())
print(employees)
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
{'Frida', 'Vincent', 'Georgia', 'Joan', 'Andy', 'Lee', 'Pablo', 'Claude'}

&lt;/pre&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;print(len(employees))
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
8

&lt;/pre&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;print(len(relationships_data))
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
28

&lt;/pre&gt;

&lt;p&gt;
We have eight employees and twenty-eight links. Is this a fully connected graph? The handshake problem says that the amount of links in a fully-connected network is:
&lt;/p&gt;

&lt;p&gt;
\[
 links = \frac{n(n-1)}{2}
\]
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;print(len(employees) * (len(employees) - 1)/2)
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
28.0

&lt;/pre&gt;

&lt;p&gt;
It looks like our relationships data creates a fully-connected network (unless there is a duplicate which would be an error).
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgda76629" class="outline-4"&gt;
&lt;h4 id="orgda76629"&gt;These Are the Movie Choices&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orgda76629"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;employee_movies_path = Path(os.environ.get("EMPLOYEE_MOVIE_CHOICES"))
movies_data = pandas.read_csv(
    employee_movies_path, 
    delimiter="\t", 
    header=None,
    skiprows=1,
    names="employee movie".split())
print(len(movies))
print(movies_data.head())
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
11
  employee                            movie
0     Andy                         Anaconda
1     Andy                       Mean Girls
2     Andy                       The Matrix
3   Claude                         Anaconda
4   Claude  Monty Python and the Holy Grail

&lt;/pre&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;movies = set(movies_data.movie.unique())
for movie in sorted(movies):
    print(f" - {movie}")
&lt;/pre&gt;&lt;/div&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;Anaconda&lt;/li&gt;
&lt;li&gt;Forrest Gump&lt;/li&gt;
&lt;li&gt;Kung Fu Panda&lt;/li&gt;
&lt;li&gt;Mean Girls&lt;/li&gt;
&lt;li&gt;Monty Python and the Holy Grail&lt;/li&gt;
&lt;li&gt;Snakes on a Plane&lt;/li&gt;
&lt;li&gt;The Dark Knight&lt;/li&gt;
&lt;li&gt;The Godfather&lt;/li&gt;
&lt;li&gt;The Matrix&lt;/li&gt;
&lt;li&gt;The Shawshank Redemption&lt;/li&gt;
&lt;li&gt;The Social Network&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;
The eight employees chose 11 movies between them.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgeded156" class="outline-4"&gt;
&lt;h4 id="orgeded156"&gt;Converting the DataFrames to Graphs&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orgeded156"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org7b20119" class="outline-5"&gt;
&lt;h5 id="org7b20119"&gt;The Relationship Graph&lt;/h5&gt;
&lt;div class="outline-text-5" id="text-org7b20119"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;relationship_graph = networkx.from_pandas_edgelist(relationships_data, 
						   "employee_1", "employee_2", 
						   edge_attr="relationship")
for index, row in relationships_data.sample(5).iterrows():
    assert relationship_graph[row["employee_1"]][row["employee_2"]]["relationship"] == row["relationship"]
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;expected_edges = len(relationships_data)
expected_nodes = len(employees)
print("Expected Edges: {}".format(expected_edges))
print("Expected Nodes: {}".format(expected_nodes))
assert expected_nodes == relationship_graph.nodes
assert expected_edges == relationship_graph.edges
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
Expected Edges: 28
Expected Nodes: 8

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org235bc80" class="outline-3"&gt;
&lt;h3 id="org235bc80"&gt;Plotting&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org235bc80"&gt;
&lt;p&gt;
You can use the following function to plot graphs.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def plot_graph(graph, file_name, plot_title, weight_name=None, directed=False):
    """Plots an interactive graph using the spring-layout

    Args:
     graph: a networkx graph
     file_name: name to store the plot (without extension)
     plot_title: name to give the plot
     weight_name: name of the attribute for plotting edge weights (if G is weighted)
     directed: whether it is a directed graph
    """
    plot = holoviews.Graph.from_networkx(graph,
					 networkx.spring_layout).opts(
					     cmap="Set1",                                             
					     fontsize=Plot.fontsize,
					     width=Plot.width,
					     height=Plot.height,
					     edge_line_color=Plot.edge_color,
					     title=plot_title,
					     xaxis=None, yaxis=None, directed=directed)
    Embed(plot=plot, file_name=file_name)()
    return
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orge83d674" class="outline-4"&gt;
&lt;h4 id="orge83d674"&gt;The Employee Relationship Graph&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orge83d674"&gt;
&lt;p&gt;
The employee relationship graph consists of employees as nodes and their relationshp-level as weights on the edges.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;storage = None
def set_selection_policy(plot, element):
    storage = plot.handles
    storage["glyph_renderer"].selection_policy = EdgesAndLinkedNodes()
    return
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;plot = holoviews.Graph.from_networkx(relationship_graph,
				     networkx.circular_layout).opts(
					 cmap="Set1",
					 fontsize=Plot.fontsize,
					 width=800,
					 height=800,
					 title="Company Relationship Graph",
					 xaxis=None, yaxis=None).options(
					     edge_color_index="relationship", 
					     edge_cmap="Spectral").redim.range(**Plot.padding)
renderer = holoviews.render(plot)
renderer.renderers[-1].selection_policy = EdgesAndLinkedNodes()
EmbedB(plot=renderer, file_name="employee_relationships")()
&lt;/pre&gt;&lt;/div&gt;

&lt;script src="https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/employee_relationships" id="b59efb6f-30f2-4126-9b07-7e36c2a7effb"&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org6322dad" class="outline-3"&gt;
&lt;h3 id="org6322dad"&gt;Question One&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org6322dad"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def answer_one():
    """Loads the Employee Movie Choices

    Returns:
     Graph: graph with movie and employees as nodes
    """
    movie_choices = pandas.read_table('Employee_Movie_Choices.txt')
    movie_choices = networkx.from_pandas_dataframe(movie_choices, "#Employee", "Movie")
    return movie_choices
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;movie_choices = answer_one()
edges = movie_choices.edges()
assert len(edges) == 24
assert len(movie_choices.nodes()) == 19
assert networkx.is_bipartite(movie_choices)
positions = networkx.spring_layout(movie_choices)

networkx.draw_networkx(movie_choices, positions, edges=edges)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orge5a944d" class="outline-3"&gt;
&lt;h3 id="orge5a944d"&gt;Question 2&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orge5a944d"&gt;
&lt;p&gt;
Using the graph from the previous question, add nodes attributes named `'type'` where movies have the value `'movie'` and employees have the value `'employee'` and return that graph.
&lt;/p&gt;

&lt;p&gt;
&lt;b&gt;This function should return a networkx graph with node attributes `{'type': 'movie'}` or `{'type': 'employee'}`&lt;/b&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def answer_two():
    """Adds 'type' to nodes from movie-graph

    Returns:
     Graph: answer_one with 'type' attribute added (employee or movie)
    """
    graph = answer_one()
    new_graph = networkx.Graph()
    nodes = graph.nodes()
    employee_nodes = [node for node in nodes if node in employees]
    movie_nodes = [node for node in nodes if node in movies]
    new_graph.add_nodes_from(employee_nodes, bipartite=0, type='employee')
    new_graph.add_nodes_from(movie_nodes, bipartite=1, type="movie")
    new_graph.add_edges_from(graph.edges())
    return new_graph
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;two = answer_two()
two.nodes(data=True)
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;plot_graph(two)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org18e193b" class="outline-3"&gt;
&lt;h3 id="org18e193b"&gt;Question 3&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org18e193b"&gt;
&lt;p&gt;
Find a weighted projection of the graph from `answer&lt;sub&gt;two&lt;/sub&gt;` which tells us how many movies different pairs of employees have in common.
&lt;/p&gt;

&lt;p&gt;
&lt;b&gt;This function should return a weighted projected graph.&lt;/b&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def answer_three():
    graph = answer_two()
    assert networkx.is_bipartite(graph)
    return bipartite.weighted_projected_graph(graph, employees)
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;three = answer_three()
plot_graph(three)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgd5588b1" class="outline-3"&gt;
&lt;h3 id="orgd5588b1"&gt;Question 4&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgd5588b1"&gt;
&lt;p&gt;
Suppose you'd like to find out if people that have a high relationship score also like the same types of movies.
&lt;/p&gt;

&lt;p&gt;
Find the Pearson correlation ( using `DataFrame.corr()` ) between employee relationship scores and the number of movies they have in common. If two employees have no movies in common it should be treated as a 0, not a missing value, and should be included in the correlation calculation.
&lt;/p&gt;

&lt;p&gt;
&lt;b&gt;This function should return a float.&lt;/b&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def answer_four():
    """calculates the pearson correlation for data

    Returns:
     float: Pearson correlation for weight and relationship_score
    """
    three = answer_three()
    relationships = pandas.read_table(
	"Employee_Relationships.txt",
	names="employee_left employee_right relationship_score".split())
    relationships["employees"] = relationships.apply(
	lambda row: tuple(sorted((row["employee_left"],
				  row['employee_right']))), axis=1)

    weights = pandas.DataFrame(
	three.edges(data=True),
	columns="employee_left employee_right weight".split())
    weights["weight"] = weights.weight.map(lambda row: row["weight"])
    weights["employees"] = weights.apply(lambda row: tuple(sorted(
	(row["employee_left"],
	 row["employee_right"]))),
					 axis=1)

    joined = pandas.merge(relationships, weights, how="outer", 
			  on=['employees'])
    assert len(joined) == len(relationships)
    joined['weight'] = joined["weight"].fillna(0)

    data = joined[["relationship_score", "weight"]]
    correlation = data.corr()
    return correlation.relationship_score.weight
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;print(answer_four())
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org7b57d4f" class="outline-2"&gt;
&lt;h2 id="org7b57d4f"&gt;The Return&lt;/h2&gt;
&lt;/div&gt;</description><category>networks</category><category>networkx</category><guid>https://necromuralist.github.io/Visions-Voices-Data/posts/networks/company-movie-night/</guid><pubDate>Thu, 11 Apr 2019 20:04:23 GMT</pubDate></item></channel></rss>