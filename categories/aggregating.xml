<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Visions, Voices, Data (Posts about aggregating)</title><link>https://necromuralist.github.io/Visions-Voices-Data/</link><description></description><atom:link href="https://necromuralist.github.io/Visions-Voices-Data/categories/aggregating.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2019 &lt;a href="mailto:necromuralist@protonmail.com"&gt;Cloistered Monkey&lt;/a&gt; </copyright><lastBuildDate>Sun, 03 Mar 2019 01:49:26 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Aggregating Tabular Data</title><link>https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org20d8efb"&gt;Set Up&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#orgbb6c321"&gt;Imports&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org063551b"&gt;Holoviews Bokeh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org426a95e"&gt;The Embedder&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org8c1bc31"&gt;Dotenv&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org8e46700"&gt;Load the Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org38b047e"&gt;Convert the DataFrame to a Dataset&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#orge911d52"&gt;Aggregate the Data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org20d8efb" class="outline-2"&gt;
&lt;h2 id="org20d8efb"&gt;Set Up&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org20d8efb"&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgbb6c321" class="outline-3"&gt;
&lt;h3 id="orgbb6c321"&gt;Imports&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgbb6c321"&gt;
&lt;/div&gt;
&lt;div id="outline-container-orga206010" class="outline-4"&gt;
&lt;h4 id="orga206010"&gt;Python&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orga206010"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from functools import partial
from pathlib import Path
import os
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orge5f13ec" class="outline-4"&gt;
&lt;h4 id="orge5f13ec"&gt;PyPi&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orge5f13ec"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from dotenv import load_dotenv
from holoviews import opts
from tabulate import tabulate
import holoviews
import numpy
import pandas
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org31f3ff7" class="outline-4"&gt;
&lt;h4 id="org31f3ff7"&gt;My Projects&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org31f3ff7"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from bartleby_the_penguin.tangles.embed_bokeh import EmbedBokeh
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org063551b" class="outline-3"&gt;
&lt;h3 id="org063551b"&gt;Holoviews Bokeh&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org063551b"&gt;
&lt;p&gt;
I don't know why but you have to specify that you're using &lt;code&gt;bokeh&lt;/code&gt;, even though it looks like it's working when you don't.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;holoviews.extension("bokeh")
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org426a95e" class="outline-3"&gt;
&lt;h3 id="org426a95e"&gt;The Embedder&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org426a95e"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;files_path = Path("../../files/posts/libraries/aggregating-tabular-data/")
Embed = partial(
    EmbedBokeh,
    folder_path=files_path)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org8c1bc31" class="outline-3"&gt;
&lt;h3 id="org8c1bc31"&gt;Dotenv&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org8c1bc31"&gt;
&lt;p&gt;
I have the path to the data-set in a &lt;code&gt;.env&lt;/code&gt; file so I'll load it into the environment dictionary.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;load_dotenv(".env")
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org8e46700" class="outline-2"&gt;
&lt;h2 id="org8e46700"&gt;Load the Data&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org8e46700"&gt;
&lt;p&gt;
This is the same measles/pertusis data that I used before.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;path = Path(os.environ.get("DISEASES")).expanduser()
assert path.is_file()
with path.open() as reader:
    diseases = pandas.read_csv(path)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org38b047e" class="outline-2"&gt;
&lt;h2 id="org38b047e"&gt;Convert the DataFrame to a Dataset&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org38b047e"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;key_dimensions = "Year State".split()
value_dimensions = [("measles", "Measles Incidence"), ("pertussis", "Pertusis Incidence")]
dataset = holoviews.Dataset(diseases, key_dimensions, value_dimensions)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orge911d52" class="outline-2"&gt;
&lt;h2 id="orge911d52"&gt;Aggregate the Data&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orge911d52"&gt;
&lt;p&gt;
While I had aggregated the data before, this time I'm going to pass in the "Year" column as an argument so it won't keep the states separate.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aggregator = dataset.aggregate("Year", function=numpy.mean, spreadfn=numpy.std)
error_bars = holoviews.ErrorBars(aggregator, vdims=["measles", "measles_std"]).iloc[::2]
overlay = (holoviews.Curve(aggregator) * error_bars).redim.range(measles=(0, None))
plot = overlay.opts(height=500, width=1000, tools=["hover"])
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Embed(plot, "northwest_measles_aggregated")()
&lt;/pre&gt;&lt;/div&gt;

&lt;script src="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/northwest_measles_aggregated.js" id="e398babc-d5bc-451c-bb10-02ce9f5163d0"&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>aggregating</category><category>data</category><category>example</category><category>holoviews</category><guid>https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/</guid><pubDate>Sun, 03 Mar 2019 01:34:16 GMT</pubDate></item></channel></rss>