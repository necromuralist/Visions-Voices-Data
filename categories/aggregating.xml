<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Visions, Voices, Data (Posts about aggregating)</title><link>https://necromuralist.github.io/Visions-Voices-Data/</link><description></description><atom:link href="https://necromuralist.github.io/Visions-Voices-Data/categories/aggregating.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2019 &lt;a href="mailto:necromuralist@protonmail.com"&gt;Cloistered Monkey&lt;/a&gt; </copyright><lastBuildDate>Tue, 05 Mar 2019 02:01:53 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Aggregating Tabular Data</title><link>https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org6757792"&gt;Set Up&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#orgfc86770"&gt;Imports&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org6682ddb"&gt;Holoviews Bokeh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#orgfadb4d7"&gt;The Embedder&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org2ea0dbe"&gt;Dotenv&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org2f36520"&gt;Load the Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#org1d4210b"&gt;Convert the DataFrame to a Dataset&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/#orgc58cf93"&gt;Aggregate the Data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org6757792" class="outline-2"&gt;
&lt;h2 id="org6757792"&gt;Set Up&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org6757792"&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgfc86770" class="outline-3"&gt;
&lt;h3 id="orgfc86770"&gt;Imports&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgfc86770"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org596cefe" class="outline-4"&gt;
&lt;h4 id="org596cefe"&gt;Python&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org596cefe"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from functools import partial
from pathlib import Path
import os
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org675e64b" class="outline-4"&gt;
&lt;h4 id="org675e64b"&gt;PyPi&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org675e64b"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from dotenv import load_dotenv
from holoviews import opts
from tabulate import tabulate
import holoviews
import numpy
import pandas
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgcbd9759" class="outline-4"&gt;
&lt;h4 id="orgcbd9759"&gt;My Projects&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orgcbd9759"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;from bartleby_the_penguin.tangles.embed_bokeh import EmbedBokeh
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org6682ddb" class="outline-3"&gt;
&lt;h3 id="org6682ddb"&gt;Holoviews Bokeh&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org6682ddb"&gt;
&lt;p&gt;
I don't know why but you have to specify that you're using &lt;code&gt;bokeh&lt;/code&gt;, even though it looks like it's working when you don't.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;holoviews.extension("bokeh")
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgfadb4d7" class="outline-3"&gt;
&lt;h3 id="orgfadb4d7"&gt;The Embedder&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgfadb4d7"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;files_path = Path("../../files/posts/libraries/aggregating-tabular-data/")
Embed = partial(
    EmbedBokeh,
    folder_path=files_path)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org2ea0dbe" class="outline-3"&gt;
&lt;h3 id="org2ea0dbe"&gt;Dotenv&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org2ea0dbe"&gt;
&lt;p&gt;
I have the path to the data-set in a &lt;code&gt;.env&lt;/code&gt; file so I'll load it into the environment dictionary.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;load_dotenv(".env")
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org2f36520" class="outline-2"&gt;
&lt;h2 id="org2f36520"&gt;Load the Data&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org2f36520"&gt;
&lt;p&gt;
This is the same measles/pertusis data that I used before.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;path = Path(os.environ.get("DISEASES")).expanduser()
assert path.is_file()
with path.open() as reader:
    diseases = pandas.read_csv(path)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org1d4210b" class="outline-2"&gt;
&lt;h2 id="org1d4210b"&gt;Convert the DataFrame to a Dataset&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org1d4210b"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;key_dimensions = "Year State".split()
value_dimensions = [("measles", "Measles Incidence"), ("pertussis", "Pertusis Incidence")]
dataset = holoviews.Dataset(diseases, key_dimensions, value_dimensions)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgc58cf93" class="outline-2"&gt;
&lt;h2 id="orgc58cf93"&gt;Aggregate the Data&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgc58cf93"&gt;
&lt;p&gt;
While I had aggregated the data before, this time I'm going to pass in the "Year" column as an argument so it won't keep the states separate.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aggregator = dataset.aggregate("Year", function=numpy.mean, spreadfn=numpy.std)
error_bars = holoviews.ErrorBars(aggregator, vdims=["measles", "measles_std"]).iloc[::2]
overlay = (holoviews.Curve(aggregator) * error_bars).redim.range(measles=(0, None))
plot = overlay.opts(height=500, width=1000, tools=["hover"])
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Embed(plot, "northwest_measles_aggregated")()
&lt;/pre&gt;&lt;/div&gt;

&lt;script src="https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/northwest_measles_aggregated.js" id="e398babc-d5bc-451c-bb10-02ce9f5163d0"&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>aggregating</category><category>data</category><category>example</category><category>holoviews</category><guid>https://necromuralist.github.io/Visions-Voices-Data/posts/libraries/aggregating-tabular-data/</guid><pubDate>Sun, 03 Mar 2019 01:34:16 GMT</pubDate></item></channel></rss>