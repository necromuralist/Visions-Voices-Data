<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Adumbrations of data." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Visions, Voices, Data (old posts, page 3) | Visions, Voices, Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Visions-Voices-Data/index-3.html" rel="canonical">
<link href="." rel="prev" type="text/html">
<link href="index-2.html" rel="next" type="text/html"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script><!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"
</script>
-->
<script async src="javascript/p5.min.js" type="text/javascript"></script>
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/Visions-Voices-Data/"><span id="blog-title">Visions, Voices, Data</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="/categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="/rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">Cloistered Monkey</a> <a class="dropdown-item" href="/pages/giss/giss-yearly-anomalies-by-climate-zone">GISS Anomalies</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Visions-Voices-Data/"> <input name="k8" type="hidden" value="#444444"> <input name="k9" type="hidden" value="#D51920"> <input name="kt" type="hidden" value="h"> <input class="span2" maxlength="255" name="q" placeholder="Searchâ€¦" type="text"> <input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/networks/some-networkx-examples/">Some Networkx Examples</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/networks/some-networkx-examples/" rel="bookmark"><time class="published dt-published" datetime="2019-04-12T13:12:58-07:00" itemprop="datePublished" title="2019-04-12 13:12">2019-04-12 13:12</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/networks/some-networkx-examples/#org655365f">The Departure</a>
<ul>
<li><a href="/posts/networks/some-networkx-examples/#orgbda8c92">Imports</a></li>
<li><a href="/posts/networks/some-networkx-examples/#org42127b5">Set Up</a></li>
</ul>
</li>
<li><a href="/posts/networks/some-networkx-examples/#orgf719c5b">The Initiation</a>
<ul>
<li><a href="/posts/networks/some-networkx-examples/#org813fd2f">Different Ways to Create Network Graphs</a></li>
<li><a href="/posts/networks/some-networkx-examples/#org0a0aa7b">A Chess Example</a></li>
</ul>
</li>
<li><a href="/posts/networks/some-networkx-examples/#orgb187ad2">The Return</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org655365f">
<h2 id="org655365f">The Departure</h2>
<div class="outline-text-2" id="text-org655365f">
<p>This is a look at different ways of creating and manipulating graphs using <a href="https://networkx.github.io">NetworkX</a>.</p>
</div>
<div class="outline-3" id="outline-container-orgbda8c92">
<h3 id="orgbda8c92">Imports</h3>
<div class="outline-text-3" id="text-orgbda8c92"></div>
<div class="outline-4" id="outline-container-org2eb1683">
<h4 id="org2eb1683">Python</h4>
<div class="outline-text-4" id="text-org2eb1683">
<div class="highlight">
<pre><span></span>from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgd524745">
<h4 id="orgd524745">PyPi</h4>
<div class="outline-text-4" id="text-orgd524745">
<div class="highlight">
<pre><span></span>from bokeh.models import HoverTool
import holoviews
import hvplot.pandas
import networkx
import numpy
import pandas
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org37771fe">
<h4 id="org37771fe">My Stuff</h4>
<div class="outline-text-4" id="text-org37771fe">
<div class="highlight">
<pre><span></span>from graeae.visualization import EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org42127b5">
<h3 id="org42127b5">Set Up</h3>
<div class="outline-text-3" id="text-org42127b5">
<div class="highlight">
<pre><span></span>SLUG = "some-networkx-examples"
OUTPUT_PATH = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=OUTPUT_PATH)
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf719c5b">
<h2 id="orgf719c5b">The Initiation</h2>
<div class="outline-text-2" id="text-orgf719c5b"></div>
<div class="outline-3" id="outline-container-org813fd2f">
<h3 id="org813fd2f">Different Ways to Create Network Graphs</h3>
<div class="outline-text-3" id="text-org813fd2f">
<p><b>NetworkX</b> has a few different ways to create graphs, some more flexible than others. This is a non-exhaustive showing of some of them.</p>
</div>
<div class="outline-4" id="outline-container-org860d460">
<h4 id="org860d460">Adding Edges To An Existing Graph</h4>
<div class="outline-text-4" id="text-org860d460">
<p>You can create a graph using the graph constructors. This is an example of an undirected <a href="https://networkx.github.io/documentation/stable/reference/classes/graph.html">Graph</a>.</p>
<div class="highlight">
<pre><span></span>graph_1 = networkx.Graph()
</pre></div>
<div class="highlight">
<pre><span></span>G1.add_edges_from([(0, 1),
                   (0, 2),
                   (0, 3),
                   (0, 5),
                   (1, 3),
                   (1, 6),
                   (3, 4),
                   (4, 5),
                   (4, 7),
                   (5, 8),
                   (8, 9)])

networkx.draw_networkx(G1)
</pre></div>
<div class="figure">
<p><img alt="graph_one.png" src="file:///tmp/graph_one.png"></p>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org8baf85a">
<h4 id="org8baf85a">Adjacency List</h4>
<div class="outline-text-4" id="text-org8baf85a">
<div class="highlight">
<pre><span></span>with open("G_adjlist.txt") as reader:
    print(reader.read())
</pre></div>
<div class="highlight">
<pre><span></span>G2 = networkx.read_adjlist('G_adjlist.txt', nodetype=int)
G2.edges()
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgced4ac0">
<h4 id="orgced4ac0">Adjacency Matrix</h4>
<div class="outline-text-4" id="text-orgced4ac0">
<div class="highlight">
<pre><span></span>G_mat = numpy.array([[0, 1, 1, 1, 0, 1, 0, 0, 0, 0],
                     [1, 0, 0, 1, 0, 0, 1, 0, 0, 0],
                     [1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                     [1, 1, 0, 0, 1, 0, 0, 0, 0, 0],
                     [0, 0, 0, 1, 0, 1, 0, 1, 0, 0],
                     [1, 0, 0, 0, 1, 0, 0, 0, 1, 0],
                     [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                     [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                     [0, 0, 0, 0, 0, 1, 0, 0, 0, 1],
                     [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]])
G_mat
</pre></div>
<div class="highlight">
<pre><span></span>G3 = networkx.Graph(G_mat)
G3.edges()
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org98f8245">
<h4 id="org98f8245">Edgelist</h4>
<div class="outline-text-4" id="text-org98f8245">
<div class="highlight">
<pre><span></span>with open('G_edgelist.txt') as reader:
    print(reader.read())
</pre></div>
<div class="highlight">
<pre><span></span>G4 = networkx.read_edgelist('G_edgelist.txt', data=[('Weight', int)])

G4.edges(data=True)
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org1e609e0">
<h4 id="org1e609e0">Pandas DataFrame</h4>
<div class="outline-text-4" id="text-org1e609e0">
<div class="highlight">
<pre><span></span>G_df = pandas.read_csv('G_edgelist.txt', delim_whitespace=True, 
                       header=None, names=['n1', 'n2', 'weight'])
G_df
</pre></div>
<div class="highlight">
<pre><span></span>G5 = networkx.from_pandas_dataframe(G_df, 'n1', 'n2', edge_attr='weight')
G5.edges(data=True)
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org0a0aa7b">
<h3 id="org0a0aa7b">A Chess Example</h3>
<div class="outline-text-3" id="text-org0a0aa7b">
<div class="highlight">
<pre><span></span>with open('chess_graph.txt') as reader:
    count = 0
    for line in reader:
        print(line.strip())
        count += 1
        if count == 5:
            break
</pre></div>
<div class="highlight">
<pre><span></span>chess = networkx.read_edgelist('chess_graph.txt', data=[('outcome', int), ('timestamp', float)], 
                         create_using=networkx.MultiDiGraph())
</pre></div>
<div class="highlight">
<pre><span></span>chess.is_directed(), chess.is_multigraph()
</pre></div>
<div class="highlight">
<pre><span></span>chess.edges(data=True)[:5]
</pre></div>
<div class="highlight">
<pre><span></span>games_played = chess.degree()
games_played
</pre></div>
<div class="highlight">
<pre><span></span>max_value = max(games_played.values())
max_key, = [i for i in games_played.keys() if games_played[i] == max_value]

print('player {}\n{} games'.format(max_key, max_value))
</pre></div>
<div class="highlight">
<pre><span></span>df = pd.DataFrame(chess.edges(data=True), columns=['white', 'black', 'outcome'])
df.head()
</pre></div>
<div class="highlight">
<pre><span></span>df['outcome'] = df['outcome'].map(lambda x: x['outcome'])
df.head()
</pre></div>
<div class="highlight">
<pre><span></span>won_as_white = df[df['outcome']==1].groupby('white').sum()
won_as_black = df[df['outcome']==-1].groupby('black').sum()
win_count = won_as_white.add(won_as_black, fill_value=0)
print(win_count.head())
</pre></div>
<div class="highlight">
<pre><span></span>win_count.nlargest(5, 'outcome')
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb187ad2">
<h2 id="orgb187ad2">The Return</h2>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="/posts/networks/company-movie-night/">Company Movie Night</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="/posts/networks/company-movie-night/" rel="bookmark"><time class="published dt-published" datetime="2019-04-11T13:04:23-07:00" itemprop="datePublished" title="2019-04-11 13:04">2019-04-11 13:04</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="/posts/networks/company-movie-night/#org7a2ee65">The Departure</a>
<ul>
<li><a href="/posts/networks/company-movie-night/#org4a2dc7b">Imports</a></li>
<li><a href="/posts/networks/company-movie-night/#org40a59f9">Set Up</a></li>
<li><a href="/posts/networks/company-movie-night/#org417b0b6">The Plotting</a></li>
</ul>
</li>
<li><a href="/posts/networks/company-movie-night/#orgd1f0c41">The Initiation</a>
<ul>
<li><a href="/posts/networks/company-movie-night/#org2146ef1">The Data</a></li>
<li><a href="/posts/networks/company-movie-night/#org7d75fec">Plotting</a></li>
<li><a href="/posts/networks/company-movie-night/#org99c6a5d">Question 2</a></li>
<li><a href="/posts/networks/company-movie-night/#orgfb6444d">Question 3</a></li>
<li><a href="/posts/networks/company-movie-night/#orgfb5a9c0">Question 4</a></li>
</ul>
</li>
<li><a href="/posts/networks/company-movie-night/#org89551da">The Return</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org7a2ee65">
<h2 id="org7a2ee65">The Departure</h2>
<div class="outline-text-2" id="text-org7a2ee65">
<p>This is a look at working with networks using <a href="https://networkx.github.io">networkx</a>. Our scene - eight employees are trying to choose three movies to watch for company movie nights. We have two sources of data - the <i>candidate movies</i> and the <i>relationship</i> between pairs of employees. The relationships are on a scale from -100 to 100, with -100 being the strongest of enemies and 100 meaning they are best of friends. Zero either means they have no relationship (don't interact) or are indifferent about the other person.</p>
</div>
<div class="outline-3" id="outline-container-org4a2dc7b">
<h3 id="org4a2dc7b">Imports</h3>
<div class="outline-text-3" id="text-org4a2dc7b"></div>
<div class="outline-4" id="outline-container-org04c33ca">
<h4 id="org04c33ca">From Python</h4>
<div class="outline-text-4" id="text-org04c33ca">
<div class="highlight">
<pre><span></span>from argparse import Namespace
from functools import partial
from pathlib import Path
import copy
import os
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgb462b4c">
<h4 id="orgb462b4c">From PyPi</h4>
<div class="outline-text-4" id="text-orgb462b4c">
<div class="highlight">
<pre><span></span>from dotenv import load_dotenv
from bokeh.models import (
    BoxSelectTool,
    Circle,
    HoverTool, 
    MultiLine,
    PanTool,
    Range1d,
    TapTool,
    WheelZoomTool,
)
from bokeh.models import Plot as BokehPlot
from bokeh.models.graphs import (from_networkx, 
                                 EdgesAndLinkedNodes, 
                                 NodesAndLinkedEdges)
from bokeh.palettes import RdBu, Spectral4
from bokeh.transform import linear_cmap
import holoviews
from holoviews import dim
import hvplot.pandas
import networkx
import pandas
import numpy
from networkx.algorithms import bipartite
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org81d5064">
<h4 id="org81d5064">My Stuff</h4>
<div class="outline-text-4" id="text-org81d5064">
<div class="highlight">
<pre><span></span>from graeae.visualization import EmbedBokeh, EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org40a59f9">
<h3 id="org40a59f9">Set Up</h3>
<div class="outline-text-3" id="text-org40a59f9"></div>
<div class="outline-4" id="outline-container-org5717df7">
<h4 id="org5717df7">Load Dotenv</h4>
<div class="outline-text-4" id="text-org5717df7">
<div class="highlight">
<pre><span></span>load_dotenv(".env", override=True)
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org417b0b6">
<h3 id="org417b0b6">The Plotting</h3>
<div class="outline-text-3" id="text-org417b0b6">
<div class="highlight">
<pre><span></span>SLUG = 'company-movie-night/'
OUTPUT = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=OUTPUT)
EmbedB = partial(EmbedBokeh, folder_path=OUTPUT)
holoviews.extension("bokeh")
</pre></div>
<div class="highlight">
<pre><span></span>Plot = Namespace(
    node_size=15,
    edge_alpha=0.8,
    edge_color="#CCCCCC",
    edge_width=5,
    width=800,
    height=800,
    fontsize=18,
    padding=dict(x=(-1, 1), y=(-1, 1))
)
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgd1f0c41">
<h2 id="orgd1f0c41">The Initiation</h2>
<div class="outline-text-2" id="text-orgd1f0c41"></div>
<div class="outline-3" id="outline-container-org2146ef1">
<h3 id="org2146ef1">The Data</h3>
<div class="outline-text-3" id="text-org2146ef1"></div>
<div class="outline-4" id="outline-container-orgfb6331c">
<h4 id="orgfb6331c">This Is the Set Of Employee-Relationships</h4>
<div class="outline-text-4" id="text-orgfb6331c">
<div class="highlight">
<pre><span></span>employee_relationships_path = Path(os.environ.get("EMPLOYEE_RELATIONSHIPS"))
relationships_data = pandas.read_csv(
    employee_relationships_path, 
    delimiter="\t", 
    header=None,
    names="employee_1 employee_2 relationship".split())
</pre></div>
<div class="highlight">
<pre><span></span>table = holoviews.Table(relationships_data).opts(height=Plot.height)
Embed(plot=table, file_name="relationships_data")()
</pre></div>
<object data="/posts/networks/company-movie-night/relationships_data.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>employees = set(relationships_data.employee_1.unique()) | set(relationships_data.employee_2.unique())
print(employees)
</pre></div>
<pre class="example">
{'Pablo', 'Georgia', 'Andy', 'Claude', 'Vincent', 'Joan', 'Lee', 'Frida'}

</pre>
<div class="highlight">
<pre><span></span>print(len(employees))
</pre></div>
<pre class="example">
8

</pre>
<div class="highlight">
<pre><span></span>print(len(relationships_data))
</pre></div>
<pre class="example">
28

</pre>
<p>We have eight employees and twenty-eight links. Is this a fully connected graph? The handshake problem says that the amount of links in a fully-connected network is:</p>
<p>\[ links = \frac{n(n-1)}{2} \]</p>
<div class="highlight">
<pre><span></span>print(len(employees) * (len(employees) - 1)/2)
</pre></div>
<pre class="example">
28.0

</pre>
<p>It looks like our relationships data creates a fully-connected network (unless there is a duplicate which would be an error).</p>
</div>
</div>
<div class="outline-4" id="outline-container-org497717f">
<h4 id="org497717f">These Are the Movie Choices</h4>
<div class="outline-text-4" id="text-org497717f">
<div class="highlight">
<pre><span></span>employee_movies_path = Path(os.environ.get("EMPLOYEE_MOVIE_CHOICES"))
movies_data = pandas.read_csv(
    employee_movies_path, 
    delimiter="\t", 
    header=None,
    skiprows=1,
    names="employee movie".split())
print(f"Employee To Movie Edges: {len(movies_data)}")
print(movies_data.head())
</pre></div>
<pre class="example">
Employee To Movie Edges: 24
  employee                            movie
0     Andy                         Anaconda
1     Andy                       Mean Girls
2     Andy                       The Matrix
3   Claude                         Anaconda
4   Claude  Monty Python and the Holy Grail

</pre>
<div class="highlight">
<pre><span></span>movies = set(movies_data.movie.unique())
for movie in sorted(movies):
    print(f" - {movie}")
</pre></div>
<ul class="org-ul">
<li>Anaconda</li>
<li>Forrest Gump</li>
<li>Kung Fu Panda</li>
<li>Mean Girls</li>
<li>Monty Python and the Holy Grail</li>
<li>Snakes on a Plane</li>
<li>The Dark Knight</li>
<li>The Godfather</li>
<li>The Matrix</li>
<li>The Shawshank Redemption</li>
<li>The Social Network</li>
</ul>
<p>The eight employees chose 11 movies between them.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org37e00b3">
<h4 id="org37e00b3">Converting the DataFrames to Graphs</h4>
<div class="outline-text-4" id="text-org37e00b3"></div>
<div class="outline-5" id="outline-container-orgbacc1e8">
<h5 id="orgbacc1e8">The Relationship Graph</h5>
<div class="outline-text-5" id="text-orgbacc1e8">
<div class="highlight">
<pre><span></span>relationship_graph = networkx.from_pandas_edgelist(relationships_data, 
                                                   "employee_1", "employee_2", 
                                                   edge_attr="relationship")
for index, row in relationships_data.sample(5).iterrows():
    assert relationship_graph[row["employee_1"]][row["employee_2"]]["relationship"] == row["relationship"]
</pre></div>
<div class="highlight">
<pre><span></span>expected_edges = len(relationships_data)
expected_nodes = len(employees)
print("Expected Edges: {}".format(expected_edges))
print("Expected Nodes: {}".format(expected_nodes))
assert expected_nodes == len(relationship_graph.nodes)
assert expected_edges == len(relationship_graph.edges)
</pre></div>
<pre class="example">
Expected Edges: 28
Expected Nodes: 8

</pre></div>
</div>
<div class="outline-5" id="outline-container-org19bbcc6">
<h5 id="org19bbcc6">The Movie Graph</h5>
<div class="outline-text-5" id="text-org19bbcc6">
<div class="highlight">
<pre><span></span>movie_graph = networkx.from_pandas_edgelist(movies_data, "employee", "movie")
</pre></div>
<div class="highlight">
<pre><span></span>for index, row in movies_data.iterrows():
    movie_graph[row.employee][row.movie]["employee"] = row.employee
    movie_graph[row.employee][row.movie]["movie"] = row.movie

for employee in movies_data.employee:    
    movie_graph.nodes[employee]["type"] = "employee"
for movie in movies_data.movie:
    movie_graph.nodes[movie]["type"] = "movie"
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org7d75fec">
<h3 id="org7d75fec">Plotting</h3>
<div class="outline-text-3" id="text-org7d75fec">
<div class="highlight">
<pre><span></span>def graph_plot(graph: networkx.Graph, 
               title:str,
               file_name: str,
               hover: HoverTool,
               layout=networkx.circular_layout) -&gt; None:
    """Plot the graph in bokeh

    Args:
     graph: the graph to plot
     layout: function to layout the plot
     title: title for the plot
     hover: defined hover tool
     file_name: name to save the bokeh file (without extension)
    """
    plot = BokehPlot(plot_width=Plot.width,
                     plot_height=Plot.height,
                     x_range=Range1d(-1, 1),
                     y_range=Range1d(-1, 1)
    )

    plot.title.text = title
    plot.title.text_font_size = f"{Plot.fontsize}pt"
    plot.add_tools(hover, TapTool(), BoxSelectTool(), PanTool(), WheelZoomTool())

    renderer = from_networkx(relationship_graph, layout, 
                             scale=1, center=(0,0))
    renderer.node_renderer.glyph = Circle(size=Plot.node_size, 
                                          fill_color=Spectral4[0])
    renderer.node_renderer.selection_glyph = Circle(size=Plot.node_size, 
                                                    fill_color=Spectral4[2])
    renderer.node_renderer.hover_glyph = Circle(size=Plot.node_size, 
                                                fill_color=Spectral4[1])

    color_map = linear_cmap(field_name="relationship", 
                            palette=RdBu[11], 
                            low=100, high=-100)
    renderer.edge_renderer.glyph = MultiLine(line_color=color_map, 
                                             line_alpha=0.5,
                                             line_width=3)
    renderer.edge_renderer.selection_glyph = MultiLine(line_color=color_map, 
                                                       line_width=Plot.edge_width)
    renderer.edge_renderer.hover_glyph = MultiLine(line_color=color_map, 
                                                   line_width=Plot.edge_width)
    renderer.selection_policy = NodesAndLinkedEdges()
    renderer.inspection_policy = EdgesAndLinkedNodes()
    plot.renderers.append(renderer)
    EmbedB(plot=plot, file_name=file_name)()
    return
</pre></div>
<div class="highlight">
<pre><span></span>class RelationshipGraphPlot:
    """Plots a graph and keeps the parts so you can inspect them

    Args:
     graph: the graph to plot
     layout: function to layout the plot
     title: title for the plot
     hover: defined hover tool
     settings: namespace with the plot settings
     file_name: name to save the bokeh file (without extension)
    """
    def __init__(self, graph: networkx.Graph, 
                 title:str,
                 file_name: str,
                 hover: HoverTool,
                 settings: Namespace=Plot,
                 layout=networkx.circular_layout) -&gt; None:
        self.graph = graph
        self.title = title
        self.file_name = file_name
        self.hover = hover
        self.settings = settings
        self.layout = layout
        self._tap_tool = None
        self._box_select_tool = None
        self._pan_tool = None
        self._wheel_zoom_tool = None
        self._plot = None
        self._renderer = None
        self._color_map = None
        return

    @property
    def tap_tool(self) -&gt; TapTool:
        if self._tap_tool is None:
            self._tap_tool = TapTool()
        return self._tap_tool

    @property
    def box_select_tool(self) -&gt; BoxSelectTool:
        if self._box_select_tool is None:
            self._box_select_tool = BoxSelectTool()
        return self._box_select_tool

    @property
    def pan_tool(self) -&gt; PanTool:
        if self._pan_tool is None:
            self._pan_tool = PanTool()
        return self._pan_tool

    @property
    def wheel_zoom_tool(self) -&gt; WheelZoomTool:
        if self._wheel_zoom_tool is None:
            self._wheel_zoom_tool = WheelZoomTool()
        return self._wheel_zoom_tool

    @property
    def plot(self) -&gt; BokehPlot:
        if self._plot is None:
            self._plot = BokehPlot(plot_width=self.settings.width,
                                   plot_height=self.settings.height,
                                   x_range=Range1d(-1, 1),
                                   y_range=Range1d(-1, 1)
            )

            self._plot.title.text = self.title
            self._plot.title.text_font_size = f"{Plot.fontsize}pt"
            self._plot.add_tools(self.hover, 
                                 self.tap_tool, 
                                 self.box_select_tool, 
                                 self.pan_tool,
                                 self.wheel_zoom_tool)
            self._plot.renderers.append(self.renderer)
        return self._plot

    @property
    def color_map(self):
        if self._color_map is None:
            self._color_map = linear_cmap(field_name="relationship", 
                                          palette=RdBu[11], 
                                          low=100, high=-100)
        return self._color_map

    @property
    def renderer(self):
        if self._renderer is None:
            self._renderer = from_networkx(self.graph, self.layout, 
                                          scale=1, center=(0,0))
            self._renderer.node_renderer.glyph = Circle(
                size=Plot.node_size, 
                fill_color=Spectral4[0])
            self._renderer.node_renderer.selection_glyph = Circle(
                size=Plot.node_size, 
                fill_color=Spectral4[2])
            self._renderer.node_renderer.hover_glyph = Circle(
                size=Plot.node_size, 
                fill_color=Spectral4[1])

            self._renderer.edge_renderer.glyph = MultiLine(
                line_color=self.color_map, 
                line_alpha=0.5,
                line_width=3)
            self._renderer.edge_renderer.selection_glyph = MultiLine(
                line_color=self.color_map, 
                line_width=Plot.edge_width)
            self._renderer.edge_renderer.hover_glyph = MultiLine(
                line_color=self._color_map,
                line_width=Plot.edge_width)
            self._renderer.selection_policy = NodesAndLinkedEdges()
            self._renderer.inspection_policy = EdgesAndLinkedNodes()
        return self._renderer

    def __call__(self) -&gt; None:
        EmbedB(plot=self.plot, file_name=self.file_name)()
        return
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgf8f1ad6">
<h4 id="orgf8f1ad6">The Employee Relationship Plot</h4>
<div class="outline-text-4" id="text-orgf8f1ad6"></div>
<div class="outline-5" id="outline-container-orga444fca">
<h5 id="orga444fca">HoloViews</h5>
<div class="outline-text-5" id="text-orga444fca">
<p>The employee relationship graph consists of employees as nodes and their relationshp-level as weights on the edges.</p>
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(relationship_graph,
                                     networkx.circular_layout).opts(
                                         cmap="Set1",
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,
                                         title="Company Relationship Graph",
                                         xaxis=None, yaxis=None).options(
                                             edge_color_index="relationship", 
                                             edge_cmap="Spectral").redim.range(**Plot.padding)
renderer = holoviews.render(plot)
renderer.renderers[-1].selection_policy = EdgesAndLinkedNodes()
EmbedB(plot=renderer, file_name="employee_relationships")()
</pre></div>
<script id="620da89f-412b-4c15-b555-58f0dd1c4fd8" src="/posts/networks/company-movie-night/employee_relationships"></script>
<div class="outline-5" id="outline-container-orga813678">
<h5 id="orga813678">Bokeh</h5>
<div class="outline-text-5" id="text-orga813678">
<p>This is the same plot using <a href="https://bokeh.pydata.org/en/latest/">bokeh</a> directly instead of holoviews. I wanted both the nodes and edges to trigger the <code>HoverTool</code> but HoloViews doesn't support this. There might be a way to add it later, but their documentation is so opaque that I decided it wasn't worth it to keep trying to figure it out, since bokeh isn't that hard to use (although their documentation isn't the best either).</p>
<p>Since bokeh is so verbose I'm going to step through this instead of putting it into one block.</p>
</div>
<div class="outline-6" id="outline-container-org95bf9b7">
<h6 id="org95bf9b7">Hover Tool</h6>
<div class="outline-text-6" id="text-org95bf9b7">
<p>When the <code>EdgesAndLinkedNodes</code> class is used only the edge data is available to the hovertool (or at least I couldn't figure out how to make the Node attributes work). So these have to be available to it. You can see what's available once you've created the graph renderer (the output of <code>from_networkx</code>) by looking at one of the data attributes</p>
<pre class="example">
renderer.edge_renderer.data_source.data.keys()
</pre>
<p>Which in this case returned this.</p>
<pre class="example">
dict_keys(['relationship', 'start', 'end'])
</pre>
<p><code>relationship</code> was a data-attribute I added through <code>networkx</code>, something else (presumably bokeh) created the start and end.</p>
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips=[
        ("Employee", "@start"),
        ("Employee", "@end"),
        ("Relationship", "@relationship"),
    ]
)
</pre></div>
</div>
</div>
<div class="outline-6" id="outline-container-org5349ee4">
<h6 id="org5349ee4">The Plot</h6>
<div class="outline-text-6" id="text-org5349ee4">
<p>This is the bokeh plot (I don't know how it differs from a figure). It's normally called <code>Plot</code> but I already used that name for my settings object so I called it <code>BokehPlot</code>.</p>
<div class="highlight">
<pre><span></span>plot = BokehPlot(plot_width=Plot.width,
                 plot_height=Plot.height,
                 x_range=Range1d(-1, 1),
                 y_range=Range1d(-1, 1)
)

plot.title.text = "Company Relationships"
plot.title.text_font_size = f"{Plot.fontsize}pt"
plot.add_tools(hover, TapTool(), BoxSelectTool(), PanTool(), WheelZoomTool())
</pre></div>
</div>
</div>
<div class="outline-6" id="outline-container-org8030358">
<h6 id="org8030358">The Graph Renderer</h6>
<div class="outline-text-6" id="text-org8030358">
<p>This part converts the networkx Graph into a bokeh Graph. This is what I was referring to earlier when I talked about inspecting the <code>renderer</code> to look at the available edge attributes.</p>
<div class="highlight">
<pre><span></span>renderer = from_networkx(relationship_graph, networkx.circular_layout, 
                         scale=1, center=(0,0))
</pre></div>
</div>
</div>
<div class="outline-6" id="outline-container-orgb54bfe1">
<h6 id="orgb54bfe1">Nodes</h6>
<div class="outline-text-6" id="text-orgb54bfe1">
<p>You have to set up the shapes for the nodes - I think - there might be defaults but the few examples I found set it up. It's probably not a bad idea in any case. The <code>Spectral4</code> object is a list of four hex-colors. Here's the ones I used.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Object</th>
<th class="org-right" scope="col">Index</th>
<th class="org-left" scope="col">Color</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">glyph</td>
<td class="org-right">0</td>
<td class="org-left">Medium Blue</td>
</tr>
<tr>
<td class="org-left">selection_glyph</td>
<td class="org-right">2</td>
<td class="org-left">Orange</td>
</tr>
<tr>
<td class="org-left">hover_glyph</td>
<td class="org-right">1</td>
<td class="org-left">Pastel Green</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span>renderer.node_renderer.glyph = Circle(size=Plot.node_size, fill_color=Spectral4[0])
renderer.node_renderer.selection_glyph = Circle(size=Plot.node_size, fill_color=Spectral4[2])
renderer.node_renderer.hover_glyph = Circle(size=Plot.node_size, fill_color=Spectral4[1])
</pre></div>
</div>
</div>
<div class="outline-6" id="outline-container-org0d8693a">
<h6 id="org0d8693a">Color Map</h6>
<div class="outline-text-6" id="text-org0d8693a">
<p>The <code>linear_cmap</code> maps a range of values to a palette of colors. In this case I'm mapping the relationship values to the red-blue palette (<code>RdBu</code>). Two things to note:</p>
<ul class="org-ul">
<li>I chose a red-blue palette with 11 values because the odd-number puts white at the center (it goes from blue to white to red)</li>
<li>Althouh the name suggests a palette form red to blue it goes from blue to red so I had to make -100 the 'high' value so red would be a bad relationship.</li>
</ul>
<div class="highlight">
<pre><span></span>color_map = linear_cmap(field_name="relationship", palette=RdBu[11], low=100, high=-100)
</pre></div>
</div>
</div>
<div class="outline-6" id="outline-container-orgef7d5cf">
<h6 id="orgef7d5cf">The Edges</h6>
<div class="outline-text-6" id="text-orgef7d5cf">
<p>Like the nodes you define the edges for the plot. This is where we get to use the color-map to make the edges match the relationship between the employees.</p>
<div class="highlight">
<pre><span></span>renderer.edge_renderer.glyph = MultiLine(line_color=color_map, 
                                         line_alpha=0.5,
                                         line_width=3)
renderer.edge_renderer.selection_glyph = MultiLine(line_color=color_map, 
                                                   line_width=Plot.edge_width)
renderer.edge_renderer.hover_glyph = MultiLine(line_color=color_map, 
                                               line_width=Plot.edge_width)
</pre></div>
</div>
</div>
<div class="outline-6" id="outline-container-org2c5a41f">
<h6 id="org2c5a41f">The Selection and Inspection Policies</h6>
<div class="outline-text-6" id="text-org2c5a41f">
<p>This was the reason for doing it in bokeh in the first place. Adding these two lines makes both the edge and attached notes highlight when selected or hovered over.</p>
<div class="highlight">
<pre><span></span>renderer.selection_policy = NodesAndLinkedEdges()
renderer.inspection_policy = EdgesAndLinkedNodes()
</pre></div>
</div>
</div>
<div class="outline-6" id="outline-container-org90e3641">
<h6 id="org90e3641">Put It All Together</h6>
<div class="outline-text-6" id="text-org90e3641">
<p>Now we just add the graph-renderer to the plot and have bokeh convert it to JavaScript and HTML.</p>
<div class="highlight">
<pre><span></span>plot.renderers.append(renderer)
EmbedB(plot=plot, file_name="company_relationships_bokeh")()
</pre></div>
<script id="b871a597-f39e-4ca0-9303-dffb029b90ec" src="posts/networks/company-movie-night/company_relationships_bokeh"></script>
<p>It looks like Andy might have some kind of personality problem (maybe he's the boss), while Georgia and Claude are unusually close.</p>
</div>
</div>
</div>
<div class="outline-5" id="outline-container-orgb88265a">
<h5 id="orgb88265a">Spring loaded</h5>
<div class="outline-text-5" id="text-orgb88265a">
<p>Bokeh raises an error if you try to re-use the hover-tool for some reason so I had to make a copy.</p>
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips=[
        ("Employee", "@start"),
        ("Employee", "@end"),
        ("Relationship", "@relationship"),
    ]
)

graph_plot(relationship_graph, 
           "Company Relationships", 
           "company_relationships_spring", 
           hover,
           networkx.spring_layout)
</pre></div>
<script id="b9aee303-a400-4bef-a454-729bba29b2b5" src="posts/networks/company-movie-night/company_relationships_spring"></script>
<p>This didn't produce as interesting a result as I thought.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org2dc0c64">
<h4 id="org2dc0c64">The Movie Plot</h4>
<div class="outline-text-4" id="text-org2dc0c64">
<div class="highlight">
<pre><span></span>movie_hover = HoverTool(
    tooltips = [
        ("Employee", "@employee"),
        ("Movie", "@movie"),
    ]

)
plot = holoviews.Graph.from_networkx(movie_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("type"),
                                         cmap="Set1",
                                         fontsize=Plot.fontsize,
                                         width=Plot.width,
                                         height=Plot.height,
                                         tools=[movie_hover, TapTool()],
                                         title="Company Movies Graph",
                                         xaxis=None, yaxis=None).options(
                                             inspection_policy="edges",
                                             edge_cmap="Spectral").redim.range(**Plot.padding)
Embed(plot=plot, file_name="company_movies_circle")()
</pre></div>
<object data="posts/networks/company-movie-night/company_movies_circle.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>The Blue nodes are employees and the red nodes are movies.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org99c6a5d">
<h3 id="org99c6a5d">Question 2</h3>
<div class="outline-text-3" id="text-org99c6a5d">
<p>Using the graph from the previous question, add nodes attributes named `'type'` where movies have the value `'movie'` and employees have the value `'employee'` and return that graph.</p>
<p><b>This function should return a networkx graph with node attributes `{'type': 'movie'}` or `{'type': 'employee'}`</b></p>
<div class="highlight">
<pre><span></span>def answer_two():
    """Adds 'type' to nodes from movie-graph

    Returns:
     Graph: answer_one with 'type' attribute added (employee or movie)
    """
    graph = answer_one()
    new_graph = networkx.Graph()
    nodes = graph.nodes()
    employee_nodes = [node for node in nodes if node in employees]
    movie_nodes = [node for node in nodes if node in movies]
    new_graph.add_nodes_from(employee_nodes, bipartite=0, type='employee')
    new_graph.add_nodes_from(movie_nodes, bipartite=1, type="movie")
    new_graph.add_edges_from(graph.edges())
    return new_graph
</pre></div>
<div class="highlight">
<pre><span></span>two = answer_two()
two.nodes(data=True)
</pre></div>
<div class="highlight">
<pre><span></span>plot_graph(two)
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgfb6444d">
<h3 id="orgfb6444d">Question 3</h3>
<div class="outline-text-3" id="text-orgfb6444d">
<p>Find a weighted projection of the graph from `answer_two` which tells us how many movies different pairs of employees have in common.</p>
<p><b>This function should return a weighted projected graph.</b></p>
<div class="highlight">
<pre><span></span>def answer_three():
    graph = answer_two()
    assert networkx.is_bipartite(graph)
    return bipartite.weighted_projected_graph(graph, employees)
</pre></div>
<div class="highlight">
<pre><span></span>three = answer_three()
plot_graph(three)
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgfb5a9c0">
<h3 id="orgfb5a9c0">Question 4</h3>
<div class="outline-text-3" id="text-orgfb5a9c0">
<p>Suppose you'd like to find out if people that have a high relationship score also like the same types of movies.</p>
<p>Find the Pearson correlation ( using `DataFrame.corr()` ) between employee relationship scores and the number of movies they have in common. If two employees have no movies in common it should be treated as a 0, not a missing value, and should be included in the correlation calculation.</p>
<p><b>This function should return a float.</b></p>
<div class="highlight">
<pre><span></span>def answer_four():
    """calculates the pearson correlation for data

    Returns:
     float: Pearson correlation for weight and relationship_score
    """
    three = answer_three()
    relationships = pandas.read_table(
        "Employee_Relationships.txt",
        names="employee_left employee_right relationship_score".split())
    relationships["employees"] = relationships.apply(
        lambda row: tuple(sorted((row["employee_left"],
                                  row['employee_right']))), axis=1)

    weights = pandas.DataFrame(
        three.edges(data=True),
        columns="employee_left employee_right weight".split())
    weights["weight"] = weights.weight.map(lambda row: row["weight"])
    weights["employees"] = weights.apply(lambda row: tuple(sorted(
        (row["employee_left"],
         row["employee_right"]))),
                                         axis=1)

    joined = pandas.merge(relationships, weights, how="outer", 
                          on=['employees'])
    assert len(joined) == len(relationships)
    joined['weight'] = joined["weight"].fillna(0)

    data = joined[["relationship_score", "weight"]]
    correlation = data.corr()
    return correlation.relationship_score.weight
</pre></div>
<div class="highlight">
<pre><span></span>print(answer_four())
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org89551da">
<h2 id="org89551da">The Return</h2>
</div>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/libraries/prophet/getting-started-with-prophet/">Getting Started With Prophet</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/libraries/prophet/getting-started-with-prophet/" rel="bookmark"><time class="published dt-published" datetime="2019-04-05T14:53:40-07:00" itemprop="datePublished" title="2019-04-05 14:53">2019-04-05 14:53</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#org4a69545">The Departure</a>
<ul>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#org8eb0ac5">Imports</a></li>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#org40e40e6">Setup</a></li>
</ul>
</li>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#org4e736b5">The Initiation</a>
<ul>
<li><a href="posts/libraries/prophet/getting-started-with-prophet/#org048dec8">Load The Data</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org4a69545">
<h2 id="org4a69545">The Departure</h2>
<div class="outline-text-2" id="text-org4a69545">
<p>This is a first look at <a href="https://facebook.github.io/prophet/">Prophet</a> a time-series forecasting library. It depends on <code>pystan</code>, a Bayesian modelling platform, which in turn depends on <code>numpy</code> and <code>cython</code>.</p>
</div>
<div class="outline-3" id="outline-container-org8eb0ac5">
<h3 id="org8eb0ac5">Imports</h3>
<div class="outline-text-3" id="text-org8eb0ac5"></div>
<div class="outline-4" id="outline-container-orge35b206">
<h4 id="orge35b206">Python</h4>
<div class="outline-text-4" id="text-orge35b206">
<div class="highlight">
<pre><span></span>from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org74c214b">
<h4 id="org74c214b">PyPi</h4>
<div class="outline-text-4" id="text-org74c214b">
<div class="highlight">
<pre><span></span>from dotenv import load_dotenv
import modin.pandas as pandas
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org52d57bc">
<h4 id="org52d57bc">My Stuff</h4>
<div class="outline-text-4" id="text-org52d57bc">
<div class="highlight">
<pre><span></span>from graeae.timers import Timer
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org40e40e6">
<h3 id="org40e40e6">Setup</h3>
<div class="outline-text-3" id="text-org40e40e6"></div>
<div class="outline-4" id="outline-container-orgc11b25b">
<h4 id="orgc11b25b">The Paths</h4>
<div class="outline-text-4" id="text-orgc11b25b">
<div class="highlight">
<pre><span></span>load_dotenv(".env", override=True)
DATA = Path(os.environ.get("PEYTON_MANNING_WIKIPEDIA_VIEWS")).expanduser()
assert DATA.is_file()
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org68fb088">
<h4 id="org68fb088">The Timer</h4>
<div class="outline-text-4" id="text-org68fb088">
<div class="highlight">
<pre><span></span>TIMER = Timer()
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org4e736b5">
<h2 id="org4e736b5">The Initiation</h2>
<div class="outline-text-2" id="text-org4e736b5"></div>
<div class="outline-3" id="outline-container-org048dec8">
<h3 id="org048dec8">Load The Data</h3>
<div class="outline-text-3" id="text-org048dec8">
<div class="highlight">
<pre><span></span>with TIMER:
    data = pandas.read_csv(DATA)
print(data.shape)
</pre></div>
<pre class="example">
WARNING: Falling back to serializing objects of type &lt;class 'pathlib.PosixPath'&gt; by using pickle. This may be inefficient.
Started: 2019-04-05 15:23:56.038686
Ended: 2019-04-05 15:23:56.236422
Elapsed: 0:00:00.197736
(2905, 2)

</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/high-school-contact-networks/">High School Contact Networks</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/high-school-contact-networks/" rel="bookmark"><time class="published dt-published" datetime="2019-03-27T17:38:17-07:00" itemprop="datePublished" title="2019-03-27 17:38">2019-03-27 17:38</time> <span class="updated">(updated <time class="dt-updated" datetime="2019-03-27T00:11:17-07:00" itemprop="dateUpdated" title="2019-03-27 00:11">2019-03-27 00:11</time>)</span></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/high-school-contact-networks/#org20fbf57">The Departure</a>
<ul>
<li><a href="posts/networks/high-school-contact-networks/#orgc25f1f5">Setup The Plotting</a></li>
<li><a href="posts/networks/high-school-contact-networks/#org9d91518">Load The Data</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-contact-networks/#org2a8a880">The Descent</a></li>
<li><a href="posts/networks/high-school-contact-networks/#org765ff5f">End</a>
<ul>
<li><a href="posts/networks/high-school-contact-networks/#org5e8e23a">Citations</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org20fbf57">
<h2 id="org20fbf57">The Departure</h2>
<div class="outline-text-2" id="text-org20fbf57">
<p>This looks at data provided by <a href="http://www.sociopatterns.org">SocioPatterns</a> that looks a the interactions between students at a High School in Marseilles, France, in December of 2013.</p>
</div>
<div class="outline-4" id="outline-container-orga4fd167">
<h4 id="orga4fd167">Imports</h4>
<div class="outline-text-4" id="text-orga4fd167"></div>
<div class="outline-5" id="outline-container-org05868bf">
<h5 id="org05868bf">From Python</h5>
<div class="outline-text-5" id="text-org05868bf">
<div class="highlight">
<pre><span></span>from collections import Counter
from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org4886de0">
<h5 id="org4886de0">From PyPi</h5>
<div class="outline-text-5" id="text-org4886de0">
<div class="highlight">
<pre><span></span>from bokeh.models import HoverTool
from dotenv import load_dotenv
from holoviews import dim, opts
from holoviews.operation.datashader import datashade, bundle_graph
import holoviews
import hvplot.pandas
import networkx
import pandas as pandas
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org8ba3228">
<h5 id="org8ba3228">My Stuff</h5>
<div class="outline-text-5" id="text-org8ba3228">
<div class="highlight">
<pre><span></span>from graeae.timers import Timer
from graeae.visualization import EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org0d10c07">
<h4 id="org0d10c07">Load the Dotenv</h4>
<div class="outline-text-4" id="text-org0d10c07">
<div class="highlight">
<pre><span></span>load_dotenv(".env")
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgcb652e5">
<h4 id="orgcb652e5">Build the Timer</h4>
<div class="outline-text-4" id="text-orgcb652e5">
<div class="highlight">
<pre><span></span>TIMER = Timer()
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc25f1f5">
<h3 id="orgc25f1f5">Setup The Plotting</h3>
<div class="outline-text-3" id="text-orgc25f1f5">
<div class="highlight">
<pre><span></span>holoviews.extension("bokeh")
SLUG = "high-school-contact-networks/"
output = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=output)
</pre></div>
<div class="highlight">
<pre><span></span>class Plot:
    """Constants for plotting"""
    width = 1000
    height = 800
    fontsize = 18
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org9d91518">
<h3 id="org9d91518">Load The Data</h3>
<div class="outline-text-3" id="text-org9d91518">
<p>Let's take a look at the data before loading it into pandas.</p>
<div class="highlight">
<pre><span></span>HIGH_SCHOOL = Path(os.environ.get("HIGH_SCHOOL")).expanduser()
assert HIGH_SCHOOL.is_dir()

#+begin_src ipython :session highschool :results none
class Files:
    metadata = "metadata_2013.txt"
    contact_diaries = "Contact-diaries-network_data_2013.csv"
    facebook = "Facebook-known-pairs_data_2013.csv"
    friendship = "Friendship-network_data_2013.csv"
    high_school = "High-School_data_2013.csv"
</pre></div>
</div>
<div class="outline-4" id="outline-container-orga5e9f10">
<h4 id="orga5e9f10">MetaData</h4>
<div class="outline-text-4" id="text-orga5e9f10">
<div class="highlight">
<pre><span></span>metadata_path = HIGH_SCHOOL.joinpath(Files.metadata)
assert metadata_path.is_file()
with metadata_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
650     2BIO1   F
498     2BIO1   F
627     2BIO1   F
857     2BIO1   F
487     2BIO1   F

</pre>
<p>This first file has the meta-data for the students. The three columns are the student's ID, class, and gender.</p>
<div class="highlight">
<pre><span></span>meta_data = pandas.read_csv(metadata_path, sep="\t", 
                            names=["id", "class", "gender"])
meta_data.loc[:, "class"] = meta_data["class"].astype("category")
meta_data.loc[:, "gender"] = meta_data.gender.astype("category")
</pre></div>
</div>
<div class="outline-5" id="outline-container-org842de04">
<h5 id="org842de04">Classes</h5>
<div class="outline-text-5" id="text-org842de04">
<p>First a bar-plot to look at how the classes are distributed.</p>
<div class="highlight">
<pre><span></span>grouped = meta_data.groupby(["class", "gender"]).agg(
    {"class": "count", "gender": "count"})
grouped.columns = ["class_count", "gender_count"]
grouped = grouped.reset_index()
</pre></div>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", 
                          x="class", y="class_count", 
                          stacked=True,
                          by="gender", height=Plot.height, 
                          width=Plot.width,
                          ylabel="Count",
                          xlabel="Class",
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/gender_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/gender_counts_stacked.html">Link to Plot</a></p>
<p>This is a look at the same thing except not stacked.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", x="class", 
                          y="class_count",
                          xlabel="Class",
                          ylabel="Count",
                          by="gender", height=Plot.height, width=Plot.width, 
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/gender_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/gender_counts.html">Link to Plot</a></p>
<p>Strangely, the classes that start with <code>2BIO</code> are more female while the others are more male.</p>
</div>
</div>
<div class="outline-5" id="outline-container-org85e5c17">
<h5 id="org85e5c17">Gender</h5>
<div class="outline-text-5" id="text-org85e5c17">
<p>A stacked bar plot to get a sense of not just the distribution among genders but among classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          stacked=True,
                          by="class", 
                          xlabel="Count",
                          ylabel="Gender",
                          fontsize=Plot.fontsize,
                          width=Plot.width,
                          height=Plot.height).opts(
                              xrotation=90, 
                              xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/class_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/class_counts_stacked.html">Link to Plot</a></p>
<p>A non-stacked bar plot to get a better sense of how the genders fill the different classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          xlabel="Gender",
                          ylabel="Count",
                          by="class", 
                          height=Plot.height,
                          width=Plot.width,
                          fontsize=Plot.fontsize).opts(
                              xrotation=90, xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-contact-networks/class_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><a href="posts/networks/high-school-contact-networks/class_counts.html">Link to Plot</a></p>
<p>It looks like there were a little more males than females, but not a whole lot more.</p>
</div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org2a8a880">
<h2 id="org2a8a880">The Descent</h2>
<div class="outline-text-2" id="text-org2a8a880"></div>
<div class="outline-4" id="outline-container-orga1534ae">
<h4 id="orga1534ae">The Contact Network</h4>
<div class="outline-text-4" id="text-orga1534ae">
<p>This is a dataset that shows whether a student logged contact with another student.</p>
<div class="highlight">
<pre><span></span>contact_path = HIGH_SCHOOL.joinpath(Files.contact_diaries)
assert contact_path.is_file()
with contact_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
3 28 2
3 106 1
3 147 4
3 177 1
3 295 4

</pre>
<p>The columns are the person who was making the report, the person that was identified as a contact, and the time spent ecoded into one of four values.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Code</th>
<th class="org-right" scope="col">Lower Limit (minutes)</th>
<th class="org-right" scope="col">Upper Limit (minutes)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">5</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">15</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">15</td>
<td class="org-right">60</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">60</td>
<td class="org-right">infinity</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span>contact_data = pandas.read_csv(contact_path, delimiter=" ", 
                                  names=["reporter", "contact", "time"])
contact_data = contact_data.dropna()
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org765ff5f">
<h2 id="org765ff5f">End</h2>
<div class="outline-text-2" id="text-org765ff5f"></div>
<div class="outline-3" id="outline-container-org5e8e23a">
<h3 id="org5e8e23a">Citations</h3>
<div class="outline-text-3" id="text-org5e8e23a">
<ul class="org-ul">
<li>R. Mastrandrea, J. Fournet, A. Barrat,</li>
</ul>
<p>Contact patterns in a high school: a comparison between data collected using wearable sensors, contact diaries and friendship surveys. PLoS ONE 10(9): e0136497 (2015)</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/networks/high-school-facebook-networks/">High School Facebook Networks</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/networks/high-school-facebook-networks/" rel="bookmark"><time class="published dt-published" datetime="2019-03-27T17:38:17-07:00" itemprop="datePublished" title="2019-03-27 17:38">2019-03-27 17:38</time> <span class="updated">(updated <time class="dt-updated" datetime="2019-03-27T00:11:17-07:00" itemprop="dateUpdated" title="2019-03-27 00:11">2019-03-27 00:11</time>)</span></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#orge43bcd5">The Departure</a>
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#orgc623bd1">Setup The Plotting</a></li>
<li><a href="posts/networks/high-school-facebook-networks/#org75228db">Load The Data</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-facebook-networks/#org1034723">The Descent</a></li>
<li><a href="posts/networks/high-school-facebook-networks/#orga01eb58">The Descent</a>
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#org20e7d40">Looking at the Friendship Network</a></li>
</ul>
</li>
<li><a href="posts/networks/high-school-facebook-networks/#org3cd028c">End</a>
<ul>
<li><a href="posts/networks/high-school-facebook-networks/#org166d097">Citations</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orge43bcd5">
<h2 id="orge43bcd5">The Departure</h2>
<div class="outline-text-2" id="text-orge43bcd5">
<p>This looks at data provided by <a href="http://www.sociopatterns.org">SocioPatterns</a> that looks a the interactions between students at a High School in Marseilles, France, in December of 2013.</p>
</div>
<div class="outline-4" id="outline-container-orgcffaef0">
<h4 id="orgcffaef0">Imports</h4>
<div class="outline-text-4" id="text-orgcffaef0"></div>
<div class="outline-5" id="outline-container-orgb1ccc66">
<h5 id="orgb1ccc66">From Python</h5>
<div class="outline-text-5" id="text-orgb1ccc66">
<div class="highlight">
<pre><span></span>from collections import Counter
from functools import partial
from pathlib import Path
import os
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-orgb55d069">
<h5 id="orgb55d069">From PyPi</h5>
<div class="outline-text-5" id="text-orgb55d069">
<div class="highlight">
<pre><span></span>from bokeh.models import HoverTool
from dotenv import load_dotenv
from holoviews import dim, opts
from holoviews.operation.datashader import datashade, bundle_graph
import holoviews
import hvplot.pandas
import networkx
import pandas as pandas
</pre></div>
</div>
</div>
<div class="outline-5" id="outline-container-org686d7c4">
<h5 id="org686d7c4">My Stuff</h5>
<div class="outline-text-5" id="text-org686d7c4">
<div class="highlight">
<pre><span></span>from graeae.timers import Timer
from graeae.visualization import EmbedBokeh, EmbedHoloview
</pre></div>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org2819c08">
<h4 id="org2819c08">Load the Dotenv</h4>
<div class="outline-text-4" id="text-org2819c08">
<div class="highlight">
<pre><span></span>load_dotenv(".env")
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org224260a">
<h4 id="org224260a">Build the Timer</h4>
<div class="outline-text-4" id="text-org224260a">
<div class="highlight">
<pre><span></span>TIMER = Timer()
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc623bd1">
<h3 id="orgc623bd1">Setup The Plotting</h3>
<div class="outline-text-3" id="text-orgc623bd1">
<div class="highlight">
<pre><span></span>holoviews.extension("bokeh")
SLUG = "high-school-contact-and-friendship-networks/"
output = Path("../../files/posts/networks/" + SLUG)
Embed = partial(EmbedHoloview, folder_path=output)
EmbedB = partial(EmbedBokeh, folder_path=output)
</pre></div>
<div class="highlight">
<pre><span></span>class Plot:
    """Constants for plotting"""
    width = 1000
    height = 800
    fontsize = 18
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org75228db">
<h3 id="org75228db">Load The Data</h3>
<div class="outline-text-3" id="text-org75228db">
<p>Let's take a look at the data before loading it into pandas.</p>
<div class="highlight">
<pre><span></span>HIGH_SCHOOL = Path(os.environ.get("HIGH_SCHOOL")).expanduser()
assert HIGH_SCHOOL.is_dir()

#+begin_src ipython :session highschool :results none
class Files:
    metadata = "metadata_2013.txt"
    contact_diaries = "Contact-diaries-network_data_2013.csv"
    facebook = "Facebook-known-pairs_data_2013.csv"
    friendship = "Friendship-network_data_2013.csv"
    high_school = "High-School_data_2013.csv"
</pre></div>
</div>
<div class="outline-4" id="outline-container-org72e3790">
<h4 id="org72e3790">MetaData</h4>
<div class="outline-text-4" id="text-org72e3790">
<div class="highlight">
<pre><span></span>metadata_path = HIGH_SCHOOL.joinpath(Files.metadata)
assert metadata_path.is_file()
with metadata_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
650     2BIO1   F
498     2BIO1   F
627     2BIO1   F
857     2BIO1   F
487     2BIO1   F

</pre>
<p>This first file has the meta-data for the students. The three columns are the student's ID, class, and gender.</p>
<div class="highlight">
<pre><span></span>meta_data = pandas.read_csv(metadata_path, sep="\t", 
                            names=["id", "class", "gender"])
meta_data.loc[:, "class"] = meta_data["class"].astype("category")
meta_data.loc[:, "gender"] = meta_data.gender.astype("category")
</pre></div>
</div>
<div class="outline-5" id="outline-container-org3609e6d">
<h5 id="org3609e6d">Classes</h5>
<div class="outline-text-5" id="text-org3609e6d">
<p>First a bar-plot to look at how the classes are distributed.</p>
<div class="highlight">
<pre><span></span>grouped = meta_data.groupby(["class", "gender"]).agg(
    {"class": "count", "gender": "count"})
grouped.columns = ["class_count", "gender_count"]
grouped = grouped.reset_index()
</pre></div>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", 
                          x="class", y="class_count", 
                          stacked=True,
                          by="gender", height=Plot.height, 
                          width=Plot.width,
                          ylabel="Count",
                          xlabel="Class",
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/gender_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>This is a look at the same thing except not stacked.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Class Counts by Gender", x="class", 
                          y="class_count",
                          xlabel="Class",
                          ylabel="Count",
                          by="gender", height=Plot.height, width=Plot.width, 
                          tools=["hover"],
                          fontsize=Plot.fontsize).opts(xrotation=90)
Embed(plot=plot, file_name="gender_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/gender_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Strangely, the classes that start with <code>2BIO</code> are more female while the others are more male.</p>
</div>
</div>
<div class="outline-5" id="outline-container-org6602648">
<h5 id="org6602648">Gender</h5>
<div class="outline-text-5" id="text-org6602648">
<p>A stacked bar plot to get a sense of not just the distribution among genders but among classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          stacked=True,
                          by="class", 
                          xlabel="Count",
                          ylabel="Gender",
                          fontsize=Plot.fontsize,
                          width=Plot.width,
                          height=Plot.height).opts(
                              xrotation=90, 
                              xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts_stacked", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/class_counts_stacked.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>A non-stacked bar plot to get a better sense of how the genders fill the different classes.</p>
<div class="highlight">
<pre><span></span>plot = grouped.hvplot.bar(title="Gender Counts", x="gender", y="gender_count",
                          xlabel="Gender",
                          ylabel="Count",
                          by="class", 
                          height=Plot.height,
                          width=Plot.width,
                          fontsize=Plot.fontsize).opts(
                              xrotation=90, xlabel="Gender and Class")
Embed(plot=plot, file_name="class_counts", height_in_pixels=Plot.height)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/class_counts.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It looks like there were a little more males than females, but not a whole lot more.</p>
</div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org1034723">
<h2 id="org1034723">The Descent</h2>
<div class="outline-text-2" id="text-org1034723"></div>
<div class="outline-4" id="outline-container-org5326544">
<h4 id="org5326544">The Facebook Network</h4>
<div class="outline-text-4" id="text-org5326544">
<p>This is a dataset that shows whether a student was <i>facebook</i> friends with another student.</p>
<div class="highlight">
<pre><span></span>facebook_path = HIGH_SCHOOL.joinpath(Files.facebook)
assert facebook_path.is_file()
with facebook_path.open() as reader:
    for line in range(5):
        print(reader.readline(), end="")
</pre></div>
<pre class="example">
1 984 0
1 883 1
1 941 0
1 650 0
1 132 1

</pre>
<p>The columns are <i>one student</i>, <i>next student</i>, <i>facebook friends</i>.</p>
<p>The third column is <i>0</i> if they aren't facebook friends and <i>1</i> if they are.</p>
<div class="highlight">
<pre><span></span>facebook_data = pandas.read_csv(facebook_path, delimiter=" ", 
                                names=["reporter", "other", "friend"])
facebook_data = facebook_data.dropna()
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orga01eb58">
<h2 id="orga01eb58">The Descent</h2>
<div class="outline-text-2" id="text-orga01eb58"></div>
<div class="outline-3" id="outline-container-org20e7d40">
<h3 id="org20e7d40">Looking at the Friendship Network</h3>
<div class="outline-text-3" id="text-org20e7d40">
<div class="highlight">
<pre><span></span>with TIMER:
    facebook_graph = networkx.convert_matrix.from_pandas_edgelist(
        facebook_data, "reporter", "other", 
        create_using=networkx.DiGraph)
</pre></div>
<pre class="example">
Started: 2019-03-27 23:05:04.495114
Ended: 2019-03-27 23:05:04.499622
Elapsed: 0:00:00.004508

</pre>
<div class="highlight">
<pre><span></span>genders = dict(zip(meta_data.id, meta_data.gender))
classes = dict(zip(meta_data.id, meta_data["class"]))
</pre></div>
<div class="highlight">
<pre><span></span>for node in facebook_graph.nodes:
    facebook_graph.nodes[node]["gender"] = genders[node]
    facebook_graph.nodes[node]["class"] = classes[node]
</pre></div>
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips = [
         ("Gender", "@gender"),
         ("Class", "@class"),
    ],
)

plot = holoviews.Graph.from_networkx(facebook_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("gender"), cmap="Set1",
                                         tools=[hover],
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,                                        
                                         title="Facebook Network by Gender",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_circular")()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_circular.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>It's a little hard to see what's going on here, other than to note that you can see some people are more popular than others.</p>
<div class="highlight">
<pre><span></span>hover = HoverTool(
    tooltips = [
         ("Gender", "@gender"),
         ("Class", "@class"),
    ],
)

plot = holoviews.Graph.from_networkx(facebook_graph,
                                     networkx.circular_layout).opts(
                                         node_color=dim("class"), cmap="Set1",
                                         tools=[hover],
                                         fontsize=Plot.fontsize,
                                         width=800,
                                         height=800,                                        
                                         title="Facebook Network by Class",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_circular_class")()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_circular_class.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(facebook_graph, networkx.spring_layout, ).opts(
                                         node_color=dim("class"), cmap="Set1",
                                         tools=["hover"],
                                         width=800,
                                         height=800,
                                         title="Facebook Network By Class",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_class_spring", height_in_pixels=810)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_class_spring.html" height="810" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<div class="highlight">
<pre><span></span>plot = holoviews.Graph.from_networkx(facebook_graph, networkx.spring_layout, ).opts(
                                         node_color=dim("gender"), cmap="Set1",
                                         tools=["hover"],
                                         width=800,
                                         height=800,
                                         title="Facebook Network By Gender",
                                         xaxis=None, yaxis=None, directed=True)
Embed(plot=plot, file_name="facebook_network_gender_spring", height_in_pixels=810)()
</pre></div>
<object data="posts/networks/high-school-facebook-networks/facebook_network_gender_spring.html" height="810" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object></div>
</div>
</div>
<div class="outline-2" id="outline-container-org3cd028c">
<h2 id="org3cd028c">End</h2>
<div class="outline-text-2" id="text-org3cd028c"></div>
<div class="outline-3" id="outline-container-org166d097">
<h3 id="org166d097">Citations</h3>
<div class="outline-text-3" id="text-org166d097">
<ul class="org-ul">
<li>R. Mastrandrea, J. Fournet, A. Barrat,</li>
</ul>
<p>Contact patterns in a high school: a comparison between data collected using wearable sensors, contact diaries and friendship surveys. PLoS ONE 10(9): e0136497 (2015)</p>
</div>
</div>
</div>
</div>
</article>
<ul class="pager postindexpager clearfix">
<li class="previous"><a href="." rel="prev">Newer posts</a></li>
<li class="next"><a href="index-2.html" rel="next">Older posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Contents Â© 2019 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
<script src="assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script> </div>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</div>
</body>
</html>
